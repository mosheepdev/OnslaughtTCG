!function(a,b,c){"use strict";function f(a){var b=null;if("VIDEO"===a.tagName)b=a;else{var c=a.getElementsByTagName("video");c[0]&&(b=c[0])}return b}function l(a){var b=f(a);if(b&&b.webkitEnterFullscreen){try{b.readyState<b.HAVE_METADATA?(b.addEventListener("loadedmetadata",function a(){b.removeEventListener("loadedmetadata",a,!1),b.webkitEnterFullscreen(),h=!!b.getAttribute("controls")},!1),b.load()):(b.webkitEnterFullscreen(),h=!!b.getAttribute("controls")),g=b}catch(b){return r("not_supported",a)}return!0}return r(void 0===e.request?"not_supported":"not_enabled",a)}function m(){s.element||(q(),o())}function n(){c&&"webkitfullscreenchange"===e.change&&window.addEventListener("resize",m,!1)}function o(){c&&"webkitfullscreenchange"===e.change&&window.removeEventListener("resize",m,!1)}var d=/i(Pad|Phone|Pod)/.test(navigator.userAgent)&&parseInt(navigator.userAgent.replace(/^.*OS (\d+)_(\d+).*$/,"$1.$2"),10)>=7,e=function(){var a=b.createElement("video"),c={request:["requestFullscreen","webkitRequestFullscreen","webkitRequestFullScreen","mozRequestFullScreen","msRequestFullscreen"],exit:["exitFullscreen","webkitCancelFullScreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen"],enabled:["fullscreenEnabled","webkitFullscreenEnabled","mozFullScreenEnabled","msFullscreenEnabled"],element:["fullscreenElement","webkitFullscreenElement","webkitCurrentFullScreenElement","mozFullScreenElement","msFullscreenElement"],change:["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],error:["fullscreenerror","webkitfullscreenerror","mozfullscreenerror","MSFullscreenError"]},d={};for(var e in c)for(var f=0,g=c[e].length;f<g;f++)if(c[e][f]in a||c[e][f]in b||"on"+c[e][f].toLowerCase()in b){d[e]=c[e][f];break}return d}(),g=null,h=null,i=function(){},j=[],k=!1;navigator.userAgent.indexOf("Android")>-1&&navigator.userAgent.indexOf("Chrome")>-1&&(k=parseInt(navigator.userAgent.replace(/^.*Chrome\/(\d+).*$/,"$1"),10)||!0);var p=function(a){var b=j[j.length-1];b&&(a!==b.element&&a!==g||!b.hasEntered)&&("VIDEO"===a.tagName&&(g=a),1===j.length&&s.onenter(s.element),b.enter.call(b.element,a||b.element),b.hasEntered=!0)},q=function(){!g||h||d||(g.setAttribute("controls","controls"),g.removeAttribute("controls")),g=null,h=null;var a=j.pop();a&&(a.exit.call(a.element),s.element||(j.forEach(function(a){a.exit.call(a.element)}),j=[],s.onexit()))},r=function(a,b){if(j.length>0){var c=j.pop();b=b||c.element,c.error.call(b,a),s.onerror(b,a)}},s={request:function(a,d,f,g){if(a=a||b.body,j.push({element:a,enter:d||i,exit:f||i,error:g||i}),void 0===e.request)return void l(a);if(c&&b[e.enabled]===!1)return void l(a);if(k!==!1&&k<32)return void l(a);if(c&&void 0===e.enabled)return e.enabled="webkitFullscreenEnabled",a[e.request](),void setTimeout(function(){b[e.element]?b[e.enabled]=!0:(b[e.enabled]=!1,l(a))},250);try{a[e.request](),setTimeout(function(){b[e.element]||r(c?"not_enabled":"not_allowed",a)},100)}catch(b){r("not_enabled",a)}},exit:function(){o(),b[e.exit]()},toggle:function(a,b,c,d){s.element?s.exit():s.request(a,b,c,d)},videoEnabled:function(a){if(s.enabled)return!0;a=a||b.body;var c=f(a);return!(!c||void 0===c.webkitSupportsFullscreen)&&(c.readyState<c.HAVE_METADATA?"maybe":c.webkitSupportsFullscreen)},onenter:i,onexit:i,onchange:i,onerror:i};try{Object.defineProperties(s,{element:{enumerable:!0,get:function(){return g&&g.webkitDisplayingFullscreen?g:b[e.element]||null}},enabled:{enumerable:!0,get:function(){return"webkitCancelFullScreen"===e.exit&&!c||!(k!==!1&&k<32)&&(b[e.enabled]||!1)}}}),e.change&&b.addEventListener(e.change,function(b){if(s.onchange(s.element),s.element){var c=j[j.length-2];c&&c.element===s.element?q():(p(s.element),n())}else q()},!1),b.addEventListener("webkitbeginfullscreen",function(b){var c=!0;if(j.length>0)for(var d=0,e=j.length;d<e;d++){var g=f(j[d].element);if(g===b.srcElement){c=!1;break}}c&&j.push({element:b.srcElement,enter:i,exit:i,error:i}),s.onchange(b.srcElement),p(b.srcElement)},!0),b.addEventListener("webkitendfullscreen",function(b){s.onchange(b.srcElement),q(b.srcElement)},!0),e.error&&b.addEventListener(e.error,function(b){r("not_allowed")},!1)}catch(a){s.element=null,s.enabled=!1}"function"==typeof define&&define.amd?define(function(){return s}):"undefined"!=typeof module&&module.exports?module.exports=s:a.BigScreen=s}(this,document,self!==top);
/*! jQuery v3.5.1 | (c) JS Foundation and other contributors | jquery.org/license */
!function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(C,e){"use strict";var t=[],r=Object.getPrototypeOf,s=t.slice,g=t.flat?function(e){return t.flat.call(e)}:function(e){return t.concat.apply([],e)},u=t.push,i=t.indexOf,n={},o=n.toString,v=n.hasOwnProperty,a=v.toString,l=a.call(Object),y={},m=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},x=function(e){return null!=e&&e===e.window},E=C.document,c={type:!0,src:!0,nonce:!0,noModule:!0};function b(e,t,n){var r,i,o=(n=n||E).createElement("script");if(o.text=e,t)for(r in c)(i=t[r]||t.getAttribute&&t.getAttribute(r))&&o.setAttribute(r,i);n.head.appendChild(o).parentNode.removeChild(o)}function w(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?n[o.call(e)]||"object":typeof e}var f="3.5.1",S=function(e,t){return new S.fn.init(e,t)};function p(e){var t=!!e&&"length"in e&&e.length,n=w(e);return!m(e)&&!x(e)&&("array"===n||0===t||"number"==typeof t&&0<t&&t-1 in e)}S.fn=S.prototype={jquery:f,constructor:S,length:0,toArray:function(){return s.call(this)},get:function(e){return null==e?s.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=S.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return S.each(this,e)},map:function(n){return this.pushStack(S.map(this,function(e,t){return n.call(e,t,e)}))},slice:function(){return this.pushStack(s.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(S.grep(this,function(e,t){return(t+1)%2}))},odd:function(){return this.pushStack(S.grep(this,function(e,t){return t%2}))},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(0<=n&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:u,sort:t.sort,splice:t.splice},S.extend=S.fn.extend=function(){var e,t,n,r,i,o,a=arguments[0]||{},s=1,u=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[s]||{},s++),"object"==typeof a||m(a)||(a={}),s===u&&(a=this,s--);s<u;s++)if(null!=(e=arguments[s]))for(t in e)r=e[t],"__proto__"!==t&&a!==r&&(l&&r&&(S.isPlainObject(r)||(i=Array.isArray(r)))?(n=a[t],o=i&&!Array.isArray(n)?[]:i||S.isPlainObject(n)?n:{},i=!1,a[t]=S.extend(l,o,r)):void 0!==r&&(a[t]=r));return a},S.extend({expando:"jQuery"+(f+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==o.call(e))&&(!(t=r(e))||"function"==typeof(n=v.call(t,"constructor")&&t.constructor)&&a.call(n)===l)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){b(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,r=0;if(p(e)){for(n=e.length;r<n;r++)if(!1===t.call(e[r],r,e[r]))break}else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},makeArray:function(e,t){var n=t||[];return null!=e&&(p(Object(e))?S.merge(n,"string"==typeof e?[e]:e):u.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:i.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,o=e.length,a=!n;i<o;i++)!t(e[i],i)!==a&&r.push(e[i]);return r},map:function(e,t,n){var r,i,o=0,a=[];if(p(e))for(r=e.length;o<r;o++)null!=(i=t(e[o],o,n))&&a.push(i);else for(o in e)null!=(i=t(e[o],o,n))&&a.push(i);return g(a)},guid:1,support:y}),"function"==typeof Symbol&&(S.fn[Symbol.iterator]=t[Symbol.iterator]),S.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){n["[object "+t+"]"]=t.toLowerCase()});var d=function(n){var e,d,b,o,i,h,f,g,w,u,l,T,C,a,E,v,s,c,y,S="sizzle"+1*new Date,p=n.document,k=0,r=0,m=ue(),x=ue(),A=ue(),N=ue(),D=function(e,t){return e===t&&(l=!0),0},j={}.hasOwnProperty,t=[],q=t.pop,L=t.push,H=t.push,O=t.slice,P=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},R="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",M="[\\x20\\t\\r\\n\\f]",I="(?:\\\\[\\da-fA-F]{1,6}"+M+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",W="\\["+M+"*("+I+")(?:"+M+"*([*^$|!~]?=)"+M+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+I+"))|)"+M+"*\\]",F=":("+I+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+W+")*)|.*)\\)|)",B=new RegExp(M+"+","g"),$=new RegExp("^"+M+"+|((?:^|[^\\\\])(?:\\\\.)*)"+M+"+$","g"),_=new RegExp("^"+M+"*,"+M+"*"),z=new RegExp("^"+M+"*([>+~]|"+M+")"+M+"*"),U=new RegExp(M+"|>"),X=new RegExp(F),V=new RegExp("^"+I+"$"),G={ID:new RegExp("^#("+I+")"),CLASS:new RegExp("^\\.("+I+")"),TAG:new RegExp("^("+I+"|[*])"),ATTR:new RegExp("^"+W),PSEUDO:new RegExp("^"+F),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+M+"*(even|odd|(([+-]|)(\\d*)n|)"+M+"*(?:([+-]|)"+M+"*(\\d+)|))"+M+"*\\)|)","i"),bool:new RegExp("^(?:"+R+")$","i"),needsContext:new RegExp("^"+M+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+M+"*((?:-\\d)?\\d*)"+M+"*\\)|)(?=[^-]|$)","i")},Y=/HTML$/i,Q=/^(?:input|select|textarea|button)$/i,J=/^h\d$/i,K=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=new RegExp("\\\\[\\da-fA-F]{1,6}"+M+"?|\\\\([^\\r\\n\\f])","g"),ne=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},re=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ie=function(e,t){return t?"\0"===e?"\ufffd":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},oe=function(){T()},ae=be(function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{H.apply(t=O.call(p.childNodes),p.childNodes),t[p.childNodes.length].nodeType}catch(e){H={apply:t.length?function(e,t){L.apply(e,O.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}function se(t,e,n,r){var i,o,a,s,u,l,c,f=e&&e.ownerDocument,p=e?e.nodeType:9;if(n=n||[],"string"!=typeof t||!t||1!==p&&9!==p&&11!==p)return n;if(!r&&(T(e),e=e||C,E)){if(11!==p&&(u=Z.exec(t)))if(i=u[1]){if(9===p){if(!(a=e.getElementById(i)))return n;if(a.id===i)return n.push(a),n}else if(f&&(a=f.getElementById(i))&&y(e,a)&&a.id===i)return n.push(a),n}else{if(u[2])return H.apply(n,e.getElementsByTagName(t)),n;if((i=u[3])&&d.getElementsByClassName&&e.getElementsByClassName)return H.apply(n,e.getElementsByClassName(i)),n}if(d.qsa&&!N[t+" "]&&(!v||!v.test(t))&&(1!==p||"object"!==e.nodeName.toLowerCase())){if(c=t,f=e,1===p&&(U.test(t)||z.test(t))){(f=ee.test(t)&&ye(e.parentNode)||e)===e&&d.scope||((s=e.getAttribute("id"))?s=s.replace(re,ie):e.setAttribute("id",s=S)),o=(l=h(t)).length;while(o--)l[o]=(s?"#"+s:":scope")+" "+xe(l[o]);c=l.join(",")}try{return H.apply(n,f.querySelectorAll(c)),n}catch(e){N(t,!0)}finally{s===S&&e.removeAttribute("id")}}}return g(t.replace($,"$1"),e,n,r)}function ue(){var r=[];return function e(t,n){return r.push(t+" ")>b.cacheLength&&delete e[r.shift()],e[t+" "]=n}}function le(e){return e[S]=!0,e}function ce(e){var t=C.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function fe(e,t){var n=e.split("|"),r=n.length;while(r--)b.attrHandle[n[r]]=t}function pe(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function de(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function he(n){return function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&e.type===n}}function ge(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&ae(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function ve(a){return le(function(o){return o=+o,le(function(e,t){var n,r=a([],e.length,o),i=r.length;while(i--)e[n=r[i]]&&(e[n]=!(t[n]=e[n]))})})}function ye(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}for(e in d=se.support={},i=se.isXML=function(e){var t=e.namespaceURI,n=(e.ownerDocument||e).documentElement;return!Y.test(t||n&&n.nodeName||"HTML")},T=se.setDocument=function(e){var t,n,r=e?e.ownerDocument||e:p;return r!=C&&9===r.nodeType&&r.documentElement&&(a=(C=r).documentElement,E=!i(C),p!=C&&(n=C.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",oe,!1):n.attachEvent&&n.attachEvent("onunload",oe)),d.scope=ce(function(e){return a.appendChild(e).appendChild(C.createElement("div")),"undefined"!=typeof e.querySelectorAll&&!e.querySelectorAll(":scope fieldset div").length}),d.attributes=ce(function(e){return e.className="i",!e.getAttribute("className")}),d.getElementsByTagName=ce(function(e){return e.appendChild(C.createComment("")),!e.getElementsByTagName("*").length}),d.getElementsByClassName=K.test(C.getElementsByClassName),d.getById=ce(function(e){return a.appendChild(e).id=S,!C.getElementsByName||!C.getElementsByName(S).length}),d.getById?(b.filter.ID=function(e){var t=e.replace(te,ne);return function(e){return e.getAttribute("id")===t}},b.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&E){var n=t.getElementById(e);return n?[n]:[]}}):(b.filter.ID=function(e){var n=e.replace(te,ne);return function(e){var t="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return t&&t.value===n}},b.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&E){var n,r,i,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];i=t.getElementsByName(e),r=0;while(o=i[r++])if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),b.find.TAG=d.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):d.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){while(n=o[i++])1===n.nodeType&&r.push(n);return r}return o},b.find.CLASS=d.getElementsByClassName&&function(e,t){if("undefined"!=typeof t.getElementsByClassName&&E)return t.getElementsByClassName(e)},s=[],v=[],(d.qsa=K.test(C.querySelectorAll))&&(ce(function(e){var t;a.appendChild(e).innerHTML="<a id='"+S+"'></a><select id='"+S+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&v.push("[*^$]="+M+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||v.push("\\["+M+"*(?:value|"+R+")"),e.querySelectorAll("[id~="+S+"-]").length||v.push("~="),(t=C.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||v.push("\\["+M+"*name"+M+"*="+M+"*(?:''|\"\")"),e.querySelectorAll(":checked").length||v.push(":checked"),e.querySelectorAll("a#"+S+"+*").length||v.push(".#.+[+~]"),e.querySelectorAll("\\\f"),v.push("[\\r\\n\\f]")}),ce(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=C.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&v.push("name"+M+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&v.push(":enabled",":disabled"),a.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&v.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),v.push(",.*:")})),(d.matchesSelector=K.test(c=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.msMatchesSelector))&&ce(function(e){d.disconnectedMatch=c.call(e,"*"),c.call(e,"[s!='']:x"),s.push("!=",F)}),v=v.length&&new RegExp(v.join("|")),s=s.length&&new RegExp(s.join("|")),t=K.test(a.compareDocumentPosition),y=t||K.test(a.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},D=t?function(e,t){if(e===t)return l=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!d.sortDetached&&t.compareDocumentPosition(e)===n?e==C||e.ownerDocument==p&&y(p,e)?-1:t==C||t.ownerDocument==p&&y(p,t)?1:u?P(u,e)-P(u,t):0:4&n?-1:1)}:function(e,t){if(e===t)return l=!0,0;var n,r=0,i=e.parentNode,o=t.parentNode,a=[e],s=[t];if(!i||!o)return e==C?-1:t==C?1:i?-1:o?1:u?P(u,e)-P(u,t):0;if(i===o)return pe(e,t);n=e;while(n=n.parentNode)a.unshift(n);n=t;while(n=n.parentNode)s.unshift(n);while(a[r]===s[r])r++;return r?pe(a[r],s[r]):a[r]==p?-1:s[r]==p?1:0}),C},se.matches=function(e,t){return se(e,null,null,t)},se.matchesSelector=function(e,t){if(T(e),d.matchesSelector&&E&&!N[t+" "]&&(!s||!s.test(t))&&(!v||!v.test(t)))try{var n=c.call(e,t);if(n||d.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){N(t,!0)}return 0<se(t,C,null,[e]).length},se.contains=function(e,t){return(e.ownerDocument||e)!=C&&T(e),y(e,t)},se.attr=function(e,t){(e.ownerDocument||e)!=C&&T(e);var n=b.attrHandle[t.toLowerCase()],r=n&&j.call(b.attrHandle,t.toLowerCase())?n(e,t,!E):void 0;return void 0!==r?r:d.attributes||!E?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},se.escape=function(e){return(e+"").replace(re,ie)},se.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},se.uniqueSort=function(e){var t,n=[],r=0,i=0;if(l=!d.detectDuplicates,u=!d.sortStable&&e.slice(0),e.sort(D),l){while(t=e[i++])t===e[i]&&(r=n.push(i));while(r--)e.splice(n[r],1)}return u=null,e},o=se.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else while(t=e[r++])n+=o(t);return n},(b=se.selectors={cacheLength:50,createPseudo:le,match:G,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(te,ne),e[3]=(e[3]||e[4]||e[5]||"").replace(te,ne),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||se.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&se.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return G.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&X.test(n)&&(t=h(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(te,ne).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=m[e+" "];return t||(t=new RegExp("(^|"+M+")"+e+"("+M+"|$)"))&&m(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(n,r,i){return function(e){var t=se.attr(e,n);return null==t?"!="===r:!r||(t+="","="===r?t===i:"!="===r?t!==i:"^="===r?i&&0===t.indexOf(i):"*="===r?i&&-1<t.indexOf(i):"$="===r?i&&t.slice(-i.length)===i:"~="===r?-1<(" "+t.replace(B," ")+" ").indexOf(i):"|="===r&&(t===i||t.slice(0,i.length+1)===i+"-"))}},CHILD:function(h,e,t,g,v){var y="nth"!==h.slice(0,3),m="last"!==h.slice(-4),x="of-type"===e;return 1===g&&0===v?function(e){return!!e.parentNode}:function(e,t,n){var r,i,o,a,s,u,l=y!==m?"nextSibling":"previousSibling",c=e.parentNode,f=x&&e.nodeName.toLowerCase(),p=!n&&!x,d=!1;if(c){if(y){while(l){a=e;while(a=a[l])if(x?a.nodeName.toLowerCase()===f:1===a.nodeType)return!1;u=l="only"===h&&!u&&"nextSibling"}return!0}if(u=[m?c.firstChild:c.lastChild],m&&p){d=(s=(r=(i=(o=(a=c)[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]||[])[0]===k&&r[1])&&r[2],a=s&&c.childNodes[s];while(a=++s&&a&&a[l]||(d=s=0)||u.pop())if(1===a.nodeType&&++d&&a===e){i[h]=[k,s,d];break}}else if(p&&(d=s=(r=(i=(o=(a=e)[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]||[])[0]===k&&r[1]),!1===d)while(a=++s&&a&&a[l]||(d=s=0)||u.pop())if((x?a.nodeName.toLowerCase()===f:1===a.nodeType)&&++d&&(p&&((i=(o=a[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]=[k,d]),a===e))break;return(d-=v)===g||d%g==0&&0<=d/g}}},PSEUDO:function(e,o){var t,a=b.pseudos[e]||b.setFilters[e.toLowerCase()]||se.error("unsupported pseudo: "+e);return a[S]?a(o):1<a.length?(t=[e,e,"",o],b.setFilters.hasOwnProperty(e.toLowerCase())?le(function(e,t){var n,r=a(e,o),i=r.length;while(i--)e[n=P(e,r[i])]=!(t[n]=r[i])}):function(e){return a(e,0,t)}):a}},pseudos:{not:le(function(e){var r=[],i=[],s=f(e.replace($,"$1"));return s[S]?le(function(e,t,n,r){var i,o=s(e,null,r,[]),a=e.length;while(a--)(i=o[a])&&(e[a]=!(t[a]=i))}):function(e,t,n){return r[0]=e,s(r,null,n,i),r[0]=null,!i.pop()}}),has:le(function(t){return function(e){return 0<se(t,e).length}}),contains:le(function(t){return t=t.replace(te,ne),function(e){return-1<(e.textContent||o(e)).indexOf(t)}}),lang:le(function(n){return V.test(n||"")||se.error("unsupported lang: "+n),n=n.replace(te,ne).toLowerCase(),function(e){var t;do{if(t=E?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(t=t.toLowerCase())===n||0===t.indexOf(n+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=n.location&&n.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===a},focus:function(e){return e===C.activeElement&&(!C.hasFocus||C.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:ge(!1),disabled:ge(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!b.pseudos.empty(e)},header:function(e){return J.test(e.nodeName)},input:function(e){return Q.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:ve(function(){return[0]}),last:ve(function(e,t){return[t-1]}),eq:ve(function(e,t,n){return[n<0?n+t:n]}),even:ve(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:ve(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:ve(function(e,t,n){for(var r=n<0?n+t:t<n?t:n;0<=--r;)e.push(r);return e}),gt:ve(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=b.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[e]=de(e);for(e in{submit:!0,reset:!0})b.pseudos[e]=he(e);function me(){}function xe(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function be(s,e,t){var u=e.dir,l=e.next,c=l||u,f=t&&"parentNode"===c,p=r++;return e.first?function(e,t,n){while(e=e[u])if(1===e.nodeType||f)return s(e,t,n);return!1}:function(e,t,n){var r,i,o,a=[k,p];if(n){while(e=e[u])if((1===e.nodeType||f)&&s(e,t,n))return!0}else while(e=e[u])if(1===e.nodeType||f)if(i=(o=e[S]||(e[S]={}))[e.uniqueID]||(o[e.uniqueID]={}),l&&l===e.nodeName.toLowerCase())e=e[u]||e;else{if((r=i[c])&&r[0]===k&&r[1]===p)return a[2]=r[2];if((i[c]=a)[2]=s(e,t,n))return!0}return!1}}function we(i){return 1<i.length?function(e,t,n){var r=i.length;while(r--)if(!i[r](e,t,n))return!1;return!0}:i[0]}function Te(e,t,n,r,i){for(var o,a=[],s=0,u=e.length,l=null!=t;s<u;s++)(o=e[s])&&(n&&!n(o,r,i)||(a.push(o),l&&t.push(s)));return a}function Ce(d,h,g,v,y,e){return v&&!v[S]&&(v=Ce(v)),y&&!y[S]&&(y=Ce(y,e)),le(function(e,t,n,r){var i,o,a,s=[],u=[],l=t.length,c=e||function(e,t,n){for(var r=0,i=t.length;r<i;r++)se(e,t[r],n);return n}(h||"*",n.nodeType?[n]:n,[]),f=!d||!e&&h?c:Te(c,s,d,n,r),p=g?y||(e?d:l||v)?[]:t:f;if(g&&g(f,p,n,r),v){i=Te(p,u),v(i,[],n,r),o=i.length;while(o--)(a=i[o])&&(p[u[o]]=!(f[u[o]]=a))}if(e){if(y||d){if(y){i=[],o=p.length;while(o--)(a=p[o])&&i.push(f[o]=a);y(null,p=[],i,r)}o=p.length;while(o--)(a=p[o])&&-1<(i=y?P(e,a):s[o])&&(e[i]=!(t[i]=a))}}else p=Te(p===t?p.splice(l,p.length):p),y?y(null,t,p,r):H.apply(t,p)})}function Ee(e){for(var i,t,n,r=e.length,o=b.relative[e[0].type],a=o||b.relative[" "],s=o?1:0,u=be(function(e){return e===i},a,!0),l=be(function(e){return-1<P(i,e)},a,!0),c=[function(e,t,n){var r=!o&&(n||t!==w)||((i=t).nodeType?u(e,t,n):l(e,t,n));return i=null,r}];s<r;s++)if(t=b.relative[e[s].type])c=[be(we(c),t)];else{if((t=b.filter[e[s].type].apply(null,e[s].matches))[S]){for(n=++s;n<r;n++)if(b.relative[e[n].type])break;return Ce(1<s&&we(c),1<s&&xe(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace($,"$1"),t,s<n&&Ee(e.slice(s,n)),n<r&&Ee(e=e.slice(n)),n<r&&xe(e))}c.push(t)}return we(c)}return me.prototype=b.filters=b.pseudos,b.setFilters=new me,h=se.tokenize=function(e,t){var n,r,i,o,a,s,u,l=x[e+" "];if(l)return t?0:l.slice(0);a=e,s=[],u=b.preFilter;while(a){for(o in n&&!(r=_.exec(a))||(r&&(a=a.slice(r[0].length)||a),s.push(i=[])),n=!1,(r=z.exec(a))&&(n=r.shift(),i.push({value:n,type:r[0].replace($," ")}),a=a.slice(n.length)),b.filter)!(r=G[o].exec(a))||u[o]&&!(r=u[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),a=a.slice(n.length));if(!n)break}return t?a.length:a?se.error(e):x(e,s).slice(0)},f=se.compile=function(e,t){var n,v,y,m,x,r,i=[],o=[],a=A[e+" "];if(!a){t||(t=h(e)),n=t.length;while(n--)(a=Ee(t[n]))[S]?i.push(a):o.push(a);(a=A(e,(v=o,m=0<(y=i).length,x=0<v.length,r=function(e,t,n,r,i){var o,a,s,u=0,l="0",c=e&&[],f=[],p=w,d=e||x&&b.find.TAG("*",i),h=k+=null==p?1:Math.random()||.1,g=d.length;for(i&&(w=t==C||t||i);l!==g&&null!=(o=d[l]);l++){if(x&&o){a=0,t||o.ownerDocument==C||(T(o),n=!E);while(s=v[a++])if(s(o,t||C,n)){r.push(o);break}i&&(k=h)}m&&((o=!s&&o)&&u--,e&&c.push(o))}if(u+=l,m&&l!==u){a=0;while(s=y[a++])s(c,f,t,n);if(e){if(0<u)while(l--)c[l]||f[l]||(f[l]=q.call(r));f=Te(f)}H.apply(r,f),i&&!e&&0<f.length&&1<u+y.length&&se.uniqueSort(r)}return i&&(k=h,w=p),c},m?le(r):r))).selector=e}return a},g=se.select=function(e,t,n,r){var i,o,a,s,u,l="function"==typeof e&&e,c=!r&&h(e=l.selector||e);if(n=n||[],1===c.length){if(2<(o=c[0]=c[0].slice(0)).length&&"ID"===(a=o[0]).type&&9===t.nodeType&&E&&b.relative[o[1].type]){if(!(t=(b.find.ID(a.matches[0].replace(te,ne),t)||[])[0]))return n;l&&(t=t.parentNode),e=e.slice(o.shift().value.length)}i=G.needsContext.test(e)?0:o.length;while(i--){if(a=o[i],b.relative[s=a.type])break;if((u=b.find[s])&&(r=u(a.matches[0].replace(te,ne),ee.test(o[0].type)&&ye(t.parentNode)||t))){if(o.splice(i,1),!(e=r.length&&xe(o)))return H.apply(n,r),n;break}}}return(l||f(e,c))(r,t,!E,n,!t||ee.test(e)&&ye(t.parentNode)||t),n},d.sortStable=S.split("").sort(D).join("")===S,d.detectDuplicates=!!l,T(),d.sortDetached=ce(function(e){return 1&e.compareDocumentPosition(C.createElement("fieldset"))}),ce(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||fe("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),d.attributes&&ce(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||fe("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),ce(function(e){return null==e.getAttribute("disabled")})||fe(R,function(e,t,n){var r;if(!n)return!0===e[t]?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),se}(C);S.find=d,S.expr=d.selectors,S.expr[":"]=S.expr.pseudos,S.uniqueSort=S.unique=d.uniqueSort,S.text=d.getText,S.isXMLDoc=d.isXML,S.contains=d.contains,S.escapeSelector=d.escape;var h=function(e,t,n){var r=[],i=void 0!==n;while((e=e[t])&&9!==e.nodeType)if(1===e.nodeType){if(i&&S(e).is(n))break;r.push(e)}return r},T=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},k=S.expr.match.needsContext;function A(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var N=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function D(e,n,r){return m(n)?S.grep(e,function(e,t){return!!n.call(e,t,e)!==r}):n.nodeType?S.grep(e,function(e){return e===n!==r}):"string"!=typeof n?S.grep(e,function(e){return-1<i.call(n,e)!==r}):S.filter(n,e,r)}S.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?S.find.matchesSelector(r,e)?[r]:[]:S.find.matches(e,S.grep(t,function(e){return 1===e.nodeType}))},S.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(S(e).filter(function(){for(t=0;t<r;t++)if(S.contains(i[t],this))return!0}));for(n=this.pushStack([]),t=0;t<r;t++)S.find(e,i[t],n);return 1<r?S.uniqueSort(n):n},filter:function(e){return this.pushStack(D(this,e||[],!1))},not:function(e){return this.pushStack(D(this,e||[],!0))},is:function(e){return!!D(this,"string"==typeof e&&k.test(e)?S(e):e||[],!1).length}});var j,q=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(S.fn.init=function(e,t,n){var r,i;if(!e)return this;if(n=n||j,"string"==typeof e){if(!(r="<"===e[0]&&">"===e[e.length-1]&&3<=e.length?[null,e,null]:q.exec(e))||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof S?t[0]:t,S.merge(this,S.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:E,!0)),N.test(r[1])&&S.isPlainObject(t))for(r in t)m(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return(i=E.getElementById(r[2]))&&(this[0]=i,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):m(e)?void 0!==n.ready?n.ready(e):e(S):S.makeArray(e,this)}).prototype=S.fn,j=S(E);var L=/^(?:parents|prev(?:Until|All))/,H={children:!0,contents:!0,next:!0,prev:!0};function O(e,t){while((e=e[t])&&1!==e.nodeType);return e}S.fn.extend({has:function(e){var t=S(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(S.contains(this,t[e]))return!0})},closest:function(e,t){var n,r=0,i=this.length,o=[],a="string"!=typeof e&&S(e);if(!k.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?-1<a.index(n):1===n.nodeType&&S.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(1<o.length?S.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?i.call(S(e),this[0]):i.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(S.uniqueSort(S.merge(this.get(),S(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),S.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return h(e,"parentNode")},parentsUntil:function(e,t,n){return h(e,"parentNode",n)},next:function(e){return O(e,"nextSibling")},prev:function(e){return O(e,"previousSibling")},nextAll:function(e){return h(e,"nextSibling")},prevAll:function(e){return h(e,"previousSibling")},nextUntil:function(e,t,n){return h(e,"nextSibling",n)},prevUntil:function(e,t,n){return h(e,"previousSibling",n)},siblings:function(e){return T((e.parentNode||{}).firstChild,e)},children:function(e){return T(e.firstChild)},contents:function(e){return null!=e.contentDocument&&r(e.contentDocument)?e.contentDocument:(A(e,"template")&&(e=e.content||e),S.merge([],e.childNodes))}},function(r,i){S.fn[r]=function(e,t){var n=S.map(this,i,e);return"Until"!==r.slice(-5)&&(t=e),t&&"string"==typeof t&&(n=S.filter(t,n)),1<this.length&&(H[r]||S.uniqueSort(n),L.test(r)&&n.reverse()),this.pushStack(n)}});var P=/[^\x20\t\r\n\f]+/g;function R(e){return e}function M(e){throw e}function I(e,t,n,r){var i;try{e&&m(i=e.promise)?i.call(e).done(t).fail(n):e&&m(i=e.then)?i.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}S.Callbacks=function(r){var e,n;r="string"==typeof r?(e=r,n={},S.each(e.match(P)||[],function(e,t){n[t]=!0}),n):S.extend({},r);var i,t,o,a,s=[],u=[],l=-1,c=function(){for(a=a||r.once,o=i=!0;u.length;l=-1){t=u.shift();while(++l<s.length)!1===s[l].apply(t[0],t[1])&&r.stopOnFalse&&(l=s.length,t=!1)}r.memory||(t=!1),i=!1,a&&(s=t?[]:"")},f={add:function(){return s&&(t&&!i&&(l=s.length-1,u.push(t)),function n(e){S.each(e,function(e,t){m(t)?r.unique&&f.has(t)||s.push(t):t&&t.length&&"string"!==w(t)&&n(t)})}(arguments),t&&!i&&c()),this},remove:function(){return S.each(arguments,function(e,t){var n;while(-1<(n=S.inArray(t,s,n)))s.splice(n,1),n<=l&&l--}),this},has:function(e){return e?-1<S.inArray(e,s):0<s.length},empty:function(){return s&&(s=[]),this},disable:function(){return a=u=[],s=t="",this},disabled:function(){return!s},lock:function(){return a=u=[],t||i||(s=t=""),this},locked:function(){return!!a},fireWith:function(e,t){return a||(t=[e,(t=t||[]).slice?t.slice():t],u.push(t),i||c()),this},fire:function(){return f.fireWith(this,arguments),this},fired:function(){return!!o}};return f},S.extend({Deferred:function(e){var o=[["notify","progress",S.Callbacks("memory"),S.Callbacks("memory"),2],["resolve","done",S.Callbacks("once memory"),S.Callbacks("once memory"),0,"resolved"],["reject","fail",S.Callbacks("once memory"),S.Callbacks("once memory"),1,"rejected"]],i="pending",a={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},"catch":function(e){return a.then(null,e)},pipe:function(){var i=arguments;return S.Deferred(function(r){S.each(o,function(e,t){var n=m(i[t[4]])&&i[t[4]];s[t[1]](function(){var e=n&&n.apply(this,arguments);e&&m(e.promise)?e.promise().progress(r.notify).done(r.resolve).fail(r.reject):r[t[0]+"With"](this,n?[e]:arguments)})}),i=null}).promise()},then:function(t,n,r){var u=0;function l(i,o,a,s){return function(){var n=this,r=arguments,e=function(){var e,t;if(!(i<u)){if((e=a.apply(n,r))===o.promise())throw new TypeError("Thenable self-resolution");t=e&&("object"==typeof e||"function"==typeof e)&&e.then,m(t)?s?t.call(e,l(u,o,R,s),l(u,o,M,s)):(u++,t.call(e,l(u,o,R,s),l(u,o,M,s),l(u,o,R,o.notifyWith))):(a!==R&&(n=void 0,r=[e]),(s||o.resolveWith)(n,r))}},t=s?e:function(){try{e()}catch(e){S.Deferred.exceptionHook&&S.Deferred.exceptionHook(e,t.stackTrace),u<=i+1&&(a!==M&&(n=void 0,r=[e]),o.rejectWith(n,r))}};i?t():(S.Deferred.getStackHook&&(t.stackTrace=S.Deferred.getStackHook()),C.setTimeout(t))}}return S.Deferred(function(e){o[0][3].add(l(0,e,m(r)?r:R,e.notifyWith)),o[1][3].add(l(0,e,m(t)?t:R)),o[2][3].add(l(0,e,m(n)?n:M))}).promise()},promise:function(e){return null!=e?S.extend(e,a):a}},s={};return S.each(o,function(e,t){var n=t[2],r=t[5];a[t[1]]=n.add,r&&n.add(function(){i=r},o[3-e][2].disable,o[3-e][3].disable,o[0][2].lock,o[0][3].lock),n.add(t[3].fire),s[t[0]]=function(){return s[t[0]+"With"](this===s?void 0:this,arguments),this},s[t[0]+"With"]=n.fireWith}),a.promise(s),e&&e.call(s,s),s},when:function(e){var n=arguments.length,t=n,r=Array(t),i=s.call(arguments),o=S.Deferred(),a=function(t){return function(e){r[t]=this,i[t]=1<arguments.length?s.call(arguments):e,--n||o.resolveWith(r,i)}};if(n<=1&&(I(e,o.done(a(t)).resolve,o.reject,!n),"pending"===o.state()||m(i[t]&&i[t].then)))return o.then();while(t--)I(i[t],a(t),o.reject);return o.promise()}});var W=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;S.Deferred.exceptionHook=function(e,t){C.console&&C.console.warn&&e&&W.test(e.name)&&C.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},S.readyException=function(e){C.setTimeout(function(){throw e})};var F=S.Deferred();function B(){E.removeEventListener("DOMContentLoaded",B),C.removeEventListener("load",B),S.ready()}S.fn.ready=function(e){return F.then(e)["catch"](function(e){S.readyException(e)}),this},S.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--S.readyWait:S.isReady)||(S.isReady=!0)!==e&&0<--S.readyWait||F.resolveWith(E,[S])}}),S.ready.then=F.then,"complete"===E.readyState||"loading"!==E.readyState&&!E.documentElement.doScroll?C.setTimeout(S.ready):(E.addEventListener("DOMContentLoaded",B),C.addEventListener("load",B));var $=function(e,t,n,r,i,o,a){var s=0,u=e.length,l=null==n;if("object"===w(n))for(s in i=!0,n)$(e,t,s,n[s],!0,o,a);else if(void 0!==r&&(i=!0,m(r)||(a=!0),l&&(a?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(S(e),n)})),t))for(;s<u;s++)t(e[s],n,a?r:r.call(e[s],s,t(e[s],n)));return i?e:l?t.call(e):u?t(e[0],n):o},_=/^-ms-/,z=/-([a-z])/g;function U(e,t){return t.toUpperCase()}function X(e){return e.replace(_,"ms-").replace(z,U)}var V=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function G(){this.expando=S.expando+G.uid++}G.uid=1,G.prototype={cache:function(e){var t=e[this.expando];return t||(t={},V(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[X(t)]=n;else for(r in t)i[X(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][X(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(X):(t=X(t))in r?[t]:t.match(P)||[]).length;while(n--)delete r[t[n]]}(void 0===t||S.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!S.isEmptyObject(t)}};var Y=new G,Q=new G,J=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,K=/[A-Z]/g;function Z(e,t,n){var r,i;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(K,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n="true"===(i=n)||"false"!==i&&("null"===i?null:i===+i+""?+i:J.test(i)?JSON.parse(i):i)}catch(e){}Q.set(e,t,n)}else n=void 0;return n}S.extend({hasData:function(e){return Q.hasData(e)||Y.hasData(e)},data:function(e,t,n){return Q.access(e,t,n)},removeData:function(e,t){Q.remove(e,t)},_data:function(e,t,n){return Y.access(e,t,n)},_removeData:function(e,t){Y.remove(e,t)}}),S.fn.extend({data:function(n,e){var t,r,i,o=this[0],a=o&&o.attributes;if(void 0===n){if(this.length&&(i=Q.get(o),1===o.nodeType&&!Y.get(o,"hasDataAttrs"))){t=a.length;while(t--)a[t]&&0===(r=a[t].name).indexOf("data-")&&(r=X(r.slice(5)),Z(o,r,i[r]));Y.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof n?this.each(function(){Q.set(this,n)}):$(this,function(e){var t;if(o&&void 0===e)return void 0!==(t=Q.get(o,n))?t:void 0!==(t=Z(o,n))?t:void 0;this.each(function(){Q.set(this,n,e)})},null,e,1<arguments.length,null,!0)},removeData:function(e){return this.each(function(){Q.remove(this,e)})}}),S.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=Y.get(e,t),n&&(!r||Array.isArray(n)?r=Y.access(e,t,S.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=S.queue(e,t),r=n.length,i=n.shift(),o=S._queueHooks(e,t);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,function(){S.dequeue(e,t)},o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return Y.get(e,n)||Y.access(e,n,{empty:S.Callbacks("once memory").add(function(){Y.remove(e,[t+"queue",n])})})}}),S.fn.extend({queue:function(t,n){var e=2;return"string"!=typeof t&&(n=t,t="fx",e--),arguments.length<e?S.queue(this[0],t):void 0===n?this:this.each(function(){var e=S.queue(this,t,n);S._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&S.dequeue(this,t)})},dequeue:function(e){return this.each(function(){S.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=S.Deferred(),o=this,a=this.length,s=function(){--r||i.resolveWith(o,[o])};"string"!=typeof e&&(t=e,e=void 0),e=e||"fx";while(a--)(n=Y.get(o[a],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(s));return s(),i.promise(t)}});var ee=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,te=new RegExp("^(?:([+-])=|)("+ee+")([a-z%]*)$","i"),ne=["Top","Right","Bottom","Left"],re=E.documentElement,ie=function(e){return S.contains(e.ownerDocument,e)},oe={composed:!0};re.getRootNode&&(ie=function(e){return S.contains(e.ownerDocument,e)||e.getRootNode(oe)===e.ownerDocument});var ae=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&ie(e)&&"none"===S.css(e,"display")};function se(e,t,n,r){var i,o,a=20,s=r?function(){return r.cur()}:function(){return S.css(e,t,"")},u=s(),l=n&&n[3]||(S.cssNumber[t]?"":"px"),c=e.nodeType&&(S.cssNumber[t]||"px"!==l&&+u)&&te.exec(S.css(e,t));if(c&&c[3]!==l){u/=2,l=l||c[3],c=+u||1;while(a--)S.style(e,t,c+l),(1-o)*(1-(o=s()/u||.5))<=0&&(a=0),c/=o;c*=2,S.style(e,t,c+l),n=n||[]}return n&&(c=+c||+u||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=l,r.start=c,r.end=i)),i}var ue={};function le(e,t){for(var n,r,i,o,a,s,u,l=[],c=0,f=e.length;c<f;c++)(r=e[c]).style&&(n=r.style.display,t?("none"===n&&(l[c]=Y.get(r,"display")||null,l[c]||(r.style.display="")),""===r.style.display&&ae(r)&&(l[c]=(u=a=o=void 0,a=(i=r).ownerDocument,s=i.nodeName,(u=ue[s])||(o=a.body.appendChild(a.createElement(s)),u=S.css(o,"display"),o.parentNode.removeChild(o),"none"===u&&(u="block"),ue[s]=u)))):"none"!==n&&(l[c]="none",Y.set(r,"display",n)));for(c=0;c<f;c++)null!=l[c]&&(e[c].style.display=l[c]);return e}S.fn.extend({show:function(){return le(this,!0)},hide:function(){return le(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){ae(this)?S(this).show():S(this).hide()})}});var ce,fe,pe=/^(?:checkbox|radio)$/i,de=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,he=/^$|^module$|\/(?:java|ecma)script/i;ce=E.createDocumentFragment().appendChild(E.createElement("div")),(fe=E.createElement("input")).setAttribute("type","radio"),fe.setAttribute("checked","checked"),fe.setAttribute("name","t"),ce.appendChild(fe),y.checkClone=ce.cloneNode(!0).cloneNode(!0).lastChild.checked,ce.innerHTML="<textarea>x</textarea>",y.noCloneChecked=!!ce.cloneNode(!0).lastChild.defaultValue,ce.innerHTML="<option></option>",y.option=!!ce.lastChild;var ge={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function ve(e,t){var n;return n="undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t||"*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&A(e,t)?S.merge([e],n):n}function ye(e,t){for(var n=0,r=e.length;n<r;n++)Y.set(e[n],"globalEval",!t||Y.get(t[n],"globalEval"))}ge.tbody=ge.tfoot=ge.colgroup=ge.caption=ge.thead,ge.th=ge.td,y.option||(ge.optgroup=ge.option=[1,"<select multiple='multiple'>","</select>"]);var me=/<|&#?\w+;/;function xe(e,t,n,r,i){for(var o,a,s,u,l,c,f=t.createDocumentFragment(),p=[],d=0,h=e.length;d<h;d++)if((o=e[d])||0===o)if("object"===w(o))S.merge(p,o.nodeType?[o]:o);else if(me.test(o)){a=a||f.appendChild(t.createElement("div")),s=(de.exec(o)||["",""])[1].toLowerCase(),u=ge[s]||ge._default,a.innerHTML=u[1]+S.htmlPrefilter(o)+u[2],c=u[0];while(c--)a=a.lastChild;S.merge(p,a.childNodes),(a=f.firstChild).textContent=""}else p.push(t.createTextNode(o));f.textContent="",d=0;while(o=p[d++])if(r&&-1<S.inArray(o,r))i&&i.push(o);else if(l=ie(o),a=ve(f.appendChild(o),"script"),l&&ye(a),n){c=0;while(o=a[c++])he.test(o.type||"")&&n.push(o)}return f}var be=/^key/,we=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Te=/^([^.]*)(?:\.(.+)|)/;function Ce(){return!0}function Ee(){return!1}function Se(e,t){return e===function(){try{return E.activeElement}catch(e){}}()==("focus"===t)}function ke(e,t,n,r,i,o){var a,s;if("object"==typeof t){for(s in"string"!=typeof n&&(r=r||n,n=void 0),t)ke(e,s,n,r,t[s],o);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=Ee;else if(!i)return e;return 1===o&&(a=i,(i=function(e){return S().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=S.guid++)),e.each(function(){S.event.add(this,t,i,r,n)})}function Ae(e,i,o){o?(Y.set(e,i,!1),S.event.add(e,i,{namespace:!1,handler:function(e){var t,n,r=Y.get(this,i);if(1&e.isTrigger&&this[i]){if(r.length)(S.event.special[i]||{}).delegateType&&e.stopPropagation();else if(r=s.call(arguments),Y.set(this,i,r),t=o(this,i),this[i](),r!==(n=Y.get(this,i))||t?Y.set(this,i,!1):n={},r!==n)return e.stopImmediatePropagation(),e.preventDefault(),n.value}else r.length&&(Y.set(this,i,{value:S.event.trigger(S.extend(r[0],S.Event.prototype),r.slice(1),this)}),e.stopImmediatePropagation())}})):void 0===Y.get(e,i)&&S.event.add(e,i,Ce)}S.event={global:{},add:function(t,e,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,v=Y.get(t);if(V(t)){n.handler&&(n=(o=n).handler,i=o.selector),i&&S.find.matchesSelector(re,i),n.guid||(n.guid=S.guid++),(u=v.events)||(u=v.events=Object.create(null)),(a=v.handle)||(a=v.handle=function(e){return"undefined"!=typeof S&&S.event.triggered!==e.type?S.event.dispatch.apply(t,arguments):void 0}),l=(e=(e||"").match(P)||[""]).length;while(l--)d=g=(s=Te.exec(e[l])||[])[1],h=(s[2]||"").split(".").sort(),d&&(f=S.event.special[d]||{},d=(i?f.delegateType:f.bindType)||d,f=S.event.special[d]||{},c=S.extend({type:d,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&S.expr.match.needsContext.test(i),namespace:h.join(".")},o),(p=u[d])||((p=u[d]=[]).delegateCount=0,f.setup&&!1!==f.setup.call(t,r,h,a)||t.addEventListener&&t.addEventListener(d,a)),f.add&&(f.add.call(t,c),c.handler.guid||(c.handler.guid=n.guid)),i?p.splice(p.delegateCount++,0,c):p.push(c),S.event.global[d]=!0)}},remove:function(e,t,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,v=Y.hasData(e)&&Y.get(e);if(v&&(u=v.events)){l=(t=(t||"").match(P)||[""]).length;while(l--)if(d=g=(s=Te.exec(t[l])||[])[1],h=(s[2]||"").split(".").sort(),d){f=S.event.special[d]||{},p=u[d=(r?f.delegateType:f.bindType)||d]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=p.length;while(o--)c=p[o],!i&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(p.splice(o,1),c.selector&&p.delegateCount--,f.remove&&f.remove.call(e,c));a&&!p.length&&(f.teardown&&!1!==f.teardown.call(e,h,v.handle)||S.removeEvent(e,d,v.handle),delete u[d])}else for(d in u)S.event.remove(e,d+t[l],n,r,!0);S.isEmptyObject(u)&&Y.remove(e,"handle events")}},dispatch:function(e){var t,n,r,i,o,a,s=new Array(arguments.length),u=S.event.fix(e),l=(Y.get(this,"events")||Object.create(null))[u.type]||[],c=S.event.special[u.type]||{};for(s[0]=u,t=1;t<arguments.length;t++)s[t]=arguments[t];if(u.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,u)){a=S.event.handlers.call(this,u,l),t=0;while((i=a[t++])&&!u.isPropagationStopped()){u.currentTarget=i.elem,n=0;while((o=i.handlers[n++])&&!u.isImmediatePropagationStopped())u.rnamespace&&!1!==o.namespace&&!u.rnamespace.test(o.namespace)||(u.handleObj=o,u.data=o.data,void 0!==(r=((S.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,s))&&!1===(u.result=r)&&(u.preventDefault(),u.stopPropagation()))}return c.postDispatch&&c.postDispatch.call(this,u),u.result}},handlers:function(e,t){var n,r,i,o,a,s=[],u=t.delegateCount,l=e.target;if(u&&l.nodeType&&!("click"===e.type&&1<=e.button))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==e.type||!0!==l.disabled)){for(o=[],a={},n=0;n<u;n++)void 0===a[i=(r=t[n]).selector+" "]&&(a[i]=r.needsContext?-1<S(i,this).index(l):S.find(i,this,null,[l]).length),a[i]&&o.push(r);o.length&&s.push({elem:l,handlers:o})}return l=this,u<t.length&&s.push({elem:l,handlers:t.slice(u)}),s},addProp:function(t,e){Object.defineProperty(S.Event.prototype,t,{enumerable:!0,configurable:!0,get:m(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(e){return e[S.expando]?e:new S.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return pe.test(t.type)&&t.click&&A(t,"input")&&Ae(t,"click",Ce),!1},trigger:function(e){var t=this||e;return pe.test(t.type)&&t.click&&A(t,"input")&&Ae(t,"click"),!0},_default:function(e){var t=e.target;return pe.test(t.type)&&t.click&&A(t,"input")&&Y.get(t,"click")||A(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},S.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},S.Event=function(e,t){if(!(this instanceof S.Event))return new S.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?Ce:Ee,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&S.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[S.expando]=!0},S.Event.prototype={constructor:S.Event,isDefaultPrevented:Ee,isPropagationStopped:Ee,isImmediatePropagationStopped:Ee,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Ce,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Ce,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Ce,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},S.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(e){var t=e.button;return null==e.which&&be.test(e.type)?null!=e.charCode?e.charCode:e.keyCode:!e.which&&void 0!==t&&we.test(e.type)?1&t?1:2&t?3:4&t?2:0:e.which}},S.event.addProp),S.each({focus:"focusin",blur:"focusout"},function(e,t){S.event.special[e]={setup:function(){return Ae(this,e,Se),!1},trigger:function(){return Ae(this,e),!0},delegateType:t}}),S.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,i){S.event.special[e]={delegateType:i,bindType:i,handle:function(e){var t,n=e.relatedTarget,r=e.handleObj;return n&&(n===this||S.contains(this,n))||(e.type=r.origType,t=r.handler.apply(this,arguments),e.type=i),t}}}),S.fn.extend({on:function(e,t,n,r){return ke(this,e,t,n,r)},one:function(e,t,n,r){return ke(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,S(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=Ee),this.each(function(){S.event.remove(this,e,n,t)})}});var Ne=/<script|<style|<link/i,De=/checked\s*(?:[^=]|=\s*.checked.)/i,je=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function qe(e,t){return A(e,"table")&&A(11!==t.nodeType?t:t.firstChild,"tr")&&S(e).children("tbody")[0]||e}function Le(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function He(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Oe(e,t){var n,r,i,o,a,s;if(1===t.nodeType){if(Y.hasData(e)&&(s=Y.get(e).events))for(i in Y.remove(t,"handle events"),s)for(n=0,r=s[i].length;n<r;n++)S.event.add(t,i,s[i][n]);Q.hasData(e)&&(o=Q.access(e),a=S.extend({},o),Q.set(t,a))}}function Pe(n,r,i,o){r=g(r);var e,t,a,s,u,l,c=0,f=n.length,p=f-1,d=r[0],h=m(d);if(h||1<f&&"string"==typeof d&&!y.checkClone&&De.test(d))return n.each(function(e){var t=n.eq(e);h&&(r[0]=d.call(this,e,t.html())),Pe(t,r,i,o)});if(f&&(t=(e=xe(r,n[0].ownerDocument,!1,n,o)).firstChild,1===e.childNodes.length&&(e=t),t||o)){for(s=(a=S.map(ve(e,"script"),Le)).length;c<f;c++)u=e,c!==p&&(u=S.clone(u,!0,!0),s&&S.merge(a,ve(u,"script"))),i.call(n[c],u,c);if(s)for(l=a[a.length-1].ownerDocument,S.map(a,He),c=0;c<s;c++)u=a[c],he.test(u.type||"")&&!Y.access(u,"globalEval")&&S.contains(l,u)&&(u.src&&"module"!==(u.type||"").toLowerCase()?S._evalUrl&&!u.noModule&&S._evalUrl(u.src,{nonce:u.nonce||u.getAttribute("nonce")},l):b(u.textContent.replace(je,""),u,l))}return n}function Re(e,t,n){for(var r,i=t?S.filter(t,e):e,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||S.cleanData(ve(r)),r.parentNode&&(n&&ie(r)&&ye(ve(r,"script")),r.parentNode.removeChild(r));return e}S.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var r,i,o,a,s,u,l,c=e.cloneNode(!0),f=ie(e);if(!(y.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||S.isXMLDoc(e)))for(a=ve(c),r=0,i=(o=ve(e)).length;r<i;r++)s=o[r],u=a[r],void 0,"input"===(l=u.nodeName.toLowerCase())&&pe.test(s.type)?u.checked=s.checked:"input"!==l&&"textarea"!==l||(u.defaultValue=s.defaultValue);if(t)if(n)for(o=o||ve(e),a=a||ve(c),r=0,i=o.length;r<i;r++)Oe(o[r],a[r]);else Oe(e,c);return 0<(a=ve(c,"script")).length&&ye(a,!f&&ve(e,"script")),c},cleanData:function(e){for(var t,n,r,i=S.event.special,o=0;void 0!==(n=e[o]);o++)if(V(n)){if(t=n[Y.expando]){if(t.events)for(r in t.events)i[r]?S.event.remove(n,r):S.removeEvent(n,r,t.handle);n[Y.expando]=void 0}n[Q.expando]&&(n[Q.expando]=void 0)}}}),S.fn.extend({detach:function(e){return Re(this,e,!0)},remove:function(e){return Re(this,e)},text:function(e){return $(this,function(e){return void 0===e?S.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return Pe(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||qe(this,e).appendChild(e)})},prepend:function(){return Pe(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=qe(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return Pe(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return Pe(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(S.cleanData(ve(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return S.clone(this,e,t)})},html:function(e){return $(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Ne.test(e)&&!ge[(de.exec(e)||["",""])[1].toLowerCase()]){e=S.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(S.cleanData(ve(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var n=[];return Pe(this,arguments,function(e){var t=this.parentNode;S.inArray(this,n)<0&&(S.cleanData(ve(this)),t&&t.replaceChild(e,this))},n)}}),S.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,a){S.fn[e]=function(e){for(var t,n=[],r=S(e),i=r.length-1,o=0;o<=i;o++)t=o===i?this:this.clone(!0),S(r[o])[a](t),u.apply(n,t.get());return this.pushStack(n)}});var Me=new RegExp("^("+ee+")(?!px)[a-z%]+$","i"),Ie=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=C),t.getComputedStyle(e)},We=function(e,t,n){var r,i,o={};for(i in t)o[i]=e.style[i],e.style[i]=t[i];for(i in r=n.call(e),t)e.style[i]=o[i];return r},Fe=new RegExp(ne.join("|"),"i");function Be(e,t,n){var r,i,o,a,s=e.style;return(n=n||Ie(e))&&(""!==(a=n.getPropertyValue(t)||n[t])||ie(e)||(a=S.style(e,t)),!y.pixelBoxStyles()&&Me.test(a)&&Fe.test(t)&&(r=s.width,i=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=r,s.minWidth=i,s.maxWidth=o)),void 0!==a?a+"":a}function $e(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(l){u.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",l.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",re.appendChild(u).appendChild(l);var e=C.getComputedStyle(l);n="1%"!==e.top,s=12===t(e.marginLeft),l.style.right="60%",o=36===t(e.right),r=36===t(e.width),l.style.position="absolute",i=12===t(l.offsetWidth/3),re.removeChild(u),l=null}}function t(e){return Math.round(parseFloat(e))}var n,r,i,o,a,s,u=E.createElement("div"),l=E.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",y.clearCloneStyle="content-box"===l.style.backgroundClip,S.extend(y,{boxSizingReliable:function(){return e(),r},pixelBoxStyles:function(){return e(),o},pixelPosition:function(){return e(),n},reliableMarginLeft:function(){return e(),s},scrollboxSize:function(){return e(),i},reliableTrDimensions:function(){var e,t,n,r;return null==a&&(e=E.createElement("table"),t=E.createElement("tr"),n=E.createElement("div"),e.style.cssText="position:absolute;left:-11111px",t.style.height="1px",n.style.height="9px",re.appendChild(e).appendChild(t).appendChild(n),r=C.getComputedStyle(t),a=3<parseInt(r.height),re.removeChild(e)),a}}))}();var _e=["Webkit","Moz","ms"],ze=E.createElement("div").style,Ue={};function Xe(e){var t=S.cssProps[e]||Ue[e];return t||(e in ze?e:Ue[e]=function(e){var t=e[0].toUpperCase()+e.slice(1),n=_e.length;while(n--)if((e=_e[n]+t)in ze)return e}(e)||e)}var Ve=/^(none|table(?!-c[ea]).+)/,Ge=/^--/,Ye={position:"absolute",visibility:"hidden",display:"block"},Qe={letterSpacing:"0",fontWeight:"400"};function Je(e,t,n){var r=te.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function Ke(e,t,n,r,i,o){var a="width"===t?1:0,s=0,u=0;if(n===(r?"border":"content"))return 0;for(;a<4;a+=2)"margin"===n&&(u+=S.css(e,n+ne[a],!0,i)),r?("content"===n&&(u-=S.css(e,"padding"+ne[a],!0,i)),"margin"!==n&&(u-=S.css(e,"border"+ne[a]+"Width",!0,i))):(u+=S.css(e,"padding"+ne[a],!0,i),"padding"!==n?u+=S.css(e,"border"+ne[a]+"Width",!0,i):s+=S.css(e,"border"+ne[a]+"Width",!0,i));return!r&&0<=o&&(u+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-u-s-.5))||0),u}function Ze(e,t,n){var r=Ie(e),i=(!y.boxSizingReliable()||n)&&"border-box"===S.css(e,"boxSizing",!1,r),o=i,a=Be(e,t,r),s="offset"+t[0].toUpperCase()+t.slice(1);if(Me.test(a)){if(!n)return a;a="auto"}return(!y.boxSizingReliable()&&i||!y.reliableTrDimensions()&&A(e,"tr")||"auto"===a||!parseFloat(a)&&"inline"===S.css(e,"display",!1,r))&&e.getClientRects().length&&(i="border-box"===S.css(e,"boxSizing",!1,r),(o=s in e)&&(a=e[s])),(a=parseFloat(a)||0)+Ke(e,t,n||(i?"border":"content"),o,r,a)+"px"}function et(e,t,n,r,i){return new et.prototype.init(e,t,n,r,i)}S.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Be(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,a,s=X(t),u=Ge.test(t),l=e.style;if(u||(t=Xe(s)),a=S.cssHooks[t]||S.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(i=a.get(e,!1,r))?i:l[t];"string"===(o=typeof n)&&(i=te.exec(n))&&i[1]&&(n=se(e,t,i),o="number"),null!=n&&n==n&&("number"!==o||u||(n+=i&&i[3]||(S.cssNumber[s]?"":"px")),y.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,r))||(u?l.setProperty(t,n):l[t]=n))}},css:function(e,t,n,r){var i,o,a,s=X(t);return Ge.test(t)||(t=Xe(s)),(a=S.cssHooks[t]||S.cssHooks[s])&&"get"in a&&(i=a.get(e,!0,n)),void 0===i&&(i=Be(e,t,r)),"normal"===i&&t in Qe&&(i=Qe[t]),""===n||n?(o=parseFloat(i),!0===n||isFinite(o)?o||0:i):i}}),S.each(["height","width"],function(e,u){S.cssHooks[u]={get:function(e,t,n){if(t)return!Ve.test(S.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?Ze(e,u,n):We(e,Ye,function(){return Ze(e,u,n)})},set:function(e,t,n){var r,i=Ie(e),o=!y.scrollboxSize()&&"absolute"===i.position,a=(o||n)&&"border-box"===S.css(e,"boxSizing",!1,i),s=n?Ke(e,u,n,a,i):0;return a&&o&&(s-=Math.ceil(e["offset"+u[0].toUpperCase()+u.slice(1)]-parseFloat(i[u])-Ke(e,u,"border",!1,i)-.5)),s&&(r=te.exec(t))&&"px"!==(r[3]||"px")&&(e.style[u]=t,t=S.css(e,u)),Je(0,t,s)}}}),S.cssHooks.marginLeft=$e(y.reliableMarginLeft,function(e,t){if(t)return(parseFloat(Be(e,"marginLeft"))||e.getBoundingClientRect().left-We(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),S.each({margin:"",padding:"",border:"Width"},function(i,o){S.cssHooks[i+o]={expand:function(e){for(var t=0,n={},r="string"==typeof e?e.split(" "):[e];t<4;t++)n[i+ne[t]+o]=r[t]||r[t-2]||r[0];return n}},"margin"!==i&&(S.cssHooks[i+o].set=Je)}),S.fn.extend({css:function(e,t){return $(this,function(e,t,n){var r,i,o={},a=0;if(Array.isArray(t)){for(r=Ie(e),i=t.length;a<i;a++)o[t[a]]=S.css(e,t[a],!1,r);return o}return void 0!==n?S.style(e,t,n):S.css(e,t)},e,t,1<arguments.length)}}),((S.Tween=et).prototype={constructor:et,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||S.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(S.cssNumber[n]?"":"px")},cur:function(){var e=et.propHooks[this.prop];return e&&e.get?e.get(this):et.propHooks._default.get(this)},run:function(e){var t,n=et.propHooks[this.prop];return this.options.duration?this.pos=t=S.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):et.propHooks._default.set(this),this}}).init.prototype=et.prototype,(et.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=S.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){S.fx.step[e.prop]?S.fx.step[e.prop](e):1!==e.elem.nodeType||!S.cssHooks[e.prop]&&null==e.elem.style[Xe(e.prop)]?e.elem[e.prop]=e.now:S.style(e.elem,e.prop,e.now+e.unit)}}}).scrollTop=et.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},S.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},S.fx=et.prototype.init,S.fx.step={};var tt,nt,rt,it,ot=/^(?:toggle|show|hide)$/,at=/queueHooks$/;function st(){nt&&(!1===E.hidden&&C.requestAnimationFrame?C.requestAnimationFrame(st):C.setTimeout(st,S.fx.interval),S.fx.tick())}function ut(){return C.setTimeout(function(){tt=void 0}),tt=Date.now()}function lt(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=ne[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function ct(e,t,n){for(var r,i=(ft.tweeners[t]||[]).concat(ft.tweeners["*"]),o=0,a=i.length;o<a;o++)if(r=i[o].call(n,t,e))return r}function ft(o,e,t){var n,a,r=0,i=ft.prefilters.length,s=S.Deferred().always(function(){delete u.elem}),u=function(){if(a)return!1;for(var e=tt||ut(),t=Math.max(0,l.startTime+l.duration-e),n=1-(t/l.duration||0),r=0,i=l.tweens.length;r<i;r++)l.tweens[r].run(n);return s.notifyWith(o,[l,n,t]),n<1&&i?t:(i||s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l]),!1)},l=s.promise({elem:o,props:S.extend({},e),opts:S.extend(!0,{specialEasing:{},easing:S.easing._default},t),originalProperties:e,originalOptions:t,startTime:tt||ut(),duration:t.duration,tweens:[],createTween:function(e,t){var n=S.Tween(o,l.opts,e,t,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(n),n},stop:function(e){var t=0,n=e?l.tweens.length:0;if(a)return this;for(a=!0;t<n;t++)l.tweens[t].run(1);return e?(s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l,e])):s.rejectWith(o,[l,e]),this}}),c=l.props;for(!function(e,t){var n,r,i,o,a;for(n in e)if(i=t[r=X(n)],o=e[n],Array.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),(a=S.cssHooks[r])&&"expand"in a)for(n in o=a.expand(o),delete e[r],o)n in e||(e[n]=o[n],t[n]=i);else t[r]=i}(c,l.opts.specialEasing);r<i;r++)if(n=ft.prefilters[r].call(l,o,c,l.opts))return m(n.stop)&&(S._queueHooks(l.elem,l.opts.queue).stop=n.stop.bind(n)),n;return S.map(c,ct,l),m(l.opts.start)&&l.opts.start.call(o,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),S.fx.timer(S.extend(u,{elem:o,anim:l,queue:l.opts.queue})),l}S.Animation=S.extend(ft,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return se(n.elem,e,te.exec(t),n),n}]},tweener:function(e,t){m(e)?(t=e,e=["*"]):e=e.match(P);for(var n,r=0,i=e.length;r<i;r++)n=e[r],ft.tweeners[n]=ft.tweeners[n]||[],ft.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var r,i,o,a,s,u,l,c,f="width"in t||"height"in t,p=this,d={},h=e.style,g=e.nodeType&&ae(e),v=Y.get(e,"fxshow");for(r in n.queue||(null==(a=S._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,p.always(function(){p.always(function(){a.unqueued--,S.queue(e,"fx").length||a.empty.fire()})})),t)if(i=t[r],ot.test(i)){if(delete t[r],o=o||"toggle"===i,i===(g?"hide":"show")){if("show"!==i||!v||void 0===v[r])continue;g=!0}d[r]=v&&v[r]||S.style(e,r)}if((u=!S.isEmptyObject(t))||!S.isEmptyObject(d))for(r in f&&1===e.nodeType&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],null==(l=v&&v.display)&&(l=Y.get(e,"display")),"none"===(c=S.css(e,"display"))&&(l?c=l:(le([e],!0),l=e.style.display||l,c=S.css(e,"display"),le([e]))),("inline"===c||"inline-block"===c&&null!=l)&&"none"===S.css(e,"float")&&(u||(p.done(function(){h.display=l}),null==l&&(c=h.display,l="none"===c?"":c)),h.display="inline-block")),n.overflow&&(h.overflow="hidden",p.always(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]})),u=!1,d)u||(v?"hidden"in v&&(g=v.hidden):v=Y.access(e,"fxshow",{display:l}),o&&(v.hidden=!g),g&&le([e],!0),p.done(function(){for(r in g||le([e]),Y.remove(e,"fxshow"),d)S.style(e,r,d[r])})),u=ct(g?v[r]:0,r,p),r in v||(v[r]=u.start,g&&(u.end=u.start,u.start=0))}],prefilter:function(e,t){t?ft.prefilters.unshift(e):ft.prefilters.push(e)}}),S.speed=function(e,t,n){var r=e&&"object"==typeof e?S.extend({},e):{complete:n||!n&&t||m(e)&&e,duration:e,easing:n&&t||t&&!m(t)&&t};return S.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in S.fx.speeds?r.duration=S.fx.speeds[r.duration]:r.duration=S.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){m(r.old)&&r.old.call(this),r.queue&&S.dequeue(this,r.queue)},r},S.fn.extend({fadeTo:function(e,t,n,r){return this.filter(ae).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(t,e,n,r){var i=S.isEmptyObject(t),o=S.speed(e,n,r),a=function(){var e=ft(this,S.extend({},t),o);(i||Y.get(this,"finish"))&&e.stop(!0)};return a.finish=a,i||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(i,e,o){var a=function(e){var t=e.stop;delete e.stop,t(o)};return"string"!=typeof i&&(o=e,e=i,i=void 0),e&&this.queue(i||"fx",[]),this.each(function(){var e=!0,t=null!=i&&i+"queueHooks",n=S.timers,r=Y.get(this);if(t)r[t]&&r[t].stop&&a(r[t]);else for(t in r)r[t]&&r[t].stop&&at.test(t)&&a(r[t]);for(t=n.length;t--;)n[t].elem!==this||null!=i&&n[t].queue!==i||(n[t].anim.stop(o),e=!1,n.splice(t,1));!e&&o||S.dequeue(this,i)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var e,t=Y.get(this),n=t[a+"queue"],r=t[a+"queueHooks"],i=S.timers,o=n?n.length:0;for(t.finish=!0,S.queue(this,a,[]),r&&r.stop&&r.stop.call(this,!0),e=i.length;e--;)i[e].elem===this&&i[e].queue===a&&(i[e].anim.stop(!0),i.splice(e,1));for(e=0;e<o;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete t.finish})}}),S.each(["toggle","show","hide"],function(e,r){var i=S.fn[r];S.fn[r]=function(e,t,n){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(lt(r,!0),e,t,n)}}),S.each({slideDown:lt("show"),slideUp:lt("hide"),slideToggle:lt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,r){S.fn[e]=function(e,t,n){return this.animate(r,e,t,n)}}),S.timers=[],S.fx.tick=function(){var e,t=0,n=S.timers;for(tt=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||S.fx.stop(),tt=void 0},S.fx.timer=function(e){S.timers.push(e),S.fx.start()},S.fx.interval=13,S.fx.start=function(){nt||(nt=!0,st())},S.fx.stop=function(){nt=null},S.fx.speeds={slow:600,fast:200,_default:400},S.fn.delay=function(r,e){return r=S.fx&&S.fx.speeds[r]||r,e=e||"fx",this.queue(e,function(e,t){var n=C.setTimeout(e,r);t.stop=function(){C.clearTimeout(n)}})},rt=E.createElement("input"),it=E.createElement("select").appendChild(E.createElement("option")),rt.type="checkbox",y.checkOn=""!==rt.value,y.optSelected=it.selected,(rt=E.createElement("input")).value="t",rt.type="radio",y.radioValue="t"===rt.value;var pt,dt=S.expr.attrHandle;S.fn.extend({attr:function(e,t){return $(this,S.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){S.removeAttr(this,e)})}}),S.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return"undefined"==typeof e.getAttribute?S.prop(e,t,n):(1===o&&S.isXMLDoc(e)||(i=S.attrHooks[t.toLowerCase()]||(S.expr.match.bool.test(t)?pt:void 0)),void 0!==n?null===n?void S.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:null==(r=S.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!y.radioValue&&"radio"===t&&A(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(P);if(i&&1===e.nodeType)while(n=i[r++])e.removeAttribute(n)}}),pt={set:function(e,t,n){return!1===t?S.removeAttr(e,n):e.setAttribute(n,n),n}},S.each(S.expr.match.bool.source.match(/\w+/g),function(e,t){var a=dt[t]||S.find.attr;dt[t]=function(e,t,n){var r,i,o=t.toLowerCase();return n||(i=dt[o],dt[o]=r,r=null!=a(e,t,n)?o:null,dt[o]=i),r}});var ht=/^(?:input|select|textarea|button)$/i,gt=/^(?:a|area)$/i;function vt(e){return(e.match(P)||[]).join(" ")}function yt(e){return e.getAttribute&&e.getAttribute("class")||""}function mt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(P)||[]}S.fn.extend({prop:function(e,t){return $(this,S.prop,e,t,1<arguments.length)},removeProp:function(e){return this.each(function(){delete this[S.propFix[e]||e]})}}),S.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&S.isXMLDoc(e)||(t=S.propFix[t]||t,i=S.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=S.find.attr(e,"tabindex");return t?parseInt(t,10):ht.test(e.nodeName)||gt.test(e.nodeName)&&e.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),y.optSelected||(S.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),S.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){S.propFix[this.toLowerCase()]=this}),S.fn.extend({addClass:function(t){var e,n,r,i,o,a,s,u=0;if(m(t))return this.each(function(e){S(this).addClass(t.call(this,e,yt(this)))});if((e=mt(t)).length)while(n=this[u++])if(i=yt(n),r=1===n.nodeType&&" "+vt(i)+" "){a=0;while(o=e[a++])r.indexOf(" "+o+" ")<0&&(r+=o+" ");i!==(s=vt(r))&&n.setAttribute("class",s)}return this},removeClass:function(t){var e,n,r,i,o,a,s,u=0;if(m(t))return this.each(function(e){S(this).removeClass(t.call(this,e,yt(this)))});if(!arguments.length)return this.attr("class","");if((e=mt(t)).length)while(n=this[u++])if(i=yt(n),r=1===n.nodeType&&" "+vt(i)+" "){a=0;while(o=e[a++])while(-1<r.indexOf(" "+o+" "))r=r.replace(" "+o+" "," ");i!==(s=vt(r))&&n.setAttribute("class",s)}return this},toggleClass:function(i,t){var o=typeof i,a="string"===o||Array.isArray(i);return"boolean"==typeof t&&a?t?this.addClass(i):this.removeClass(i):m(i)?this.each(function(e){S(this).toggleClass(i.call(this,e,yt(this),t),t)}):this.each(function(){var e,t,n,r;if(a){t=0,n=S(this),r=mt(i);while(e=r[t++])n.hasClass(e)?n.removeClass(e):n.addClass(e)}else void 0!==i&&"boolean"!==o||((e=yt(this))&&Y.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===i?"":Y.get(this,"__className__")||""))})},hasClass:function(e){var t,n,r=0;t=" "+e+" ";while(n=this[r++])if(1===n.nodeType&&-1<(" "+vt(yt(n))+" ").indexOf(t))return!0;return!1}});var xt=/\r/g;S.fn.extend({val:function(n){var r,e,i,t=this[0];return arguments.length?(i=m(n),this.each(function(e){var t;1===this.nodeType&&(null==(t=i?n.call(this,e,S(this).val()):n)?t="":"number"==typeof t?t+="":Array.isArray(t)&&(t=S.map(t,function(e){return null==e?"":e+""})),(r=S.valHooks[this.type]||S.valHooks[this.nodeName.toLowerCase()])&&"set"in r&&void 0!==r.set(this,t,"value")||(this.value=t))})):t?(r=S.valHooks[t.type]||S.valHooks[t.nodeName.toLowerCase()])&&"get"in r&&void 0!==(e=r.get(t,"value"))?e:"string"==typeof(e=t.value)?e.replace(xt,""):null==e?"":e:void 0}}),S.extend({valHooks:{option:{get:function(e){var t=S.find.attr(e,"value");return null!=t?t:vt(S.text(e))}},select:{get:function(e){var t,n,r,i=e.options,o=e.selectedIndex,a="select-one"===e.type,s=a?null:[],u=a?o+1:i.length;for(r=o<0?u:a?o:0;r<u;r++)if(((n=i[r]).selected||r===o)&&!n.disabled&&(!n.parentNode.disabled||!A(n.parentNode,"optgroup"))){if(t=S(n).val(),a)return t;s.push(t)}return s},set:function(e,t){var n,r,i=e.options,o=S.makeArray(t),a=i.length;while(a--)((r=i[a]).selected=-1<S.inArray(S.valHooks.option.get(r),o))&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),S.each(["radio","checkbox"],function(){S.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=-1<S.inArray(S(e).val(),t)}},y.checkOn||(S.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),y.focusin="onfocusin"in C;var bt=/^(?:focusinfocus|focusoutblur)$/,wt=function(e){e.stopPropagation()};S.extend(S.event,{trigger:function(e,t,n,r){var i,o,a,s,u,l,c,f,p=[n||E],d=v.call(e,"type")?e.type:e,h=v.call(e,"namespace")?e.namespace.split("."):[];if(o=f=a=n=n||E,3!==n.nodeType&&8!==n.nodeType&&!bt.test(d+S.event.triggered)&&(-1<d.indexOf(".")&&(d=(h=d.split(".")).shift(),h.sort()),u=d.indexOf(":")<0&&"on"+d,(e=e[S.expando]?e:new S.Event(d,"object"==typeof e&&e)).isTrigger=r?2:3,e.namespace=h.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:S.makeArray(t,[e]),c=S.event.special[d]||{},r||!c.trigger||!1!==c.trigger.apply(n,t))){if(!r&&!c.noBubble&&!x(n)){for(s=c.delegateType||d,bt.test(s+d)||(o=o.parentNode);o;o=o.parentNode)p.push(o),a=o;a===(n.ownerDocument||E)&&p.push(a.defaultView||a.parentWindow||C)}i=0;while((o=p[i++])&&!e.isPropagationStopped())f=o,e.type=1<i?s:c.bindType||d,(l=(Y.get(o,"events")||Object.create(null))[e.type]&&Y.get(o,"handle"))&&l.apply(o,t),(l=u&&o[u])&&l.apply&&V(o)&&(e.result=l.apply(o,t),!1===e.result&&e.preventDefault());return e.type=d,r||e.isDefaultPrevented()||c._default&&!1!==c._default.apply(p.pop(),t)||!V(n)||u&&m(n[d])&&!x(n)&&((a=n[u])&&(n[u]=null),S.event.triggered=d,e.isPropagationStopped()&&f.addEventListener(d,wt),n[d](),e.isPropagationStopped()&&f.removeEventListener(d,wt),S.event.triggered=void 0,a&&(n[u]=a)),e.result}},simulate:function(e,t,n){var r=S.extend(new S.Event,n,{type:e,isSimulated:!0});S.event.trigger(r,null,t)}}),S.fn.extend({trigger:function(e,t){return this.each(function(){S.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return S.event.trigger(e,t,n,!0)}}),y.focusin||S.each({focus:"focusin",blur:"focusout"},function(n,r){var i=function(e){S.event.simulate(r,e.target,S.event.fix(e))};S.event.special[r]={setup:function(){var e=this.ownerDocument||this.document||this,t=Y.access(e,r);t||e.addEventListener(n,i,!0),Y.access(e,r,(t||0)+1)},teardown:function(){var e=this.ownerDocument||this.document||this,t=Y.access(e,r)-1;t?Y.access(e,r,t):(e.removeEventListener(n,i,!0),Y.remove(e,r))}}});var Tt=C.location,Ct={guid:Date.now()},Et=/\?/;S.parseXML=function(e){var t;if(!e||"string"!=typeof e)return null;try{t=(new C.DOMParser).parseFromString(e,"text/xml")}catch(e){t=void 0}return t&&!t.getElementsByTagName("parsererror").length||S.error("Invalid XML: "+e),t};var St=/\[\]$/,kt=/\r?\n/g,At=/^(?:submit|button|image|reset|file)$/i,Nt=/^(?:input|select|textarea|keygen)/i;function Dt(n,e,r,i){var t;if(Array.isArray(e))S.each(e,function(e,t){r||St.test(n)?i(n,t):Dt(n+"["+("object"==typeof t&&null!=t?e:"")+"]",t,r,i)});else if(r||"object"!==w(e))i(n,e);else for(t in e)Dt(n+"["+t+"]",e[t],r,i)}S.param=function(e,t){var n,r=[],i=function(e,t){var n=m(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!S.isPlainObject(e))S.each(e,function(){i(this.name,this.value)});else for(n in e)Dt(n,e[n],t,i);return r.join("&")},S.fn.extend({serialize:function(){return S.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=S.prop(this,"elements");return e?S.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!S(this).is(":disabled")&&Nt.test(this.nodeName)&&!At.test(e)&&(this.checked||!pe.test(e))}).map(function(e,t){var n=S(this).val();return null==n?null:Array.isArray(n)?S.map(n,function(e){return{name:t.name,value:e.replace(kt,"\r\n")}}):{name:t.name,value:n.replace(kt,"\r\n")}}).get()}});var jt=/%20/g,qt=/#.*$/,Lt=/([?&])_=[^&]*/,Ht=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ot=/^(?:GET|HEAD)$/,Pt=/^\/\//,Rt={},Mt={},It="*/".concat("*"),Wt=E.createElement("a");function Ft(o){return function(e,t){"string"!=typeof e&&(t=e,e="*");var n,r=0,i=e.toLowerCase().match(P)||[];if(m(t))while(n=i[r++])"+"===n[0]?(n=n.slice(1)||"*",(o[n]=o[n]||[]).unshift(t)):(o[n]=o[n]||[]).push(t)}}function Bt(t,i,o,a){var s={},u=t===Mt;function l(e){var r;return s[e]=!0,S.each(t[e]||[],function(e,t){var n=t(i,o,a);return"string"!=typeof n||u||s[n]?u?!(r=n):void 0:(i.dataTypes.unshift(n),l(n),!1)}),r}return l(i.dataTypes[0])||!s["*"]&&l("*")}function $t(e,t){var n,r,i=S.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&S.extend(!0,e,r),e}Wt.href=Tt.href,S.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Tt.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Tt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":It,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":S.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?$t($t(e,S.ajaxSettings),t):$t(S.ajaxSettings,e)},ajaxPrefilter:Ft(Rt),ajaxTransport:Ft(Mt),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var c,f,p,n,d,r,h,g,i,o,v=S.ajaxSetup({},t),y=v.context||v,m=v.context&&(y.nodeType||y.jquery)?S(y):S.event,x=S.Deferred(),b=S.Callbacks("once memory"),w=v.statusCode||{},a={},s={},u="canceled",T={readyState:0,getResponseHeader:function(e){var t;if(h){if(!n){n={};while(t=Ht.exec(p))n[t[1].toLowerCase()+" "]=(n[t[1].toLowerCase()+" "]||[]).concat(t[2])}t=n[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return h?p:null},setRequestHeader:function(e,t){return null==h&&(e=s[e.toLowerCase()]=s[e.toLowerCase()]||e,a[e]=t),this},overrideMimeType:function(e){return null==h&&(v.mimeType=e),this},statusCode:function(e){var t;if(e)if(h)T.always(e[T.status]);else for(t in e)w[t]=[w[t],e[t]];return this},abort:function(e){var t=e||u;return c&&c.abort(t),l(0,t),this}};if(x.promise(T),v.url=((e||v.url||Tt.href)+"").replace(Pt,Tt.protocol+"//"),v.type=t.method||t.type||v.method||v.type,v.dataTypes=(v.dataType||"*").toLowerCase().match(P)||[""],null==v.crossDomain){r=E.createElement("a");try{r.href=v.url,r.href=r.href,v.crossDomain=Wt.protocol+"//"+Wt.host!=r.protocol+"//"+r.host}catch(e){v.crossDomain=!0}}if(v.data&&v.processData&&"string"!=typeof v.data&&(v.data=S.param(v.data,v.traditional)),Bt(Rt,v,t,T),h)return T;for(i in(g=S.event&&v.global)&&0==S.active++&&S.event.trigger("ajaxStart"),v.type=v.type.toUpperCase(),v.hasContent=!Ot.test(v.type),f=v.url.replace(qt,""),v.hasContent?v.data&&v.processData&&0===(v.contentType||"").indexOf("application/x-www-form-urlencoded")&&(v.data=v.data.replace(jt,"+")):(o=v.url.slice(f.length),v.data&&(v.processData||"string"==typeof v.data)&&(f+=(Et.test(f)?"&":"?")+v.data,delete v.data),!1===v.cache&&(f=f.replace(Lt,"$1"),o=(Et.test(f)?"&":"?")+"_="+Ct.guid+++o),v.url=f+o),v.ifModified&&(S.lastModified[f]&&T.setRequestHeader("If-Modified-Since",S.lastModified[f]),S.etag[f]&&T.setRequestHeader("If-None-Match",S.etag[f])),(v.data&&v.hasContent&&!1!==v.contentType||t.contentType)&&T.setRequestHeader("Content-Type",v.contentType),T.setRequestHeader("Accept",v.dataTypes[0]&&v.accepts[v.dataTypes[0]]?v.accepts[v.dataTypes[0]]+("*"!==v.dataTypes[0]?", "+It+"; q=0.01":""):v.accepts["*"]),v.headers)T.setRequestHeader(i,v.headers[i]);if(v.beforeSend&&(!1===v.beforeSend.call(y,T,v)||h))return T.abort();if(u="abort",b.add(v.complete),T.done(v.success),T.fail(v.error),c=Bt(Mt,v,t,T)){if(T.readyState=1,g&&m.trigger("ajaxSend",[T,v]),h)return T;v.async&&0<v.timeout&&(d=C.setTimeout(function(){T.abort("timeout")},v.timeout));try{h=!1,c.send(a,l)}catch(e){if(h)throw e;l(-1,e)}}else l(-1,"No Transport");function l(e,t,n,r){var i,o,a,s,u,l=t;h||(h=!0,d&&C.clearTimeout(d),c=void 0,p=r||"",T.readyState=0<e?4:0,i=200<=e&&e<300||304===e,n&&(s=function(e,t,n){var r,i,o,a,s=e.contents,u=e.dataTypes;while("*"===u[0])u.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in s)if(s[i]&&s[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}a||(a=i)}o=o||a}if(o)return o!==u[0]&&u.unshift(o),n[o]}(v,T,n)),!i&&-1<S.inArray("script",v.dataTypes)&&(v.converters["text script"]=function(){}),s=function(e,t,n,r){var i,o,a,s,u,l={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)l[a.toLowerCase()]=e.converters[a];o=c.shift();while(o)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(a=l[u+" "+o]||l["* "+o]))for(i in l)if((s=i.split(" "))[1]===o&&(a=l[u+" "+s[0]]||l["* "+s[0]])){!0===a?a=l[i]:!0!==l[i]&&(o=s[0],c.unshift(s[1]));break}if(!0!==a)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}(v,s,T,i),i?(v.ifModified&&((u=T.getResponseHeader("Last-Modified"))&&(S.lastModified[f]=u),(u=T.getResponseHeader("etag"))&&(S.etag[f]=u)),204===e||"HEAD"===v.type?l="nocontent":304===e?l="notmodified":(l=s.state,o=s.data,i=!(a=s.error))):(a=l,!e&&l||(l="error",e<0&&(e=0))),T.status=e,T.statusText=(t||l)+"",i?x.resolveWith(y,[o,l,T]):x.rejectWith(y,[T,l,a]),T.statusCode(w),w=void 0,g&&m.trigger(i?"ajaxSuccess":"ajaxError",[T,v,i?o:a]),b.fireWith(y,[T,l]),g&&(m.trigger("ajaxComplete",[T,v]),--S.active||S.event.trigger("ajaxStop")))}return T},getJSON:function(e,t,n){return S.get(e,t,n,"json")},getScript:function(e,t){return S.get(e,void 0,t,"script")}}),S.each(["get","post"],function(e,i){S[i]=function(e,t,n,r){return m(t)&&(r=r||n,n=t,t=void 0),S.ajax(S.extend({url:e,type:i,dataType:r,data:t,success:n},S.isPlainObject(e)&&e))}}),S.ajaxPrefilter(function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")}),S._evalUrl=function(e,t,n){return S.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){S.globalEval(e,t,n)}})},S.fn.extend({wrapAll:function(e){var t;return this[0]&&(m(e)&&(e=e.call(this[0])),t=S(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(n){return m(n)?this.each(function(e){S(this).wrapInner(n.call(this,e))}):this.each(function(){var e=S(this),t=e.contents();t.length?t.wrapAll(n):e.append(n)})},wrap:function(t){var n=m(t);return this.each(function(e){S(this).wrapAll(n?t.call(this,e):t)})},unwrap:function(e){return this.parent(e).not("body").each(function(){S(this).replaceWith(this.childNodes)}),this}}),S.expr.pseudos.hidden=function(e){return!S.expr.pseudos.visible(e)},S.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},S.ajaxSettings.xhr=function(){try{return new C.XMLHttpRequest}catch(e){}};var _t={0:200,1223:204},zt=S.ajaxSettings.xhr();y.cors=!!zt&&"withCredentials"in zt,y.ajax=zt=!!zt,S.ajaxTransport(function(i){var o,a;if(y.cors||zt&&!i.crossDomain)return{send:function(e,t){var n,r=i.xhr();if(r.open(i.type,i.url,i.async,i.username,i.password),i.xhrFields)for(n in i.xhrFields)r[n]=i.xhrFields[n];for(n in i.mimeType&&r.overrideMimeType&&r.overrideMimeType(i.mimeType),i.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest"),e)r.setRequestHeader(n,e[n]);o=function(e){return function(){o&&(o=a=r.onload=r.onerror=r.onabort=r.ontimeout=r.onreadystatechange=null,"abort"===e?r.abort():"error"===e?"number"!=typeof r.status?t(0,"error"):t(r.status,r.statusText):t(_t[r.status]||r.status,r.statusText,"text"!==(r.responseType||"text")||"string"!=typeof r.responseText?{binary:r.response}:{text:r.responseText},r.getAllResponseHeaders()))}},r.onload=o(),a=r.onerror=r.ontimeout=o("error"),void 0!==r.onabort?r.onabort=a:r.onreadystatechange=function(){4===r.readyState&&C.setTimeout(function(){o&&a()})},o=o("abort");try{r.send(i.hasContent&&i.data||null)}catch(e){if(o)throw e}},abort:function(){o&&o()}}}),S.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),S.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return S.globalEval(e),e}}}),S.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),S.ajaxTransport("script",function(n){var r,i;if(n.crossDomain||n.scriptAttrs)return{send:function(e,t){r=S("<script>").attr(n.scriptAttrs||{}).prop({charset:n.scriptCharset,src:n.url}).on("load error",i=function(e){r.remove(),i=null,e&&t("error"===e.type?404:200,e.type)}),E.head.appendChild(r[0])},abort:function(){i&&i()}}});var Ut,Xt=[],Vt=/(=)\?(?=&|$)|\?\?/;S.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Xt.pop()||S.expando+"_"+Ct.guid++;return this[e]=!0,e}}),S.ajaxPrefilter("json jsonp",function(e,t,n){var r,i,o,a=!1!==e.jsonp&&(Vt.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Vt.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return r=e.jsonpCallback=m(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Vt,"$1"+r):!1!==e.jsonp&&(e.url+=(Et.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return o||S.error(r+" was not called"),o[0]},e.dataTypes[0]="json",i=C[r],C[r]=function(){o=arguments},n.always(function(){void 0===i?S(C).removeProp(r):C[r]=i,e[r]&&(e.jsonpCallback=t.jsonpCallback,Xt.push(r)),o&&m(i)&&i(o[0]),o=i=void 0}),"script"}),y.createHTMLDocument=((Ut=E.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Ut.childNodes.length),S.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(y.createHTMLDocument?((r=(t=E.implementation.createHTMLDocument("")).createElement("base")).href=E.location.href,t.head.appendChild(r)):t=E),o=!n&&[],(i=N.exec(e))?[t.createElement(i[1])]:(i=xe([e],t,o),o&&o.length&&S(o).remove(),S.merge([],i.childNodes)));var r,i,o},S.fn.load=function(e,t,n){var r,i,o,a=this,s=e.indexOf(" ");return-1<s&&(r=vt(e.slice(s)),e=e.slice(0,s)),m(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),0<a.length&&S.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){o=arguments,a.html(r?S("<div>").append(S.parseHTML(e)).find(r):e)}).always(n&&function(e,t){a.each(function(){n.apply(this,o||[e.responseText,t,e])})}),this},S.expr.pseudos.animated=function(t){return S.grep(S.timers,function(e){return t===e.elem}).length},S.offset={setOffset:function(e,t,n){var r,i,o,a,s,u,l=S.css(e,"position"),c=S(e),f={};"static"===l&&(e.style.position="relative"),s=c.offset(),o=S.css(e,"top"),u=S.css(e,"left"),("absolute"===l||"fixed"===l)&&-1<(o+u).indexOf("auto")?(a=(r=c.position()).top,i=r.left):(a=parseFloat(o)||0,i=parseFloat(u)||0),m(t)&&(t=t.call(e,n,S.extend({},s))),null!=t.top&&(f.top=t.top-s.top+a),null!=t.left&&(f.left=t.left-s.left+i),"using"in t?t.using.call(e,f):("number"==typeof f.top&&(f.top+="px"),"number"==typeof f.left&&(f.left+="px"),c.css(f))}},S.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){S.offset.setOffset(this,t,e)});var e,n,r=this[0];return r?r.getClientRects().length?(e=r.getBoundingClientRect(),n=r.ownerDocument.defaultView,{top:e.top+n.pageYOffset,left:e.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,r=this[0],i={top:0,left:0};if("fixed"===S.css(r,"position"))t=r.getBoundingClientRect();else{t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;while(e&&(e===n.body||e===n.documentElement)&&"static"===S.css(e,"position"))e=e.parentNode;e&&e!==r&&1===e.nodeType&&((i=S(e).offset()).top+=S.css(e,"borderTopWidth",!0),i.left+=S.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-S.css(r,"marginTop",!0),left:t.left-i.left-S.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent;while(e&&"static"===S.css(e,"position"))e=e.offsetParent;return e||re})}}),S.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var o="pageYOffset"===i;S.fn[t]=function(e){return $(this,function(e,t,n){var r;if(x(e)?r=e:9===e.nodeType&&(r=e.defaultView),void 0===n)return r?r[i]:e[t];r?r.scrollTo(o?r.pageXOffset:n,o?n:r.pageYOffset):e[t]=n},t,e,arguments.length)}}),S.each(["top","left"],function(e,n){S.cssHooks[n]=$e(y.pixelPosition,function(e,t){if(t)return t=Be(e,n),Me.test(t)?S(e).position()[n]+"px":t})}),S.each({Height:"height",Width:"width"},function(a,s){S.each({padding:"inner"+a,content:s,"":"outer"+a},function(r,o){S.fn[o]=function(e,t){var n=arguments.length&&(r||"boolean"!=typeof e),i=r||(!0===e||!0===t?"margin":"border");return $(this,function(e,t,n){var r;return x(e)?0===o.indexOf("outer")?e["inner"+a]:e.document.documentElement["client"+a]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+a],r["scroll"+a],e.body["offset"+a],r["offset"+a],r["client"+a])):void 0===n?S.css(e,t,i):S.style(e,t,n,i)},s,n?e:void 0,n)}})}),S.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){S.fn[t]=function(e){return this.on(t,e)}}),S.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),S.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,n){S.fn[n]=function(e,t){return 0<arguments.length?this.on(n,null,e,t):this.trigger(n)}});var Gt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;S.proxy=function(e,t){var n,r,i;if("string"==typeof t&&(n=e[t],t=e,e=n),m(e))return r=s.call(arguments,2),(i=function(){return e.apply(t||this,r.concat(s.call(arguments)))}).guid=e.guid=e.guid||S.guid++,i},S.holdReady=function(e){e?S.readyWait++:S.ready(!0)},S.isArray=Array.isArray,S.parseJSON=JSON.parse,S.nodeName=A,S.isFunction=m,S.isWindow=x,S.camelCase=X,S.type=w,S.now=Date.now,S.isNumeric=function(e){var t=S.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},S.trim=function(e){return null==e?"":(e+"").replace(Gt,"")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return S});var Yt=C.jQuery,Qt=C.$;return S.noConflict=function(e){return C.$===S&&(C.$=Qt),e&&C.jQuery===S&&(C.jQuery=Yt),S},"undefined"==typeof e&&(C.jQuery=C.$=S),S});

!function(t){if("function"==typeof bootstrap)bootstrap("pf",t);else if("object"==typeof exports)module.exports=t();else if("function"==typeof define&&define.amd)define(t);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makePF=t}else"undefined"!=typeof window?window.PF=t():global.PF=t()}(function(){return function(t,e,n){function r(n,i){if(!e[n]){if(!t[n]){var s="function"==typeof require&&require;if(!i&&s)return s(n,!0);if(o)return o(n,!0);throw new Error("Cannot find module '"+n+"'")}var u=e[n]={exports:{}};t[n][0].call(u.exports,function(e){var o=t[n][1][e];return r(o||e)},u,u.exports)}return e[n].exports}for(var o="function"==typeof require&&require,i=0;i<n.length;i++)r(n[i]);return r}({1:[function(t,e,n){e.exports=t("./lib/heap")},{"./lib/heap":2}],2:[function(t,e,n){(function(){var t,n,r,o,i,s,u,p,h,a,f,l,c,d,y;r=Math.floor,a=Math.min,n=function(t,e){return t<e?-1:t>e?1:0},h=function(t,e,o,i,s){var u;if(null==o&&(o=0),null==s&&(s=n),o<0)throw new Error("lo must be non-negative");for(null==i&&(i=t.length);o<i;)s(e,t[u=r((o+i)/2)])<0?i=u:o=u+1;return[].splice.apply(t,[o,o-o].concat(e)),e},s=function(t,e,r){return null==r&&(r=n),t.push(e),d(t,0,t.length-1,r)},i=function(t,e){var r,o;return null==e&&(e=n),r=t.pop(),t.length?(o=t[0],t[0]=r,y(t,0,e)):o=r,o},p=function(t,e,r){var o;return null==r&&(r=n),o=t[0],t[0]=e,y(t,0,r),o},u=function(t,e,r){var o;return null==r&&(r=n),t.length&&r(t[0],e)<0&&(e=(o=[t[0],e])[0],t[0]=o[1],y(t,0,r)),e},o=function(t,e){var o,i,s,u,p,h;for(null==e&&(e=n),p=[],i=0,s=(u=function(){h=[];for(var e=0,n=r(t.length/2);0<=n?e<n:e>n;0<=n?e++:e--)h.push(e);return h}.apply(this).reverse()).length;i<s;i++)o=u[i],p.push(y(t,o,e));return p},c=function(t,e,r){var o;if(null==r&&(r=n),-1!==(o=t.indexOf(e)))return d(t,0,o,r),y(t,o,r)},f=function(t,e,r){var i,s,p,h,a;if(null==r&&(r=n),!(s=t.slice(0,e)).length)return s;for(o(s,r),p=0,h=(a=t.slice(e)).length;p<h;p++)i=a[p],u(s,i,r);return s.sort(r).reverse()},l=function(t,e,r){var s,u,p,f,l,c,d,y,g;if(null==r&&(r=n),10*e<=t.length){if(!(p=t.slice(0,e).sort(r)).length)return p;for(u=p[p.length-1],f=0,c=(d=t.slice(e)).length;f<c;f++)r(s=d[f],u)<0&&(h(p,s,0,null,r),p.pop(),u=p[p.length-1]);return p}for(o(t,r),g=[],l=0,y=a(e,t.length);0<=y?l<y:l>y;0<=y?++l:--l)g.push(i(t,r));return g},d=function(t,e,r,o){var i,s,u;for(null==o&&(o=n),i=t[r];r>e&&o(i,s=t[u=r-1>>1])<0;)t[r]=s,r=u;return t[r]=i},y=function(t,e,r){var o,i,s,u,p;for(null==r&&(r=n),i=t.length,p=e,s=t[e],o=2*e+1;o<i;)(u=o+1)<i&&!(r(t[o],t[u])<0)&&(o=u),t[e]=t[o],o=2*(e=o)+1;return t[e]=s,d(t,p,e,r)},t=function(){function t(t){this.cmp=null!=t?t:n,this.nodes=[]}return t.push=s,t.pop=i,t.replace=p,t.pushpop=u,t.heapify=o,t.nlargest=f,t.nsmallest=l,t.prototype.push=function(t){return s(this.nodes,t,this.cmp)},t.prototype.pop=function(){return i(this.nodes,this.cmp)},t.prototype.peek=function(){return this.nodes[0]},t.prototype.contains=function(t){return-1!==this.nodes.indexOf(t)},t.prototype.replace=function(t){return p(this.nodes,t,this.cmp)},t.prototype.pushpop=function(t){return u(this.nodes,t,this.cmp)},t.prototype.heapify=function(){return o(this.nodes,this.cmp)},t.prototype.updateItem=function(t){return c(this.nodes,t,this.cmp)},t.prototype.clear=function(){return this.nodes=[]},t.prototype.empty=function(){return 0===this.nodes.length},t.prototype.size=function(){return this.nodes.length},t.prototype.clone=function(){var e;return e=new t,e.nodes=this.nodes.slice(0),e},t.prototype.toArray=function(){return this.nodes.slice(0)},t.prototype.insert=t.prototype.push,t.prototype.remove=t.prototype.pop,t.prototype.top=t.prototype.peek,t.prototype.front=t.prototype.peek,t.prototype.has=t.prototype.contains,t.prototype.copy=t.prototype.clone,t}(),(void 0!==e&&null!==e?e.exports:void 0)?e.exports=t:window.Heap=t}).call(this)},{}],3:[function(t,e,n){e.exports={Heap:t("heap"),Node:t("./core/Node"),Grid:t("./core/Grid"),Util:t("./core/Util"),Heuristic:t("./core/Heuristic"),AStarFinder:t("./finders/AStarFinder")}},{"./core/Grid":4,"./core/Heuristic":5,"./core/Node":6,"./core/Util":7,"./finders/AStarFinder":8,"./finders/BestFirstFinder":9,"./finders/BiAStarFinder":10,"./finders/BiBestFirstFinder":11,"./finders/BiBreadthFirstFinder":12,"./finders/BiDijkstraFinder":13,"./finders/BiTraceFinder":14,"./finders/BreadthFirstFinder":15,"./finders/DijkstraFinder":16,"./finders/IDAStarFinder":17,"./finders/JumpPointFinder":18,"./finders/TraceFinder":19,heap:1}],4:[function(t,e,n){function r(t,e,n){this.width=t,this.height=e,this.nodes=this._buildNodes(t,e,n)}var o=t("./Node");r.prototype._buildNodes=function(t,e,n){var r,i,s=new Array(e);for(r=0;r<e;++r)for(s[r]=new Array(t),i=0;i<t;++i)s[r][i]=new o(i,r);if(void 0===n)return s;if(n.length!==e||n[0].length!==t)throw new Error("Matrix size does not fit");for(r=0;r<e;++r)for(i=0;i<t;++i)n[r][i]&&(s[r][i].walkable=!1);return s},r.prototype.getNodeAt=function(t,e){return this.nodes[e][t]},r.prototype.isWalkableAt=function(t,e){return this.isInside(t,e)&&this.nodes[e][t].walkable},r.prototype.isInside=function(t,e){return t>=0&&t<this.width&&e>=0&&e<this.height},r.prototype.setWalkableAt=function(t,e,n){this.nodes[e][t].walkable=n},r.prototype.getNeighbors=function(t,e,n){var r=t.x,o=t.y,i=[],s=!1,u=!1,p=!1,h=!1,a=!1,f=!1,l=!1,c=!1,d=this.nodes;return this.isWalkableAt(r,o-1)&&(i.push(d[o-1][r]),s=!0),this.isWalkableAt(r+1,o)&&(i.push(d[o][r+1]),p=!0),this.isWalkableAt(r,o+1)&&(i.push(d[o+1][r]),a=!0),this.isWalkableAt(r-1,o)&&(i.push(d[o][r-1]),l=!0),e?(n?(u=l&&s,h=s&&p,f=p&&a,c=a&&l):(u=l||s,h=s||p,f=p||a,c=a||l),u&&this.isWalkableAt(r-1,o-1)&&i.push(d[o-1][r-1]),h&&this.isWalkableAt(r+1,o-1)&&i.push(d[o-1][r+1]),f&&this.isWalkableAt(r+1,o+1)&&i.push(d[o+1][r+1]),c&&this.isWalkableAt(r-1,o+1)&&i.push(d[o+1][r-1]),i):i},r.prototype.clone=function(){var t,e,n=this.width,i=this.height,s=this.nodes,u=new r(n,i),p=new Array(i);for(t=0;t<i;++t)for(p[t]=new Array(n),e=0;e<n;++e)p[t][e]=new o(e,t,s[t][e].walkable);return u.nodes=p,u},e.exports=r},{"./Node":6}],5:[function(t,e,n){e.exports={manhattan:function(t,e){return t+e},euclidean:function(t,e){return Math.sqrt(t*t+e*e)},chebyshev:function(t,e){return Math.max(t,e)}}},{}],6:[function(t,e,n){e.exports=function(t,e,n){this.x=t,this.y=e,this.walkable=void 0===n||n}},{}],7:[function(t,e,n){function r(t){for(var e=[[t.x,t.y]];t.parent;)t=t.parent,e.push([t.x,t.y]);return e.reverse()}function o(t,e,n,r){var o,i,s,u,p,h,a=Math.abs,f=[];for(s=a(n-t),u=a(r-e),o=t<n?1:-1,i=e<r?1:-1,p=s-u;;){if(f.push([t,e]),t===n&&e===r)break;(h=2*p)>-u&&(p-=u,t+=o),h<s&&(p+=s,e+=i)}return f}n.backtrace=r,n.biBacktrace=function(t,e){var n=r(t),o=r(e);return n.concat(o.reverse())},n.pathLength=function(t){var e,n,r,o,i,s=0;for(e=1;e<t.length;++e)n=t[e-1],r=t[e],o=n[0]-r[0],i=n[1]-r[1],s+=Math.sqrt(o*o+i*i);return s},n.interpolate=o,n.expandPath=function(t){var e,n,r,i,s,u,p=[],h=t.length;if(h<2)return p;for(s=0;s<h-1;++s)for(e=t[s],n=t[s+1],i=(r=o(e[0],e[1],n[0],n[1])).length,u=0;u<i-1;++u)p.push(r[u]);return p.push(t[h-1]),p},n.smoothenPath=function(t,e){var n,r,i,s,u,p,h,a,f,l,c,d,y,g=e.length,v=e[0][0],b=e[0][1],w=e[g-1][0],k=e[g-1][1];for(n=v,r=b,u=e[1][0],p=e[1][1],h=[[n,r]],a=2;a<g;++a){for(c=o(n,r,i=(l=e[a])[0],s=l[1]),y=!1,f=1;f<c.length;++f)if(d=c[f],!t.isWalkableAt(d[0],d[1])){y=!0,h.push([u,p]),n=u,r=p;break}y||(u=i,p=s)}return h.push([w,k]),h}},{}],8:[function(t,e,n){function r(t){t=t||{},this.allowDiagonal=t.allowDiagonal,this.dontCrossCorners=t.dontCrossCorners,this.heuristic=t.heuristic||s.manhattan,this.weight=t.weight||1}var o=t("heap"),i=t("../core/Util"),s=t("../core/Heuristic");r.prototype.findPath=function(t,e,n,r,s){var u,p,h,a,f,l,c,d,y=new o(function(t,e){return t.f-e.f}),g=s.getNodeAt(t,e),v=s.getNodeAt(n,r),b=this.heuristic,w=this.allowDiagonal,k=this.dontCrossCorners,x=this.weight,m=Math.abs,A=Math.SQRT2;for(g.g=0,g.f=0,y.push(g),g.opened=!0;!y.empty();){if(u=y.pop(),u.closed=!0,u===v)return i.backtrace(v);for(a=0,f=(p=s.getNeighbors(u,w,k)).length;a<f;++a)(h=p[a]).closed||(l=h.x,c=h.y,d=u.g+(l-u.x==0||c-u.y==0?1:A),(!h.opened||d<h.g)&&(h.g=d,h.h=h.h||x*b(m(l-n),m(c-r)),h.f=h.g+h.h,h.parent=u,h.opened?y.updateItem(h):(y.push(h),h.opened=!0)))}return[]},e.exports=r},{"../core/Heuristic":5,"../core/Util":7,heap:1}]},{},[3])(3)});
// StyleFix v1.0.3 & PrefixFree v1.0.7 - @author Lea Verou - MIT license
(function(){function t(e,t){return[].slice.call((t||document).querySelectorAll(e))}if(!window.addEventListener)return;var e=window.StyleFix={link:function(t){try{if(t.rel!=="stylesheet"||t.hasAttribute("data-noprefix"))return}catch(n){return}var r=t.href||t.getAttribute("data-href"),i=r.replace(/[^\/]+$/,""),s=(/^[a-z]{3,10}:/.exec(i)||[""])[0],o=(/^[a-z]{3,10}:\/\/[^\/]+/.exec(i)||[""])[0],u=/^([^?]*)\??/.exec(r)[1],a=t.parentNode,f=new XMLHttpRequest,l;f.onreadystatechange=function(){f.readyState===4&&l()},l=function(){var n=f.responseText;if(n&&t.parentNode&&(!f.status||f.status<400||f.status>600)){n=e.fix(n,!0,t);if(i){n=n.replace(/url\(\s*?((?:"|')?)(.+?)\1\s*?\)/gi,function(e,t,n){return/^([a-z]{3,10}:|#)/i.test(n)?e:/^\/\//.test(n)?'url("'+s+n+'")':/^\//.test(n)?'url("'+o+n+'")':/^\?/.test(n)?'url("'+u+n+'")':'url("'+i+n+'")'});var r=i.replace(/([\\\^\$*+[\]?{}.=!:(|)])/g,"\\$1");n=n.replace(RegExp("\\b(behavior:\\s*?url\\('?\"?)"+r,"gi"),"$1")}var l=document.createElement("style");l.textContent=n,l.media=t.media,l.disabled=t.disabled,l.setAttribute("data-href",t.getAttribute("href")),a.insertBefore(l,t),a.removeChild(t),l.media=t.media}};try{f.open("GET",r),f.send(null)}catch(n){typeof XDomainRequest!="undefined"&&(f=new XDomainRequest,f.onerror=f.onprogress=function(){},f.onload=l,f.open("GET",r),f.send(null))}t.setAttribute("data-inprogress","")},styleElement:function(t){if(t.hasAttribute("data-noprefix"))return;var n=t.disabled;t.textContent=e.fix(t.textContent,!0,t),t.disabled=n},styleAttribute:function(t){var n=t.getAttribute("style");n=e.fix(n,!1,t),t.setAttribute("style",n)},process:function(){t('link[rel="stylesheet"]:not([data-inprogress])').forEach(StyleFix.link),t("style").forEach(StyleFix.styleElement),t("[style]").forEach(StyleFix.styleAttribute)},register:function(t,n){(e.fixers=e.fixers||[]).splice(n===undefined?e.fixers.length:n,0,t)},fix:function(t,n,r){for(var i=0;i<e.fixers.length;i++)t=e.fixers[i](t,n,r)||t;return t},camelCase:function(e){return e.replace(/-([a-z])/g,function(e,t){return t.toUpperCase()}).replace("-","")},deCamelCase:function(e){return e.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()})}};(function(){setTimeout(function(){t('link[rel="stylesheet"]').forEach(StyleFix.link)},10),document.addEventListener("DOMContentLoaded",StyleFix.process,!1)})()})(),function(e){function t(e,t,r,i,s){e=n[e];if(e.length){var o=RegExp(t+"("+e.join("|")+")"+r,"gi");s=s.replace(o,i)}return s}if(!window.StyleFix||!window.getComputedStyle)return;var n=window.PrefixFree={prefixCSS:function(e,r,i){var s=n.prefix;n.functions.indexOf("linear-gradient")>-1&&(e=e.replace(/(\s|:|,)(repeating-)?linear-gradient\(\s*(-?\d*\.?\d*)deg/ig,function(e,t,n,r){return t+(n||"")+"linear-gradient("+(90-r)+"deg"})),e=t("functions","(\\s|:|,)","\\s*\\(","$1"+s+"$2(",e),e=t("keywords","(\\s|:)","(\\s|;|\\}|$)","$1"+s+"$2$3",e),e=t("properties","(^|\\{|\\s|;)","\\s*:","$1"+s+"$2:",e);if(n.properties.length){var o=RegExp("\\b("+n.properties.join("|")+")(?!:)","gi");e=t("valueProperties","\\b",":(.+?);",function(e){return e.replace(o,s+"$1")},e)}return r&&(e=t("selectors","","\\b",n.prefixSelector,e),e=t("atrules","@","\\b","@"+s+"$1",e)),e=e.replace(RegExp("-"+s,"g"),"-"),e=e.replace(/-\*-(?=[a-z]+)/gi,n.prefix),e},property:function(e){return(n.properties.indexOf(e)?n.prefix:"")+e},value:function(e,r){return e=t("functions","(^|\\s|,)","\\s*\\(","$1"+n.prefix+"$2(",e),e=t("keywords","(^|\\s)","(\\s|$)","$1"+n.prefix+"$2$3",e),e},prefixSelector:function(e){return e.replace(/^:{1,2}/,function(e){return e+n.prefix})},prefixProperty:function(e,t){var r=n.prefix+e;return t?StyleFix.camelCase(r):r}};(function(){var e={},t=[],r={},i=getComputedStyle(document.documentElement,null),s=document.createElement("div").style,o=function(n){if(n.charAt(0)==="-"){t.push(n);var r=n.split("-"),i=r[1];e[i]=++e[i]||1;while(r.length>3){r.pop();var s=r.join("-");u(s)&&t.indexOf(s)===-1&&t.push(s)}}},u=function(e){return StyleFix.camelCase(e)in s};if(i.length>0)for(var a=0;a<i.length;a++)o(i[a]);else for(var f in i)o(StyleFix.deCamelCase(f));var l={uses:0};for(var c in e){var h=e[c];l.uses<h&&(l={prefix:c,uses:h})}n.prefix="-"+l.prefix+"-",n.Prefix=StyleFix.camelCase(n.prefix),n.properties=[];for(var a=0;a<t.length;a++){var f=t[a];if(f.indexOf(n.prefix)===0){var p=f.slice(n.prefix.length);u(p)||n.properties.push(p)}}n.Prefix=="Ms"&&!("transform"in s)&&!("MsTransform"in s)&&"msTransform"in s&&n.properties.push("transform","transform-origin"),n.properties.sort()})(),function(){function i(e,t){return r[t]="",r[t]=e,!!r[t]}var e={"linear-gradient":{property:"backgroundImage",params:"red, teal"},calc:{property:"width",params:"1px + 5%"},element:{property:"backgroundImage",params:"#foo"},"cross-fade":{property:"backgroundImage",params:"url(a.png), url(b.png), 50%"}};e["repeating-linear-gradient"]=e["repeating-radial-gradient"]=e["radial-gradient"]=e["linear-gradient"];var t={initial:"color","zoom-in":"cursor","zoom-out":"cursor",box:"display",flexbox:"display","inline-flexbox":"display",flex:"display","inline-flex":"display",grid:"display","inline-grid":"display","min-content":"width"};n.functions=[],n.keywords=[];var r=document.createElement("div").style;for(var s in e){var o=e[s],u=o.property,a=s+"("+o.params+")";!i(a,u)&&i(n.prefix+a,u)&&n.functions.push(s)}for(var f in t){var u=t[f];!i(f,u)&&i(n.prefix+f,u)&&n.keywords.push(f)}}(),function(){function s(e){return i.textContent=e+"{}",!!i.sheet.cssRules.length}var t={":read-only":null,":read-write":null,":any-link":null,"::selection":null},r={keyframes:"name",viewport:null,document:'regexp(".")'};n.selectors=[],n.atrules=[];var i=e.appendChild(document.createElement("style"));for(var o in t){var u=o+(t[o]?"("+t[o]+")":"");!s(u)&&s(n.prefixSelector(u))&&n.selectors.push(o)}for(var a in r){var u=a+" "+(r[a]||"");!s("@"+u)&&s("@"+n.prefix+u)&&n.atrules.push(a)}e.removeChild(i)}(),n.valueProperties=["transition","transition-property"],e.className+=" "+n.prefix,StyleFix.register(n.prefixCSS)}(document.documentElement);
// FODA grunt 2020-11-04 11:56:47 PM */

var game={staticHost:"http://rafaelcastrocouto.github.io/foda/client/",dynamicHost:"https://foda-app.herokuapp.com/",imageServer:"https://raw.githubusercontent.com/rafaelcastrocouto/dotacard/artwork/img",audioServer:"https://raw.githubusercontent.com/rafaelcastrocouto/dotacard/artwork/audio",container:$(".game-container"),loader:$("<span>").addClass("loader"),message:$("<span>").addClass("message"),triesCounter:$("<small>").addClass("triescounter"),dayLength:12,defaultSpeed:3,maxSkillCards:10,tries:0,timeToPick:40,timeToPlay:99,waitLimit:10,connectionLimit:30,deadLength:3,ultTurn:4,creepTurn:0,catapultTurn:6,treeRespawn:4,heroDeathDamage:4,fountainHeal:12,startMoney:400,heroBounty:150,unitBounty:60,jungleFarm:80,turnReward:40,libReward:800,maxMoney:99999,seed:0,id:null,size:"s5v5",timeoutArray:[],skills:{},data:{},mode:"",currentData:{},currentState:"noscript",heroesAI:{},build:function(){game.utils(),game.storageSupport=game.history.isSupported("localStorage"),game.storageSupport&&game.history.build(),game.events.build(),game.overlay.build(),game.hidden=$("<div>").addClass("hidden").appendTo(game.container),game.topbar=$("<div>").addClass("topbar"),game.topbar.append(game.loader,game.message,game.triesCounter)},start:function(){window.JSON&&window.btoa&&window.atob&&window.XMLHttpRequest?(game.debug||(game.debug=-1<document.cookie.indexOf("NODE_ENV=development")),game.debug&&(game.staticHost="",game.dynamicHost="",game.container.addClass("debug")),game.build(),game.screen.detectDark(),game.states.changeTo("loading")):game.states.changeTo("unsupported")},newId:function(){game.newSeed(),game.id=btoa(game.seed)+"|"+btoa((new Date).valueOf())},setId:function(e){game.id=e,game.setSeed(e)},newSeed:function(){game.seed=Math.floor(1e16*Math.random()),game.setData("seed",game.seed)},setSeed:function(e){!e||(e=e.split("|"))[0].length&&(game.seed=parseInt(atob(e[0]),10),game.setData("seed",game.seed))},setData:function(e,a){game.currentData[e]=a,game.storageSupport&&localStorage.setItem("FODA-data-"+e,JSON.stringify(a))},getData:function(e){var a;return game.currentData[e]||(game.storageSupport&&(a=localStorage.getItem("FODA-data-"+e)),void 0!==a&&(game.currentData[e]=JSON.parse(a))),game.currentData[e]},canPlay:function(){var e="player"==game.currentTurnSide;return"local"==game.mode&&(e=game.currentTurnSide),e},opponent:function(e){return"player"==e?"enemy":"player"},db:function(e,a,t){var s=game.dynamicHost+"db";"string"!=typeof e.data&&(e.data=JSON.stringify(e.data)),$.ajax({async:!0,type:"GET",url:s,data:e,complete:function(e){a&&e&&(t?a(e.responseText):e.responseText?a(JSON.parse(e.responseText)):a({}))}})},random:function(){return game.seed+=1,parseFloat("0."+Math.sin(game.seed).toString().substr(6))},validModes:["tutorial","online","library","single","local"],setMode:function(e,a){e&&game[e]&&game[e].build&&0<=game.validModes.indexOf(e)&&(game.mode=e,game.setData("mode",e),game.container.removeClass(game.validModes.join(" ")),game.container.addClass(e),game[e].build(a))},matchClear:function(){game.states.config.clearSize(),game.size="s5v5",game.recovering=!1,game.player.picks=!1,game.enemy.picks=!1,game.setData("challenger",!1),game.setData("challenged",!1),game.setData("challengerDeck",!1),game.setData("challengedDeck",!1),game.setData("matchData",!1),game.setData("seed",!1)},clear:function(){game.message.removeClass("alert").html(""),game.mode&&game[game.mode]&&game[game.mode].clear&&game[game.mode].clear(),game.states.choose.builded&&game.states.choose.clear(),game.states.vs.builded&&game.states.vs.clear(),game.states.table.builded&&game.states.table.clear(),game.states.result.builded&&game.states.result.clear(),game.container.removeClass(game.validModes.join(" ")),game.mode=!1,game.setData("mode",!1)},resolve:function(e,a){return e.split(".").reduce(function(e,a){return e?e[a]:null},a||game)},reset:function(e){game.overlay.confirm(e,function(e){e&&(game.clear(),game.setData("state","menu"),location.reload(!0))})}};game.states={el:$(".states").first(),valid:["loading","log","menu","campaign","choose","result","table","vs","config"],build:function(e){for(var a=["loading","log","menu"],t=0;t<a.length;t++)game.states.buildState(a[t]);e&&e()},buildState:function(e){var a=game.states[e];a&&!a.builded&&(a.builded=!0,a.el||("loading"!==e&&(a.el=$("<div>").addClass("state "+e).hide(),a.el.appendTo(game.states.el)),a.build&&a.build()))},validState:function(e){return e&&game.states[e]&&0<=game.states.valid.indexOf(e)&&e!==game.currentState},changeTo:function(e,a){game.states.validState(e)&&!game.states.changing&&(game.clearTimeouts(),game.states.changing=!0,game.timeout(200,function(e,a){$(game.states.valid).each(function(){game.container.removeClass(this+"-state")}),game.container.addClass(e+"-state");var t=game.states[game.currentState];t&&(t.end&&t.end(),t.el&&t.el.hide()),game.states.buildState(e);var s=game.currentState,t=game.states[e];t.el&&(game.setData("state",e),t.el.fadeIn()),game.currentState=e,"loading"!=s&&"noscript"!=s&&(game.setData("backstate",s),game.backState=s),t.start&&t.start(a),game.timeout(200,function(){game.states.changing=!1})}.bind(this,e,a)))},back:function(){game.backState||(game.backState=game.getData("backstate")),game.states.changeTo(game.backState)}};
// FODA grunt 2020-11-04 11:56:47 PM */

game.ai={timeToPlay:40,side:"enemy",start:function(){game.currentData||(game.currentData={}),game.ai.moves=[],"very-easy"==game.ai.mode&&(game.ai.level=5),"easy"==game.ai.mode&&(game.ai.level=6),"normal"==game.ai.mode&&(game.ai.level=7),"hard"==game.ai.mode&&(game.ai.level=8),"very-hard"==game.ai.mode&&(game.ai.level=9),game.debug&&(game.ai.level=9),game.ai.timeToPlay=5*game.ai.level},turnStart:function(){game.ai.currentmovesLoop=4*game.ai.level,$(".ai-max").removeClass("ai-max"),game.ai.resetData(),$("."+game.ai.side+"decks .sidehand .skills").each(function(a,e){e=$(e);game.ai.passives(e)}),game.ai.autoMove(game.ai.moveRandomCard)},moveRandomCard:function(){game.ai.resetData();var a,e,t=$(".map ."+game.ai.side+".card:not(.towers, .dead, .ai-max, .stunned, .disabled, .channeling, .ghost)").randomCard();t.length&&(e=t.data("ai count"),a=JSON.parse(t.data("ai")),(!e||e<game.ai.level/2)&&(t.data("ai count",t.data("ai count")+1||0),t.data("ai count")>=game.ai.level/2&&t.addClass("ai-max"),$(".map ."+game.opponent(game.ai.side)+".card:not(.towers, .dead, .stunned, .disabled, .channeling, .ghost)").each(function(a,e){var t,s=$(e);game.ai.buildData(s),s.hasClass("heroes")&&(t=s.data("hero"),game.heroesAI[t]&&game.heroesAI[t].defend&&(e=JSON.parse(s.data("ai")),game.heroesAI[t].defend(s,e)))}),$(".map ."+game.ai.side+".card:not(.towers, .dead, .ghost)").each(function(a,e){var t,s=$(e);game.ai.buildData(s),s.hasClass("heroes")&&(t=s.data("hero"),e=JSON.parse(s.data("ai")),game.heroesAI[t]&&e.strats[game.heroesAI[t].move.default]&&(e.strats[game.heroesAI[t].move.default]+=10,s.data("ai",JSON.stringify(e))),game.heroesAI[t]&&game.heroesAI[t].play&&game.heroesAI[t].play(s,e))}),game.debug&&$(".map .spot").each(function(a,e){e=$(e);e.data("ai")&&$(".debug",e).text(JSON.parse(e.data("ai")).priority)}),a=JSON.parse(t.data("ai")),t.data("ai done")||(e=game.ai.chooseStrat(t,a))&&game.ai.decideAction(e.strat,t,a))),game.ai.autoMove(game.ai.nextMove)},nextMove:function(){1<game.turn.counter?0<game.ai.currentmovesLoop?(--game.ai.currentmovesLoop,game.ai.moveRandomCard()):game.ai.lastMoves():game.ai.endTurn()},lastMoves:function(){$(".map .card:not(.towers, .dead, .stunned, .disabled, .channeling, .ghost)").each(function(a,e){e=$(e);e.side()!=game.ai.side||e.hasClass("channeling")||game.ai.checkAttack(e)}),$("."+game.ai.side+"decks .sidehand .units").each(function(a,e){e=$(e);20*Math.random()>game.ai.level&&game.ai.summon(e)}),$("."+game.ai.side+"decks .hand .skills").each(function(a,e){e=$(e);game.ai.skillsDiscard(e)}),game.ai.autoMove(game.ai.endTurn)},endTurn:function(){$(".enemyMoveHighlight").removeClass("enemyMoveHighlight"),$(".enemyMoveHighlightTarget").removeClass("enemyMoveHighlightTarget"),$(".card").data("ai count",0),$(".source").removeClass("source"),game.ai.end?game.ai.end():game.mode&&game[game.mode]&&game[game.mode]["end"+game.ai.side.capitalize()]&&game[game.mode]["end"+game.ai.side.capitalize()]()},autoMove:function(a){1<game.turn.counter?game.ai.moves.length?game.enemy.autoMove(game.ai.moves,a):a():game.ai.endTurn()},passives:function(a){var e,t;a.data("type")==game.data.ui.passive&&(e=a.data("label"),t=a.data("hero"),!(a=$(".map .card."+game.ai.side+".heroes."+t+":not(.dead, .ghost)")).length||(a=a.getPosition())&&e&&t&&game.ai.moves.push("P:"+game.map.mirrorPosition(a)+":"+t+":"+e))},resetData:function(){game.ai.moves=[],$(".map .card:not(.dead, .ghost)").each(function(a,e){e=$(e);e.data("ai",game.ai.newData(e)),e.data("ai done",!1)}),$(".map .spot").each(function(a,e){e=$(e);e.data("ai",game.ai.newSpotData(e))})},newData:function(a){var t={strat:"",strats:{},"can-move":!1,"can-attack":!1,"can-attack-tower":!1,"attack-can-kill":!1,"can-be-attacked":!1,"can-be-killed":!1,"at-tower-limit":!1,"in-tower-attack-range":!1,"can-advance":!1,"can-retreat":!1,"can-dodge":!1,"can-cast":!1,"cast-strats":[],"cast-targets":[],"can-make-action":!1,"attack-targets":[],move:[],advance:[],dodge:[],retreat:[]};return $(game.ai.strats).each(function(a,e){t.strats[e]=1}),JSON.stringify(t)},buildData:function(n){var i=n.side(),t=n.opponent(),o=JSON.parse(n.data("ai")),a=n.data("range");n.data("current hp")<n.data("hp")/3&&(o.strats.retreat+=20),n.canMove()&&(o["can-move"]=!0),n.around(a,function(a){i!=game.ai.side&&((e=JSON.parse(a.data("ai"))).priority-=n.data("current damage"),e["can-be-attacked"]=!0,a.data("ai",JSON.stringify(e)));var e=$(".card."+t+":not(.invisible, .dead, .ghost)",a);e.length&&(n.canAttack()&&(o["can-attack"]=!0,o.strats.attack+=10,o["attack-targets"].push({priority:50-2*e.data("current armor")-e.data("current hp")/2+(e.data("ai priority bonus")||0),target:e.attr("id")}),e.hasClass("towers")&&(o.strats.attack+=30,o["can-attack-tower"]=!0)),(a=JSON.parse(e.data("ai")))["can-be-attacked"]=!0,a.strats.retreat+=15,e.data("current hp")<=n.data("current damage")-e.data("current armor")&&(o["attack-can-kill"]=!0,o.strats.attack+=20,a["can-be-killed"]=!0,a.strats.retreat+=25),e.data("ai",JSON.stringify(a)))}),n.around(game.data.ui.melee,function(a){a.hasClass(t+"area")&&(o["at-tower-limit"]=!0,o.strats&&(o.strats.alert+=10))}),n.getSpot().hasClass(t+"area")&&(o["in-tower-attack-range"]=!0,3<game[game.opponent(game.ai.side)].tower.data("current hp")&&o.strats&&(o.strats.retreat+=10)),i==game.ai.side&&n.inMovementRange(n.data("current speed"),function(a){var e=n.getDirectionObj(a),t="retreat";"enemy"==game.ai.side&&(0===e.x&&1===e.y||-1===e.x&&0===e.y||-1===e.x&&1===e.y||1===e.x&&1===e.y)&&(t="advance"),"player"==game.ai.side&&(0===e.x&&-1===e.y||1===e.x&&0===e.y||-1===e.x&&-1===e.y||1===e.x&&-1===e.y)&&(t="advance");var s=!1;0!==e.x&&(s=!0),game.ai.spotData(a,n,o,i,t,s)}),n.data("ai",JSON.stringify(o))},newSpotData:function(a){var e=40,t=game.opponent(game.ai.side),s=a.getX(),n=a.getY();"enemy"==game.ai.side&&(e+=4*(game.width-s),e+=6*n),"player"==game.ai.side&&(e+=4*s,e+=6*(game.height-n)),a.hasClass("jungle")&&(e+=30),a.hasClass("fountain")&&(e+=10),a.hasClass(game.ai.side+"area")&&(e+=10),a.hasClass(t+"area")&&(8<(t=game[t].tower.data("current hp"))&&(e-=40),t<6&&(e+=30)),0!=s&&game.width!=s+1&&0!=n&&game.height!=n+1||(e-=40);e={blocked:!a.hasClass("free"),priority:e,"can-be-attacked":!1,"can-be-casted":!1};return JSON.stringify(e)},spotData:function(a,e,t,s,n,i){var o;a&&e&&t&&(o=JSON.parse(a.data("ai")).priority,a={target:a.attr("id"),priority:o},e.canMove()&&("advance"==n&&(t.strats.siege+=o/2),"retreat"==n&&(t.strats.alert+=o/2),i&&(t.strats.dodge+=o/2),t["can-"+n]=!0),t.move.push(a),t[n].push(a),i&&t.dodge.push(a),e.data("ai",JSON.stringify(t)))},chooseStrat:function(a,t){if(game[game.opponent(game.ai.side)].tower.data("current hp")<3)return{strat:"siege"};var s=[];return $(game.ai.strats).each(function(a,e){s.push({strat:e,priority:t.strats[e]})}),game.ai.choose(s)},decideCast:function(a,e){if(e["cast-strats"].length){e=game.ai.choose(e["cast-strats"]);if(e&&e.skill&&e.target&&e.card)return e}},strats:["siege","attack","cast","flank","dodge","alert","stand","retreat"],decideAction:function(a,e,t){var s,n,i;"siege"==a&&(t["can-attack-tower"]?(s="attack",n={target:$(".map .towers."+game.ai.side).attr("id"),priority:100}):t["can-advance"]&&(s="advance")),"attack"==a&&(t["can-attack"]?s="attack":t["can-advance"]&&(s="advance")),"flank"==a&&(t["can-attack"]?s="attack":t["can-advance"]&&!t["at-tower-limit"]?s="advance":t["can-be-attacked"]&&t["can-retreat"]&&(s="retreat")),"alert"==a&&(t["can-attack"]?s="attack":t["can-be-attacked"]&&t["can-retreat"]&&(s="retreat")),"dodge"==a&&t["can-dodge"]&&(s="dodge"),"retreat"==a&&t["can-retreat"]&&(s="retreat"),"cast"==a&&(s=t["can-cast"]?"cast":"stand"),"stand"==a&&(s=t["can-attack"]?"attack":"stand"),(s=s||(t["can-cast"]&&0<t["cast-strats"].length?"cast":t["can-attack"]&&0<t["attack-targets"].length?"attack":!!t["can-move"]&&"move"))&&("move"!=s&&"advance"!=s&&"retreat"!=s&&"dodge"!=s||(n=game.ai.chooseDestiny(e,t,s),s="move"),"attack"==s&&(n=n||game.ai.chooseTarget(t["attack-targets"])),"cast"==s&&(n=i=game.ai.decideCast(e,t)),s&&n&&n.target&&game.ai.parseMove(e,t,s,n.target,i),"cast"==s&&i&&game.ai.eraseSkill(t,i),e.data("ai",JSON.stringify(t)))},eraseSkill:function(a,e){for(var t=a["cast-strats"],s=0;s<t.length;s++){var n=t[s];n.skill==e.skill&&t.erase(n)}},chooseDestiny:function(a,e,t){if(a.canMove()&&(t&&e[t]&&(destinys=e[t]),destinys.length))return game.ai.choose(destinys)},chooseTarget:function(a){if(a.length){var t;if($(a).each(function(a,e){$("#"+e.target).hasClass("towers")&&(t=e)}),t)return t;a=game.ai.choose(a);return a&&a.target&&0<$("#"+a.target).data("current hp")?a:void 0}},choose:function(a,t){var e,s="priority";if(a.length&&(e=1==a.length?a[0]:(a.sort(function(a,e){return t?a[s]-e[s]:e[s]-a[s]}),a.smartRandom(game.ai.level*Math.PI))),0<e[s])return e},parseMove:function(a,e,t,s,n){var i=[],o=$(a).getPosition();"move"!=t&&"advance"!=t&&"retreat"!=t||(i[0]="M",i[1]=game.map.mirrorPosition(o),i[2]=game.map.mirrorPosition(s),a.data("ai done",!0),e["can-move"]=!1),"attack"==t&&(s=$("#"+s),i[0]="A",i[1]=game.map.mirrorPosition(o),i[2]=game.map.mirrorPosition(s),a.data("ai done",!0),e["can-attack"]=!1),"cast"==t&&(s=$("#"+s),$("#"+n.card).data("type")==game.data.ui.toggle?(i[0]="T",i[1]=game.map.mirrorPosition(o),i[2]=n.skill,i[3]=a.data("hero")):(i[0]="C",i[1]=game.map.mirrorPosition(o),i[2]=game.map.mirrorPosition(s),i[3]=a.data("hero"),i[4]=n.skill)),game.ai.moves.push(i.join(":")),a.data("ai",JSON.stringify(e))},checkAttack:function(a){game.ai.buildData(a);var e=JSON.parse(a.data("ai"));!e["can-attack"]||(e=game.ai.chooseTarget(e["attack-targets"]))&&e.target&&game.ai.moves.push("A:"+game.map.mirrorPosition(a.getPosition())+":"+game.map.mirrorPosition($("#"+e.target).getPosition()))},summon:function(a){var e=a.data("label"),t=$(".spot.free."+game.ai.side+"area"),s=[];t.each(function(){var a=$(this),e=JSON.parse(a.data("ai"));e.blocked||s.push({target:a,priority:e.priority,data:e})}),!s.length||(a=game.ai.choose(s))&&(t=a.target.attr("id"),game.ai.moves.push("S:"+game.map.mirrorPosition(t)+":"+e),a.data.blocked=!0,a.target.data("ai",JSON.stringify(a.data)))},skillsDiscard:function(a){var e,t,s=a.data("ai discard");void 0===s?s=5:0<s?--s:s<=0&&(e=a.data("label"),t=a.data("hero"),game.ai.moves.push("D:"+e+":"+t),s=void 0),a.data("ai discard",s)}},game.aia={addCardInRange:function(){targets++,p+=parseInt((cardInRange.data("hp")-cardInRange.data("current hp"))/4),cardInRange.hasClass("channeling towers")&&(p+=20),cardInRange.hasClass("units")&&(p-=5)},castSingle:function(a,t){var s=a.data("ai");s["can-cast"]=!0,a.opponentsInRange(t.data("cast range"),function(a){var e;a.hasClasses("invisible ghost dead towers")||(e=50,a.hasClass("channeling")&&(e+=30),a.hasClass("units")&&(e-=20),s["cast-strats"].push({priority:e-a.data("current hp")/4,skill:t.data("label"),card:t.attr("id"),target:a.attr("id")}))}),a.data("ai",JSON.stringify(s))},castArea:function(a,t){var s=a.data("ai");s["can-cast"]=!0,a.inRange(t.data("cast range"),function(a){var e=s["can-attack"]?20:0;a.inRange(t.data("aoe range"),function(a){a=$(".card."+game.opponent(game.ai.side)+":not(.invisible, .ghost, .dead)",a);a.length&&game.aia.addCardInRange(a,0,e)})}),a.data("ai",JSON.stringify(s))},castLine:function(s,n){var i=s.data("ai");i["can-cast"]=!0;var o=n.data("aoe range"),r=n.data("aoe width");s.around(1,function(a){var e=0,t=i["can-attack"]?20:0;s.opponentsInLine(a,o,r,function(a){a.hasClasses("invisible ghost dead")||(e++,t+=parseInt((a.data("hp")-a.data("current hp"))/4),a.hasClass("towers")&&(t+=20),a.hasClass("units")&&(t-=5))}),1<e&&i["cast-strats"].push({priority:t,skill:s.data("label"),card:n.attr("id"),target:a.attr("id")})}),s.data("ai",JSON.stringify(i))},selfCastUlt:function(a,e,t,s){game.aia.castUlt(a,a,e,t,s)},castUlt:function(a,e,t,s,n){t["can-cast"]=!0,t["cast-strats"].push({priority:n||60,skill:"ult",card:s.attr("id"),target:e.attr("id")}),a.data("ai",JSON.stringify(t))},lineDodge:function(t,a,s){var e=a["aoe range"],n=a["aoe width"];t.around(1,function(a){t.inLine(a,e,n,function(a){var e=JSON.parse(a.data("ai"));e.priority-=s,e["can-be-casted"]=!0,a.data("ai",JSON.stringify(e));e=$(".card."+t.opponent(),a);e.length&&!e.hasClasses("ghost dead towers")&&((a=JSON.parse(e.data("ai"))).strats.dodge+=2*s,e.data("ai",JSON.stringify(a)))})})},ultRange:function(a,e){game[a.side()].turn>=game.ultTurn&&a.inRange(e["cast range"],function(a){var e=JSON.parse(a.data("ai"));e.priority-=25,e["can-be-casted"]=!0,a.data("ai",JSON.stringify(e))})},retreat:function(a,e){var t=$(e),e=JSON.parse(t.data("ai"));e.strats.retreat+=a,t.data("ai",JSON.stringify(e))},defendUlt:function(a,e){a.inRange(e["cast range"],function(a){var e=JSON.parse(a.data("ai"));e.priority-=15,e["can-be-casted"]=!0,a.data("ai",JSON.stringify(e))})}},game.heroesAI.am={move:{default:"flank"},play:function(n,i){var e=$("."+game.ai.side+"decks .hand .skills.am-blink"),a=$("."+game.ai.side+"decks .hand .skills.am-mirror"),o=$("."+game.ai.side+"decks .hand .skills.am-ult");$(".map ."+game.ai.side+".am").length||e.each(function(a,e){var t=$(e),e=t.data("ai discard")+1;t.data("ai discard",e)}),n.canCast(e.first())&&(i["can-cast"]=!0,n.hasClass("can-move")&&i["can-attack"]&&25<n.data("current hp")&&n.around(e.first().data("cast range"),function(a){var t,s;a.hasClass("free")&&(t=0,s=a.data("priority"),a.around(n.data("range"),function(a){var e=$(".card."+game.opponent(game.ai.side)+":not(.invisible, .ghost, .dead)",a);e.length&&(t++,s+=parseInt((e.data("hp")-e.data("current hp"))/4),e.hasClass("towers")&&(s+=70),e.hasClass("units")&&(s+=10),a.hasClass(game.ai.side+"area")&&(s-=30))}),t&&i["cast-strats"].push({priority:s,skill:"blink",card:e.first().attr("id"),target:a.attr("id")}))}),a.length&&(i["can-be-attacked"]||n.parent().data("can-be-casted"))&&i["cast-strats"].push({priority:150-3*i["current hp"],skill:"mirror",card:a.first().attr("id"),target:n.attr("id")}),!(i["can-be-attacked"]&&n.data("current hp")<25)||n.hasClass("can-move")&&i["can-make-action"]||n.around(e.first().data("cast range"),function(a){a.hasClass("free")&&!a.hasClass(game.opponent(game.ai.side)+"area")&&i["cast-strats"].push({priority:50+a.data("priority"),skill:"blink",card:e.first().attr("id"),target:a.attr("id")})})),n.canCast(o)&&n.inRange(o.data("cast range"),function(a){var e,t=$(".card."+game.opponent(game.ai.side)+":not(.invisible, .ghost, .dead, .towers)",a),s=20;t.length&&(i["can-cast"]=!0,e=0,!t.hasClass("towers")&&t.data("mana")&&(t.hasClass("channeling")&&(s+=20),t.hasClass("units")&&(s-=5),t.around(n.data("range"),function(a){a=$(".card."+game.opponent(game.ai.side)+":not(.invisible, .ghost, .dead)",a);a.length&&(e++,a.hasClasses("channeling towers")&&(s+=20))}),a=3*(t.data("mana")||0),i["cast-strats"].push({priority:s+8*e+a,skill:"ult",card:o.attr("id"),target:t.attr("id")})))}),n.data("ai",JSON.stringify(i))},defend:function(e,a){var t=game.data.skills.am.blink,s=e.side(),n=!1;e.around(t["cast range"],function(a){a.hasClass("free")&&a.around(e.data("range"),function(a){$(".card."+s,a).hasClass("towers")&&(n=!0)})}),n&&(game[game.ai.side].tower.atRange(2,function(a){var e=a.data("ai");e.priority+=10,a.data("ai",e)}),game[game.ai.side].tower.atRange(4,function(a){var e=a.find(".card."+s);e.length&&((a=JSON.parse(e.data("ai"))).strats.retreat+=10,e.data("ai",JSON.stringify(a)))})),game[s].turn>=game.ultTurn&&(t=game.data.skills.am.ult,game.aia.defendUlt(e,t)),e.data("ai",JSON.stringify(a))}},game.heroesAI.cat={move:{default:"flank"},play:function(n,i){var e,t,s,a=$("."+game.ai.side+"decks .sidehand .skills.cat-star"),o=$("."+game.ai.side+"decks .hand .skills.cat-arrow"),r=$("."+game.ai.side+"decks .sidehand .skills.cat-leap"),d=$("."+game.ai.side+"decks .hand .skills.cat-ult");$(".map ."+game.ai.side+".cat").length||(a.data("ai discard",a.data("ai discard")+1),o.data("ai discard",o.data("ai discard")+1),r.data("ai discard",r.data("ai discard")+1)),n.canCast(a)&&(i["can-cast"]=!0,e=0,t=20,n.opponentsInRange(a.data("aoe range"),function(a){a.hasClasses("invisible ghost dead")||(e++,t+=parseInt((a.data("hp")-a.data("current hp"))/4),a.hasClass("towers")&&(t+=20))}),1<e&&i["cast-strats"].push({priority:t,skill:"star",card:a.attr("id"),target:n.attr("id")})),n.canCast(o)&&(i["can-cast"]=!0,s=o.data("aoe range"),n.around(1,function(a){var e,t=n.firstCardInLine(a,s);t&&t.side()==n.opponent()&&!t.hasClasses("invisible ghost dead")&&(e=25,t.hasClass("channeling")&&(e+=20),t.hasClass("units")&&(e-=15),i["cast-strats"].push({priority:e+parseInt((t.data("hp")-t.data("current hp"))/4),skill:"arrow",card:o.attr("id"),target:a.attr("id")}))})),n.canCast(r)&&(i["can-cast"]=!0,n.hasClass("can-move")&&i["can-attack"]&&25<n.data("current hp")&&n.atRange(r.data("cast range"),function(a){var t,s;a.hasClass("free")&&(t=0,s=a.data("priority"),a.around(n.data("range"),function(a){var e=$(".card."+game.opponent(game.ai.side)+":not(.invisible, .ghost, .dead, .towers)",a);e.length&&(t++,s+=parseInt((e.data("hp")-e.data("current hp"))/4),e.hasClass("towers")&&(s+=70),a.hasClass(game.ai.side+"area")&&(s-=30),e.hasClass("units")&&(s-=10))}),t&&i["cast-strats"].push({priority:s,skill:"leap",card:r.attr("id"),target:a.attr("id")}))}),!(i["can-be-attacked"]&&n.data("current hp")<25)||n.hasClass("can-move")&&i["can-make-action"]||n.atRange(r.data("cast range"),function(a){a.hasClass("free")&&!a.hasClass(game.opponent(game.ai.side)+"area")&&i["cast-strats"].push({priority:50+a.data("priority"),skill:"leap",card:r.attr("id"),target:a.attr("id")})})),n.canCast(d)&&(i.strats.siege+=15,game.aia.selfCastUlt(n,i,d)),n.data("ai",JSON.stringify(i))},defend:function(t,a){var e=game.data.skills.cat.star;t.inRange(e["aoe range"],function(a){var e=JSON.parse(a.data("ai"));e.priority-=5,e["can-be-casted"]=!0,a.data("ai",JSON.stringify(e))});e=game.data.skills.cat.arrow;game.aia.lineDodge(t,e,18);var e=game.data.skills.cat.leap,s=!1;t.atRange(e["cast range"],function(e){e.hasClass("free")&&e.around(t.data("range"),function(){var a=JSON.parse(e.data("ai"));--a.priority,e.data("ai",JSON.stringify(a)),t.hasClass("towers")&&(s=!0)})}),s&&(game[game.ai.side].tower.atRange(2,function(a){var e=JSON.parse(a.data("ai"));e.priority+=30,a.data("ai",JSON.stringify(e))}),game[game.ai.side].tower.atRange(4,function(a){var e=a.find(".card."+side);e.length&&((a=JSON.parse(e.data("ai"))).strats.retreat+=20,e.data("ai",JSON.stringify(a)))})),t.hasBuff("cat-ult")&&$(".map .card."+game.ai.side).each(function(a,e){game.aia.retreat(15,e)}),t.data("ai",JSON.stringify(a))}},game.heroesAI.cm={move:{default:"flank"},play:function(a,t){var e,s=$("."+game.ai.side+"decks .hand .skills.cm-slow"),n=$("."+game.ai.side+"decks .hand .skills.cm-freeze"),i=$("."+game.ai.side+"decks .hand .skills.cm-ult");$(".map ."+game.ai.side+".cm").length||(s.data("ai discard",s.data("ai discard")+1),n.data("ai discard",n.data("ai discard")+1)),a.canCast(s)&&game.aia.castArea(a,s),a.canCast(n)&&a.inRange(n.data("cast range"),function(a){var e=0,a=$(".card."+game.opponent(game.ai.side)+":not(.invisible, .ghost, .dead, .towers)",a);a.length&&(t["can-cast"]=!0,e=10+parseInt((a.data("hp")-a.data("current hp"))/4),a.hasClass("channeling")&&(e+=20),a.hasClass("units")&&(e-=15),t["cast-strats"].push({priority:e,skill:"freeze",card:n.attr("id"),target:a.attr("id")}))}),a.canCast(i)&&(t["can-cast"]=!0,e=t["can-attack"]?-20:40,a.opponentsInRange(i.data("aoe range"),function(a){a.hasClasses("invisible ghost dead towers")||game.aia.addCardInRange(a,0,e)})),a.data("ai",JSON.stringify(t))},defend:function(a,e){var t=game.data.skills.cm.slow,s=[];a.inRange(t["cast range"],function(a){a.inRange(t["aoe range"],function(a){s.indexOf(a)<0&&s.push(a)})}),$.each(s,function(a,e){var t=JSON.parse(e.data("ai"));t.priority-=10,t["can-be-casted"]=!0,e.data("ai",JSON.stringify(t))});var n=game.data.skills.cm.freeze;a.inRange(n["cast range"],function(a){var e=JSON.parse(a.data("ai"));e.priority-=15,e["can-be-casted"]=!0,a.data("ai",JSON.stringify(e))});n=game.data.skills.cm.ult;game[a.side()].turn>=game.ultTurn&&a.inRange(n["aoe range"],function(a){var e=JSON.parse(a.data("ai"));e.priority-=20,e["can-be-casted"]=!0,a.data("ai",JSON.stringify(e))}),a.data("ai",JSON.stringify(e))}},game.heroesAI.com={move:{default:"attack"},play:function(t,s){var a=$("."+game.ai.side+"decks .hand .skills.com-aoe"),e=$("."+game.ai.side+"decks .hand .skills.com-heal"),n=$("."+game.ai.side+"decks .hand .skills.com-ult");$(".map ."+game.ai.side+".com").length||a.data("ai discard",a.data("ai discard")+1),t.canCast(a)&&game.aia.castArea(t,a),t.canCast(e)&&t.inRange(e.data("cast range"),function(a){a=$(".card."+game.ai.side+":not(.ghost, .dead, .towers, .units)",a);a.length&&(s["can-cast"]=!0,s["cast-strats"].push({priority:10+parseInt((a.data("hp")-a.data("current hp"))/4),skill:"heal",card:e.attr("id"),target:a.attr("id")}))}),t.canCast(n)&&t.inRange(n.data("cast range"),function(a){var e=$(".card."+game.opponent(game.ai.side)+":not(.invisible, .ghost, .dead, .towers, .units)",a);e.length&&(a=parseInt((e.data("hp")-e.data("current hp"))/4),game.aia.castUlt(t,e,s,n,a))}),t.data("ai",JSON.stringify(s))},defend:function(a,e){var t,s=game.data.skills.com.aoe,n=[];a.inRange(s["cast range"],function(a){a.inRange(s["aoe range"],function(a){n.indexOf(a)<0&&n.push(a)})}),$.each(n,function(a,e){var t=JSON.parse(e.data("ai"));t.priority-=5,t["can-be-casted"]=!0,e.data("ai",JSON.stringify(t))}),game[a.side()].turn>=game.ultTurn&&(t=game.data.skills.com.ult,game.aia.defendUlt(a,t)),a.data("ai",JSON.stringify(e))}},game.heroesAI.en={move:{default:"flank"},play:function(t,s){var e,n,i=$("."+game.ai.side+"decks .hand .skills.en-curse"),a=$("."+game.ai.side+"decks .hand .skills.en-heal"),o=$("."+game.ai.side+"decks .hand .skills.en-ult");$(".map ."+game.ai.side+".en").length||(i.data("ai discard",i.data("ai discard")+1),a.data("ai discard",a.data("ai discard")+1)),t.canCast(i)&&t.inRange(i.data("cast range"),function(a){a.hasAllClasses("spot jungle free")&&(s["can-cast"]=!0,s["cast-strats"].push({priority:40,skill:"curse",card:i.attr("id"),target:a.attr("id")}));a=$(".card."+game.opponent(game.ai.side)+":not(.invisible, .ghost, .dead, .towers)",a);a.length&&(s["can-cast"]=!0,a.hasClasses("heroes ld-bear")?s["cast-strats"].push({priority:12,skill:"curse",card:i.attr("id"),target:a.attr("id")}):a.hasClass("units")&&s["cast-strats"].push({priority:40,skill:"curse",card:i.attr("id"),target:a.attr("id")}))}),t.canCast(a)&&(s["can-cast"]=!0,n=e=0,t.alliesInRange(a.data("cast range"),function(a){!a.hasClasses("ghost dead towers")&&a.data("current hp")<a.data("hp")&&(e+=a.data("current hp")/4,a.hasClass("units")&&(e-=10),n++)}),s["cast-strats"].push({priority:100*n/e,skill:"heal",card:a.attr("id"),target:t.attr("id")})),t.canCast(o)&&t.opponentsInRange(o.data("cast range"),function(a){var e;a.hasClasses("invisible ghost dead")||(e=40,a.hasClass("towers")&&(e+=20),a.hasClass("units")&&(e-=15),game.aia.castUlt(t,a,s,o,e))}),t.data("ai",JSON.stringify(s))},defend:function(a,e){var t=game.data.skills.en.curse;a.inRange(t["cast range"],function(a){var e=JSON.parse(a.data("ai"));e.priority-=35,e["can-be-casted"]=!0,a.data("ai",JSON.stringify(e))}),a.hasBuff("en-passive")&&a.data("ai priority bonus",-10),game[a.side()].turn>=game.ultTurn&&(t=game.data.skills.en.ult,a.inRange(t["cast range"],function(a){var e=JSON.parse(a.data("ai"));e.priority-=5,e["can-be-casted"]=!0,a.data("ai",JSON.stringify(e))})),a.data("ai",JSON.stringify(e))}},game.heroesAI.kotl={move:{default:"alert"},play:function(a,s){var e=$("."+game.ai.side+"decks .hand .skills.kotl-illuminate"),t=$("."+game.ai.side+"decks .hand .skills.kotl-mana"),n=$("."+game.ai.side+"decks .hand .skills.kotl-blind"),i=$("."+game.ai.side+"decks .hand .skills.kotl-ult");$(".map ."+game.ai.side+".kotl").length||(e.data("ai discard",e.data("ai discard")+1),n.data("ai discard",n.data("ai discard")+1)),a.canCast(e)&&game.aia.castLine(a,s,e),a.canCast(n)&&game.aia.castArea(a,n),a.canCast(t)&&(s["can-cast"]=!0,game[a.side()].skills.hand.children().length<8&&s["cast-strats"].push({priority:50,skill:"mana",card:t.attr("id"),target:a.attr("id")})),a.canCast(i)&&(s["can-cast"]=!0,a.around(i.data("cast range"),function(a){var e=0,t=0;a.around(i.data("aoe range"),function(a){a=$(".card."+game.opponent(game.ai.side)+":not(.invisible, .ghost, .dead)",a);a.length&&(e++,t+=parseInt((a.data("hp")-a.data("current hp"))/4),a.hasClass("channeling towers")&&(t+=20),a.hasClass("units")&&(t-=5))}),1<e&&s["cast-strats"].push({priority:t,skill:"ult",card:i.attr("id"),target:a.attr("id")})})),a.data("ai",JSON.stringify(s))},defend:function(t,a){var e=game.data.skills.kotl.illuminate,s=e["aoe range"],n=e["aoe width"],i=t.hasClass("channeling");t.around(1,function(a){t.inLine(a,s,n,function(a){var e=JSON.parse(a.data("ai"));e.priority-=5,i&&(e.priority-=25),e["can-be-casted"]=!0,a.data("ai",JSON.stringify(e));e=$(".card."+t.opponent(),a);e.length&&!e.hasClasses("ghost dead towers")&&((a=JSON.parse(e.data("ai"))).strats.dodge+=10,i&&(a.strats.dodge+=15),e.data("ai",JSON.stringify(a)))})}),$(".map .card."+t.opponent()).each(function(a,e){var t=$(e),e=JSON.parse(t.data("ai"));t.hasBuff("kotl-blind")&&(e.strats.siege+=30),t.data("ai",JSON.stringify(e))}),t.data("ai",JSON.stringify(a))}},game.heroesAI.ld={move:{default:"attack"},play:function(a,e){var t,s,n=$("."+game.ai.side+"decks .sidehand .skills.ld-bear"),i=$("."+game.ai.side+"decks .hand .skills.ld-link"),o=$("."+game.ai.side+"decks .hand .skills.ld-roar"),r=$("."+game.ai.side+"decks .sidehand .skills.ld-ult"),d=$("."+game.ai.side+"decks .hand .skills.ld-cry");$(".map ."+game.ai.side+".ld").length||(rabid.data("ai discard",rabid.data("ai discard")+1),o.data("ai discard",o.data("ai discard")+1)),a.canCast(n)&&a.around(n.data("cast range"),function(a){a.hasClass("free")&&(e["can-cast"]=!0,e["cast-strats"].push({priority:10+4*a.data("priority")+2*game[game.ai.side].turn,skill:"bear",card:n.attr("id"),target:a.attr("id")}))}),a.canCast(i)&&(e["can-cast"]=!0,t=10,e["can-attack"]&&(t+=40),e["cast-strats"].push({priority:t,skill:"link",card:i.first().attr("id"),target:a.attr("id")})),a.canCast(o)&&(e["can-cast"]=!0,t=0,a.opponentsInRange(o.data("aoe range"),function(a){a.hasClasses("invisible ghost dead")||(t+=10,a.hasClasses("channeling towers")&&(t+=20),a.hasClass("units")&&(t-=5))}),t&&e["cast-strats"].push({priority:t,skill:"roar",card:o.attr("id"),target:a.attr("id")})),a.canCast(r)&&(e["can-cast"]=!0,s=0,a.opponentsInRange(2,function(a){a.hasClasses("invisible ghost dead")||s++}),r.hasClass("on")?a.hasBuff("ld-cry")||d.length?e["can-attack"]:e["cast-strats"].push({priority:5,skill:"ult",card:r.attr("id"),target:a.attr("id")}):a.hasBuff("ld-cry")&&!s||e["cast-strats"].push({priority:10+10*s,skill:"ult",card:r.attr("id"),target:a.attr("id")})),a.canCast(d)&&(e["can-cast"]=!0,e["cast-strats"].push({priority:50,skill:"cry",card:d.attr("id"),target:a.attr("id")})),a.data("ai",JSON.stringify(e))},defend:function(a,e){a.data("bear")&&a.data("ai priority bonus",-20);var t=game.data.skills.ld.roar;a.inRange(t["aoe range"],function(a){var e=JSON.parse(a.data("ai"));e.priority-=25,e["can-be-casted"]=!0,a.data("ai",JSON.stringify(e))}),a.hasBuff("ld-ult")&&a.data("ai priority bonus",-10)}},game.heroesAI.lina={move:{default:"flank"},play:function(t,s){var a=$("."+game.ai.side+"decks .hand .skills.lina-fire"),e=$("."+game.ai.side+"decks .hand .skills.lina-stun"),n=$("."+game.ai.side+"decks .hand .skills.lina-ult");$(".map "+game.ai.side+".lina").length||(a.data("ai discard",a.data("ai discard")+1),e.data("ai discard",e.data("ai discard")+1)),t.canCast(a)&&game.aia.castLine(t,s,a),t.canCast(e)&&game.aia.castArea(t,e),t.canCast(n)&&t.opponentsInRange(n.data("cast range"),function(a){var e=s["can-attack"]?40:0;a.hasClasses("invisible ghost dead towers")||(e+=(50-a.data("current hp"))/4,a.hasClass("units")&&(e-=30),game.aia.castUlt(t,a,s,n,e))}),t.data("ai",JSON.stringify(s))},defend:function(a,e){var t=game.data.skills.lina.fire;game.aia.lineDodge(a,t,15);var s=game.data.skills.lina.stun,n=[];a.inRange(s["cast range"],function(a){a.inRange(s["aoe range"],function(a){n.indexOf(a)<0&&n.push(a)})}),$.each(n,function(a,e){var t=JSON.parse(e.data("ai"));t.priority-=10,t["can-be-casted"]=!0,e.data("ai",JSON.stringify(t))});t=game.data.skills.lina.ult;game.aia.ultRange(a,t),a.data("ai",JSON.stringify(e))}},game.heroesAI.nyx={move:{default:"attack"},play:function(a,e){var t=$("."+game.ai.side+"decks .hand .skills.nyx-spike"),s=$("."+game.ai.side+"decks .hand .skills.nyx-stun"),n=$("."+game.ai.side+"decks .hand .skills.nyx-burn"),i=$("."+game.ai.side+"decks .hand .skills.nyx-ult");$(".map ."+game.ai.side+".nyx").length||(n.data("ai discard",n.data("ai discard")+1),s.data("ai discard",s.data("ai discard")+1),t.data("ai discard",t.data("ai discard")+1)),a.canCast(t)&&(e.strats.siege+=15,e["can-cast"]=!0,e["cast-strats"].push({priority:20,skill:"spike",card:t.attr("id"),target:a.attr("id")})),a.canCast(s)&&game.aia.castLine(a,e,s),a.canCast(n)&&a.opponentsInRange(n.data("cast range"),function(a){a.hasClasses("invisible ghost dead towers units")||(e["can-cast"]=!0,e["cast-strats"].push({priority:a.data("mana"),skill:"burn",card:n.attr("id"),target:a.attr("id")}))}),a.canCast(i)&&(e.strats.attack+=30,game.aia.selfCastUlt(a,e,i)),a.data("ai",JSON.stringify(e))},defend:function(a,e){var t=game.data.skills.nyx.stun;game.aia.lineDodge(a,t,20);t=game.data.skills.nyx.burn;a.inRange(t["cast range"],function(a){var e=JSON.parse(a.data("ai"));e.priority-=5,e["can-be-casted"]=!0,a.data("ai",JSON.stringify(e))}),a.hasBuff("nyx-spike")&&a.data("ai priority bonus",-80),a.hasBuff("nyx-ult")&&$(".map .card."+game.ai.side).each(function(a,e){game.aia.retreat(20,e)}),a.data("ai",JSON.stringify(e))}},game.heroesAI.pud={move:{default:"alert"},play:function(s,n){var i,e,t,o=$("."+game.ai.side+"decks .hand .skills.pud-hook"),a=$("."+game.ai.side+"decks .sidehand .skills.pud-rot"),r=$("."+game.ai.side+"decks .hand .skills.pud-ult");$(".map ."+game.ai.side+".pud").length||o.data("ai discard",o.data("ai discard")+1),s.canCast(o)&&(n["can-cast"]=!0,i=o.data("aoe range"),s.around(1,function(a){var e,t=s.firstCardInLine(a,i);t&&t.side()==s.opponent()&&!t.hasClasses("invisible ghost dead towers")&&(e=n["can-attack"]?-20:20,t.hasClass("channeling")&&(e+=20),t.hasClass("units")&&(e-=15),n["cast-strats"].push({priority:e+parseInt((t.data("hp")-t.data("current hp"))/4),skill:"hook",card:o.attr("id"),target:a.attr("id")}))})),s.canCast(a)&&(n["can-cast"]=!0,t=e=0,s.opponentsInRange(a.data("aoe range"),function(a){a.hasClasses("invisible ghost dead")||(e++,t+=parseInt((a.data("hp")-a.data("current hp"))/4),a.hasClass("towers")&&(t+=20),a.hasClass("units")&&(t-=5))}),a.hasClass("on")?e<=1&&n["cast-strats"].push({priority:50-t/2,skill:"rot",card:a.attr("id"),target:s.attr("id")}):1<e?n["cast-strats"].push({priority:t+10,skill:"rot",card:a.attr("id"),target:s.attr("id")}):s.data("current hp")<5&&n["cast-strats"].push({priority:30,skill:"rot",card:a.attr("id"),target:s.attr("id")})),s.canCast(r)&&(t=n["can-attack"]?-20:40,s.opponentsInRange(a.data("aoe range"),function(a){a.hasClasses("invisible ghost dead towers")||(a.hasClass("units")&&(t-=25),t+=parseInt((a.data("hp")-a.data("current hp"))/4),game.aia.castUlt(s,a,n,r,t))})),s.data("ai",JSON.stringify(n))},defend:function(a,e){var t=game.data.skills.pud.hook;game.aia.lineDodge(a,t,25);t=game.data.skills.pud.rot;a.inRange(t["aoe range"],function(a){var e=JSON.parse(a.data("ai"));e.priority-=5,a.data("ai",JSON.stringify(e))});t=game.data.skills.pud.ult;game[a.side()].turn>=game.ultTurn&&a.inRange(t["cast range"],function(a){var e=JSON.parse(a.data("ai"));e.priority-=5,e["can-be-casted"]=!0,a.data("ai",JSON.stringify(e))}),a.data("ai",JSON.stringify(e))}},game.heroesAI.venge={move:{default:"attack"},play:function(n,i){var s,o,a=$("."+game.ai.side+"decks .hand .skills.venge-stun"),r=$("."+game.ai.side+"decks .hand .skills.venge-corruption"),d=$("."+game.ai.side+"decks .hand .skills.venge-ult");$(".map ."+game.ai.side+".venge").length||(a.data("ai discard",a.data("ai discard")+1),r.data("ai discard",r.data("ai discard")+1)),n.canCast(a)&&game.aia.castSingle(n,a),n.canCast(r)&&(i["can-cast"]=!0,s=r.data("aoe range"),o=r.data("aoe width"),n.around(1,function(a){var e=0,t=0;n.opponentsInLine(a,s,o,function(a){a.hasClasses("invisible ghost dead towers")||(e++,a.hasClass("towers")&&(t+=20),a.hasClass("units")&&(t-=5))}),1<e&&i["cast-strats"].push({priority:t+10*e,skill:"corruption",card:r.attr("id"),target:a.attr("id")})})),n.canCast(d)&&(i["can-cast"]=!0,n.hasClass("can-move")&&i["can-attack"]&&25<n.data("current hp")&&n.around(d.data("cast range"),function(a){var t,s,e=$(".card:not(.invisible, .ghost, .dead, .towers)",a);e&&(s=t=0,e.around(n.data("range"),function(a){var e=$(".card."+game.opponent(game.ai.side)+":not(.invisible, .ghost, .dead, .towers)",a);e.length&&(t++,s+=parseInt((e.data("hp")-e.data("current hp"))/4),e.hasClass("towers")&&(s+=70),e.hasClass("units")&&(s-=5),a.hasClass(game.ai.side+"area")&&(s-=30))}),t&&i["cast-strats"].push({priority:s,skill:"ult",card:d.attr("id"),target:a.attr("id")}))}),!(i["can-be-attacked"]&&n.data("current hp")<25)||n.hasClass("can-move")&&i["can-make-action"]||n.alliesInRange(d.data("cast range"),function(a){a.hasClass("units")&&(p+=30),i["cast-strats"].push({priority:100-a.data("current hp"),skill:"ult",card:d.attr("id"),target:a.attr("id")})})),n.data("ai",JSON.stringify(i))},defend:function(e,a){var t=game.data.skills.venge.stun;e.inRange(t["cast range"],function(a){var e=JSON.parse(a.data("ai"));e.priority-=5,e["can-be-casted"]=!0,a.data("ai",JSON.stringify(e))});t=game.data.skills.venge.corruption;game.aia.lineDodge(e,t,10);var t=game.data.skills.venge.ult,s=e.side(),n=!1;game[s].turn>=game.ultTurn&&(e.around(t["cast range"],function(a){a.hasClass("free")&&a.around(e.data("range"),function(a){$(".card."+s,a).hasClass("towers")&&(n=!0)})}),n&&(game[game.ai.side].tower.atRange(2,function(a){var e=JSON.parse(a.data("ai"));e.priority-=30,a.data("ai",JSON.stringify(e))}),game[game.ai.side].tower.atRange(4,function(a){var e=a.find(".card."+s);e.length&&((a=JSON.parse(e.data("ai"))).strats.siege+=20,e.data("ai",JSON.stringify(a)))}))),e.data("ai",JSON.stringify(a))}},game.heroesAI.wind={move:{default:"flank"},play:function(s,n){var a=$("."+game.ai.side+"decks .hand .skills.wind-arrow"),i=$("."+game.ai.side+"decks .hand .skills.wind-stun"),e=$("."+game.ai.side+"decks .hand .skills.wind-run"),t=$("."+game.ai.side+"decks .hand .skills.wind-ult");$(".map ."+game.ai.side+".wind").length||(a.data("ai discard",a.data("ai discard")+1),i.data("ai discard",i.data("ai discard")+1),e.data("ai discard",e.data("ai discard")+1)),s.canCast(a)&&game.aia.castLine(s,n,a),s.canCast(i)&&s.opponentsInRange(i.data("cast range"),function(a){var e,t;a.hasClasses("invisible ghost dead towers")||(n["can-cast"]=!0,e=20,t=s.behindTarget(a),a.hasClass("units")&&(e-=10),t&&!t.hasClasses("invisible ghost dead towers")&&(e+=30,t.hasClass("units")&&(e-=5)),n["cast-strats"].push({priority:e-a.data("current hp")/4,skill:"stun",card:i.attr("id"),target:a.attr("id")}))}),s.canCast(e)&&(n["can-cast"]=!0,a=10,n["can-be-attacked"]&&(a=40),n["cast-strats"].push({priority:a,skill:"run",card:e.attr("id"),target:s.attr("id")})),s.canCast(t)&&s.opponentsInRange(t.data("cast range"),function(a){var e;a.hasClasses("invisible ghost dead")||(e=40,a.hasClass("towers")&&(e+=40),a.hasClass("units")&&(e-=30),game.aia.castUlt(s,a,n,t,e))}),s.data("ai",JSON.stringify(n))},defend:function(a,e){var t=game.data.skills.wind.arrow;game.aia.lineDodge(a,t,20);t=game.data.skills.wind.stun;a.inRange(t["cast range"],function(a){var e=JSON.parse(a.data("ai"));e.priority-=5,e["can-be-casted"]=!0,a.data("ai",JSON.stringify(e))}),a.hasBuff("wind-run")&&a.data("ai priority bonus",-80);t=game.data.skills.wind.ult;game.aia.ultRange(a,t),a.data("ai",JSON.stringify(e))}},game.heroesAI.wk={move:{default:"attack"},play:function(a,e){var t=$("."+game.ai.side+"decks .hand .skills.wk-stun");a.canCast(t)&&game.aia.castSingle(a,t),a.hasBuff("wk-ult")&&(e.strats.siege+=25),a.data("ai",JSON.stringify(e))},defend:function(a,e){var t=game.data.skills.wk.stun;a.inRange(t["cast range"],function(a){var e=JSON.parse(a.data("ai"));e.priority-=20,e["can-be-casted"]=!0,a.data("ai",JSON.stringify(e))}),a.hasBuff("wk-ult")&&a.data("ai priority bonus",-40),a.data("ai",JSON.stringify(e))}},game.card={extendjQuery:function(){$.fn.extend({side:game.card.side,opponent:game.card.opponent,canPlay:game.card.canPlay,place:game.card.place,select:game.card.select,unselect:game.card.unselect,reselect:game.card.reselect,canMove:game.card.canMove,move:game.card.move,animateMove:game.card.animateMove,reduceStun:game.card.reduceStun,canAttack:game.card.canAttack,attack:game.card.attack,damage:game.card.damage,heal:game.card.heal,setDamage:game.card.setDamage,setArmor:game.card.setArmor,setResistance:game.card.setResistance,setHp:game.card.setHp,setCurrentHp:game.card.setCurrentHp,setSpeed:game.card.setSpeed,setRange:game.card.setRange,shake:game.card.shake,die:game.card.die,reborn:game.card.reborn})},chars:"abcdefghijklmnopqrstuvwyzABCDEFGHIJKLMNOPKQRSTUVWXYZ1234567890".split(""),newId:function(){for(var a="",e=0;e<24;e++)a+=game.card.chars.random();return a},build:function(a){var t,e,s,n,i,o,r={summon:a["summon name"]};if(a.hand==game.data.ui.left&&(a.className+=" left-hand"),a.deck==game.data.ui.temp&&(a.className+=" temp"),(t=$("<div>").addClass("card "+a.className)).attr("id",game.card.newId()),e=$("<legend>").text(a.name),s=$("<fieldset>"),n=$("<div>").addClass("portrait").appendTo(s),$("<div>").appendTo(n).addClass("img"),$("<div>").appendTo(n).addClass("overlay"),a.attribute?$("<h1>").addClass("attr").appendTo(s).text(a.attribute):a.deck==game.data.ui.summon?$("<h1>").addClass("type").appendTo(s).text(game.data.ui.summon):a.type&&$("<h1>").addClass("type").appendTo(s).text(a.type),i=$("<div>").addClass("current").appendTo(s),a.hp&&($("<p>").addClass("hp").appendTo(i).html("HP <span>"+a.hp+"</span>"),a["current hp"]=a.hp),a.damage&&($("<p>").addClass("damage").appendTo(i).html("DMG <span>"+a.damage+"</span>"),a["current damage"]=a.damage),o=$("<div>").addClass("desc").appendTo(s),a.dot&&($("<p>").appendTo(o).text(game.data.ui.dot+": ").addClass("dot").append($("<span>").text(a.dot)),r.dot=!0),a.price&&$("<p>").appendTo(o).text(game.data.ui.price+": $"+a.price).addClass("price"),1<a.cards&&$("<p>").appendTo(o).text(game.data.ui.cards+": "+a.cards),a["damage type"]?$("<p>").appendTo(o).text(game.data.ui.damage+": "+a["damage type"]):a.buff&&a.buff["damage type"]&&$("<p>").appendTo(o).text(game.data.ui.damage+": "+a.buff["damage type"]),!a["cast range"]||a.aoe&&a.aoe==game.data.ui.linear||("ru"==game.language.current?$("<p>").appendTo(o).text(game.data.ui["cast range"]+": "+a["cast range"]):999==a["cast range"]?$("<p>").appendTo(o).text(game.data.ui["cast range"]+": "+game.map.getRangeStr(a["cast range"])):$("<p>").appendTo(o).text(game.data.ui["cast range"]+": "+game.map.getRangeStr(a["cast range"])+" ("+a["cast range"]+")")).addClass("castRange"),a.aoe&&("number"==typeof a["aoe width"]?$("<p>").appendTo(o).text(game.data.ui.aoe+": "+a.aoe+" ("+a["aoe range"]+"/"+(2*a["aoe width"]+1)+")"):$("<p>").appendTo(o).text(game.data.ui.aoe+": "+a.aoe+" ("+game.map.getRangeStr(a["aoe range"])+")")),a.range&&$("<p>").appendTo(o).text(game.data.ui.range+": "+game.map.getRangeStr(a.range)).addClass("range"),a.armor&&($("<p>").appendTo(o).text(game.data.ui.armor+": "+a.armor).addClass("armor"),a["current armor"]=a.armor),a.resistance&&($("<p>").appendTo(o).text(game.data.ui.resistance+": "+a.resistance).addClass("resistance"),a["current resistance"]=a.resistance),1<a.mana&&$("<p>").appendTo(o).text(game.data.ui.mana+": "+a.mana).addClass("mana"),a.speed&&(a["current speed"]=a.speed,"number"==typeof a.speed&&(a.speed=game.map.getRangeStr(a.speed)),$("<p>").appendTo(o).text(game.data.ui.speed+": "+a.speed).addClass("speed")),a["bonus cards"]&&$("<p>").appendTo(o).text(game.data.ui.bonus+" "+game.data.ui.cards+": "+a["bonus cards"]),a.type==game.data.ui.channel&&a.channel&&1<a.channel&&($("<p>").appendTo(o).text(game.data.ui.channel+" "+game.data.ui.duration+": "+a.channel+" "+game.data.ui.turns),r.duration=!0),a.stun&&1<a.stun&&$("<p>").appendTo(o).text(game.data.ui.stun+" "+game.data.ui.duration+": "+a.stun+" "+game.data.ui.turns),(r=game.card.buffs(a,o,i,r)).buff=!0,a.buff&&(r.summon||(r=game.card.buffs(a.buff,o,i,r))),a.buffs)for(var d in a.buffs)for(var l in a.buffs[d])r.summon||(r=game.card.buffs(a.buffs[d][l],o,i,r));return a.heal&&$("<p>").appendTo(o).text(game.data.ui.heal+": "+a.heal),a["cards per turn"]&&$("<p>").appendTo(o).text(game.data.ui.cards+": "+a["cards per turn"]),a["skill cards"]&&$("<p>").appendTo(o).text(game.data.ui.cards+": "+a["skill cards"]),a.description&&$("<p>").appendTo(o).addClass("description").text(""+a.description+""),a.kd&&($("<p>").addClass("kd").appendTo(o).html(game.data.ui.kd+': <span class="kills">0</span>/<span class="deaths">0</span>'),a.kills=0,a.deaths=0),a.buffsBox&&$("<div>").addClass("buffs").appendTo(s),$.each(a,function(a,e){"Array"!=e.constructor.name&&"Object"!=e.constructor.name||(e=JSON.stringify(e)),t.data(a,e)}),t.append(e).append(s),t},buffs:function(a,e,t,s){return a.damage&&s.buff&&$("<p>").appendTo(e).text(game.data.ui.damage+": ").addClass("dot").append($("<span>").text(a.damage)),a["cast damage bonus"]&&$("<p>").appendTo(e).text(game.data.ui.damage+": ").addClass("dot").append($("<span>").text(a["cast damage bonus"])).append("<i> * "+game.data.ui.skills+"</i>"),a["damage per kill"]&&$("<p>").appendTo(e).text(game.data.ui.damage+": ").addClass("dot").append($("<span>").text(a["damage per kill"])).append("<i> * "+game.data.ui.kills+"</i>"),a["damage bonus"]&&$("<p>").appendTo(e).text(game.data.ui.damage+" "+game.data.ui.bonus+": ").addClass("dot").append($("<span>").text(a["damage bonus"])),a.dot&&!s.dot&&$("<p>").appendTo(e).text(game.data.ui.dot+": ").addClass("dot").append($("<span>").text(a.dot)),a["unit damage bonus"]&&$("<p>").appendTo(e).text(game.data.ui.damage+": ").addClass("dot").append($("<span>").text(a["unit damage bonus"])),a["damage reduction"]&&$("<p>").appendTo(e).text(game.data.ui.damage+": -").append($("<span>").text(a["damage reduction"])),a["hp bonus"]&&$("<p>").addClass("hp").appendTo(t).html("HP <span>"+a["hp bonus"]+"</span>"),a["hp per kill"]&&$("<p>").appendTo(e).html(game.data.ui.hp+": "+a["hp per kill"]+" <i>* "+game.data.ui.kills+"</i>"),a["cards per turn"]&&$("<p>").appendTo(e).text(game.data.ui.cards+": "+a["cards per turn"]),a.chance&&$("<p>").appendTo(e).text(game.data.ui.chance+": "+a.chance+"%"),a.percentage&&$("<p>").appendTo(e).text(game.data.ui.percentage+": "+a.percentage+"%"),a.lifesteal&&$("<p>").appendTo(e).text(game.data.ui.heal+" "+game.data.ui.damage+": "+a.lifesteal+"%"),a.multiplier&&$("<p>").appendTo(e).text(game.data.ui.multiplier+": "+a.multiplier+"X"),a["armor bonus"]&&$("<p>").appendTo(e).text(game.data.ui.armor+" "+game.data.ui.bonus+": "+a["armor bonus"]),a["armor reduction"]&&$("<p>").appendTo(e).text(game.data.ui.armor+": -"+a["armor reduction"]),a["resistance bonus"]&&$("<p>").appendTo(e).text(game.data.ui.resistance+" "+game.data.ui.bonus+": "+a["resistance bonus"]),a["range bonus"]&&$("<p>").appendTo(e).text(game.data.ui.range+" "+game.data.ui.bonus+": "+a["range bonus"]),a.heal&&$("<p>").appendTo(e).text(game.data.ui.buff+" "+game.data.ui.heal+": "+a.heal),a.duration&&1<a.duration&&!s.duration&&($("<p>").appendTo(e).text(game.data.ui.buff+" "+game.data.ui.duration+": "+a.duration+" "+game.data.ui.turns),s.duration=!0),s},side:function(a){return this.hasClass("player")?"player":this.hasClass("enemy")?"enemy":this.hasClass("neutral")?"neutral":void 0},opponent:function(a){return this.hasClass("player")?"enemy":this.hasClass("enemy")?"player":void 0},canPlay:function(){var a=$(this),e=a.hasClass("player")&&"player"==game.currentTurnSide;return"local"==game.mode&&(e=a.side()==game.currentTurnSide),"library"==game.mode&&(e="player"==game.currentTurnSide),e},place:function(a){return a.addClass||(a=$("#"+a)),this.getSpot().addClass("free"),this.appendTo(a.removeClass("free")),this.reselect(),this},select:function(a){var e=$(this).closest(".card");return e&&(!a?game.card.setSelection(e):game.lockSelection||e.hasClasses("selected attacktarget casttarget dead")||(2!==a.button?game.card.setSelection(e,a):game.card.unselect())),e},clearSelection:function(){game.selectedCard&&(game.items.sellMode=!1,game.highlight.clearMap(),game.selectedCard.removeClass("selected draggable"),game.skill.disableDiscard(),game.states.table.selectedClone&&(game.states.table.selectedClone.remove(),game.states.table.selectedClone=null),game.selectedCard.data("cast select")&&game.selectedCard.data("source")&&game.selectedCard.data("source",!1),game.selectedCard=null)},setSelection:function(a,e){game.card.clearSelection(),(game.selectedCard=a).addClass("selected"),game.highlight.map(e),game.states.table.selectedClone=a.clone().css({transform:""}).removeClass("selected melee-attack can-attack blink done dead draggable dragTarget shake enemyMoveHighlight enemyMoveHighlightTarget casttarget").clearEvents().appendTo(game.states.table.selectedCard).on("mouseup",game.card.clickSelectClone),game.selectedCardZoom&&game.states.table.selectedClone.addClass("zoom"),game.states.table.selectedCard.addClass("flip"),a.trigger("select",{card:a}),game.states.table.el.removeClass("player enemy").addClass(a.side())},clickSelectClone:function(){$(this).toggleClass("zoom"),game.tutorial.axe&&game.tutorial.axe.toggleClass("left"),game.selectedCardZoom=!game.selectedCardZoom},unselect:function(){game.selectedCardZoom=!1,game.states.table.selectedCard&&game.states.table.selectedCard.removeClass("flip"),game.timeout(200,game.card.clearSelection)},reselect:function(){this.hasClass("selected")&&this.select()},canMove:function(a){var e=!this.hasClasses("static dead stunned rooted entangled disabled sleeping cycloned taunted");return(a||this.hasClass("can-move"))&&e},move:function(a){"string"==typeof a&&(a=$("#"+a));var t,e=this,s=e.getPosition(),n=a.getPosition();return a.hasClass("free")&&!a.hasClasses("block cript")&&s!==n&&(e.removeClass("draggable").off("mousedown touchstart"),$(".map .movearea").addClass("moving"),e.parent().addClass("movesource"),a.addClass("movetarget"),e.stopChanneling(),game.audio.play("move"),e.animateMove(a),t={type:"move",card:e,target:n},game.timeout(50,game.fx.add.bind(this,"cat-leap",e.parent())),game.timeout(150,game.fx.add.bind(this,"cat-leap",a)),e.trigger("move",t).trigger("action",t),game.lockSelection=!0,a=function(a,e){game.lockSelection=!1,e.removeClass("free"),a.getSpot().addClass("free"),a.css({transform:""}).prependTo(e).on("mousedown touchstart",game.card.select),a.trigger("moved",t),$(".map .movesource, .map .movetarget").removeClass("movesource movetarget"),game.highlight.refresh()}.bind(this,e,a),this.hasClass("dragTarget")?game.timeout(25,a):game.timeout(300,a)),e},animateMove:function(a){var e,t;this.hasClass("dragTarget")||(t=this.getPosition(),e=a.getPosition(),a=game.map.getX(t),t=game.map.getY(t),a=100*(game.map.getX(e)-a),t=100*(game.map.getY(e)-t),this.css({transform:"translate3d("+(a-50)+"%, "+(t-40)+"%, 100px) rotateX(-30deg)"}))},setDamage:function(a){return a=parseInt(a,10),this.find(".current .damage span").text(a),this.data("current damage",a),this.reselect(),this},setCurrentHp:function(a){return a<0&&(a=0),this.find(".current .hp span").text(a),this.data("current hp",a),this.reselect(),this},setHp:function(a){return a<1&&(a=1),this.find(".desc .hp").text(a),this.data("hp",a),this.reselect(),this},setArmor:function(a){return this.find(".desc .armor").text(game.data.ui.armor+": "+a),this.data("current armor",a),this.reselect(),this},setResistance:function(a){return this.find(".desc .resistance").text(game.data.ui.resistance+": "+a),this.data("current resistance",a),this.reselect(),this},setSpeed:function(a){return this.data("current speed",a),"number"==typeof a&&(a=game.map.getRangeStr(a)),this.find(".desc .speed").text(game.data.ui.speed+": "+a),this},setRange:function(a){this.data("range",a),"number"==typeof a&&(a=game.map.getRangeStr(a)),this.find(".desc .range").text(game.data.ui.range+": "+a)},shake:function(){this.addClass("shake"),game.timeout(380,this.removeClass.bind(this,"shake"))},canAttack:function(a){if(this.data("current hp")<=0)return!1;var e=!this.hasClasses("dead stunned disarmed disabled ethereal cycloned");return(a||this.hasClass("can-attack"))&&e},attack:function(a,e,t){"string"==typeof a&&(a=$("#"+a+" .card"));var s=this,n=s.data("current damage"),i=s.getPosition(),o=a.getPosition();return n&&i!==o&&(a.data("current hp")||a.hasClass("trees"))&&s.canAttack(e)&&!a.hasClass("dead")&&(s.stopChanneling(),a.hasClass("trees")?game.timeout(500,game.tree.destroy.bind(this,a)):(i={type:"attack",source:s,target:a,damage:n,tag:t,force:e,bonus:0},s.trigger("pre-attack",i),a.trigger("pre-attacked",i),o=game.data.ui.physical,s.data("critical-attack")&&(n*=s.data("critical-attack"),o="critical"),a.hasClass("units")&&s.data("unit damage bonus")&&(n+=s.data("unit damage bonus")),n+=i.bonus||0,i.damage=n,s.trigger("attack",i).trigger("action",i),a.trigger("attacked",i),s.data("miss-attack")||s.damage(n,a,o),s.data("critical-attack",!1),i.bonus=0),e||"ult"==t||s.removeClass("can-attack"),s.removeClass("draggable"),game.highlight.refresh(),(e=game.map.getRangeInt(s.data("range")))<3&&(s.addClass("melee-attack"),game.timeout(300,s.removeClass.bind(s,"melee-attack"))),2<e&&(game.fx.projectile(s,a,t),game.timeout(400,game.fx.add.bind(this,"projectile-hit",s,a,"flip",0,t))),s.data("miss-attack")?game.fx.text(s,"missed",game.data.ui.miss,3e3):(s=s.hasClass("towers")?"tower":s.hasAllClasses("units ranged")?"wind":s.hasAllClasses("units catapult")?"ld":s.hasClasses("bear units transformed")?"bear":s.data("hero"),game.audio.play(s+"/attack"))),this},damage:function(a,e,t){var s,n,i,o,r=a,d="damaged";return 0<a&&!e.hasClass("dead")&&((t=t||game.data.ui.physical)===game.data.ui.magical&&(this.data("skillDamageBonus")&&(r=parseInt(r*this.data("skillDamageBonus"))),(n=e.data("current resistance"))&&(r-=n)),t!==game.data.ui.physical&&"critical"!==t||(i=e.data("current armor"))&&(r=a-i),r<1&&(r=1),a<1&&(a=1),(t===game.data.ui.magical&&e.hasClass("bkb")||e.hasClass("cycloned"))&&(a=r=0),"string"==typeof e&&(e=$("#"+e+" .card")),s=e.getPosition(),n=game.map.getX(s),i=game.map.getY(s),a={source:this,target:e,spot:game.map.getSpot(n,i),x:n,y:i,position:s,damage:r,originalDamage:a,type:t},e.trigger("damage",a),e.hasClass("immune")||(o=e.data("current hp")-r,e.setCurrentHp(o),e.shake()),o<1&&(e.stopChanneling(),game.timeout(400,game.card.kill.bind(game.card,a))),"critical"===t&&(this.data("critical-attack",!0),game.audio.play("crit"),d+=" critical"),game.fx.text(e,d,r,2500)),this},heal:function(a){var e,t,s;return 0<a&&0<this.length&&(e=this.data("current hp"),(t=this.data("hp"))<(s=e+(a=parseInt(a)))?0<(a=t-e)&&this.setCurrentHp(t):this.setCurrentHp(s),game.fx.text(this,"heal",a,3e3)),this},kill:function(a){var e,t=a.target,s=a.source,n=t.parent();t.setCurrentHp(0),t.stopChanneling(),t.data("bounty")&&t.side()!=s.side()&&!t.data("wk-ult")&&(game.items.addMoney(s.side(),t.data("bounty")),game.fx.text(n,"gold","$"+t.data("bounty"),2e3)),t.side()==s.side()&&game.fx.text(n,"deny","!",2e3),t.hasClass("heroes")&&(game[t.side()].deaths+=1,e=t.data("deaths")+1,t.data("deaths",e),t.find(".deaths").text(e),t.reselect()),s.hasClass("heroes")&&t.hasClass("heroes")&&(game[s.side()].kills+=1,e=s.data("kills")+1,s.data("kills",e),s.find(".kills").text(e),s.reselect()),a.position=t.getPosition(),t.addClass("dead"),game.timeout(900,function(){this.source.trigger("kill",this),this.target.die(this)}.bind(a))},die:function(a){var n=this;n.trigger("death",a),n.data("killer",a.source),n.hasClass("selected")&&n.unselect(),n.stopChanneling(),n.purge(),n.find(".damaged, .heal, .fx").remove(),n.addClass("dead").removeClass("target done can-attack stunned rooted silenced hexed disabled sleeping cycloned taunted entangled disarmed ai");var e=a.position,t=$("#"+e),s=n.side();return t.hasClass("cript")||t.addClass("free"),n.hasClass("heroes")?(t.hasClass("cript")||(e=game.heroDeathDamage,(t=game[s].tower.data("current hp")-e)<1&&(e+=t-1),a.target.side()!=a.source.side()&&a.source.damage(e,game[s].tower,game.data.ui.pure),game.card.rebornBuff(n),e=n.data("deaths")+1,n.data("deaths",e),n.find(".deaths").text(e),"library"!=game.mode&&$(".table ."+s+" .skills.hand .card."+n.data("hero")+", .table ."+s+" .skills.sidehand .card."+n.data("hero")).discard(),$(".card",game[s].skills.hand).each(function(a,e){e=$(e);e.data("deck")===game.data.ui.temp&&e.discard()})),$(".card",game[s].skills.sidehand).each(function(a,e){var t=$(e),s=t.data("hero"),e=t.data("name");t.hasClass("on")&&game.skills[s]&&game.skills[s][e]&&game.skills[s][e].toggle&&game.skills[s][e].toggle(t,n),t.removeClass("on channel-on")}),n.hasClass("player")?n.appendTo(game.player.heroesDeck):n.hasClass("enemy")&&n.appendTo(game.enemy.heroesDeck)):n.hasClass("towers")?(game.fx.add("lina-stun",n.parent()),n.hasClass("player")?game[game.mode].lose&&game.timeout(1400,game[game.mode].lose):n.hasClass("enemy")&&game[game.mode].win&&game.timeout(1400,game[game.mode].win)):(n.hasClass("units"),n.appendTo(game.hidden)),game.highlight.refresh(),n},rebornBuff:function(a,e){var t=a.side();e||(e=game.deadLength,"library"===game.mode&&(e=1)),game[t].tower.selfBuff({buffId:a.data("hero")+"-death",className:a.data("hero")+" heroes "+a.data("hero")+"-death",name:a.data("name"),description:game.data.ui.death,temp:!0,duration:e},!1,!0).on("expire",game.card.heroReborn.bind(a))},heroReborn:function(){this.reborn()||game.timeout(200,game.card.rebornBuff.bind(this,this,1))},reborn:function(a){var e,t,s=this.data("hp"),n=0;if(a&&a.attr)a=a.attr("id");else if(this.hasClass("player"))for(e=game.player.startX,t=game.height-1,a=game.map.toPosition(e+n,t);!$("#"+a).hasClass("free")&&n<game.player.picks.length;)n+=1,a=game.map.toPosition(e+n,t);else if(this.hasClass("enemy"))for(e=game.enemy.startX,t=game.height-1,a=game.map.mirrorPosition(game.map.toPosition(e,t));!$("#"+a).hasClass("free")&&n<game.enemy.picks.length;)n+=1,a=game.map.mirrorPosition(game.map.toPosition(e+n,t));var i=$("#"+a);if(a&&a.length&&(i.hasClass("free")||i.hasClass("cript"))){this.side();return this.setCurrentHp(s),this.removeClass("dead"),this.place(a),this.trigger("reborn",{target:this}),!0}}},game.deck={extendjQuery:function(){$.fn.extend({randomCard:game.deck.randomCard,shuffleDeck:game.deck.shuffleDeck})},build:function(a){var e=a.name,t=a.filter,s=a.cb,n=a.multi,a=a.deckFilter,i=$("<div>").addClass("deck "+e);return game.data[e]?game.deck.createDeck(i,e,s,t,n,a):game.states.loading.json(e,function(){game.deck.createDeck(i,e,s,t,n)}),i},createDeck:function(a,e,t,s,n,i){"heroes"===e&&game.deck.createHeroesDeck(a,t,s),"units"===e&&game.deck.createUnitsDeck(a,t,s),"skills"===e&&game.deck.createSkillsDeck(a,t,s,n,i),"items"===e&&game.deck.createItemsDeck(a,t,s,n,i)},createHeroesDeck:function(e,a,n){var i,t=game.data.heroes,o=[];$.each(t,function(t,a){var s=!1;n&&$.each(n,function(a,e){e===t&&(s=!0)}),!s&&n||(a.hero=t,a.speed=game.defaultSpeed,a.bounty=game.heroBounty,a.kd=!0,a.buffsBox=!0,a.className=[t,"heroes"].join(" "),Object.assign(a,game.data.values.heroes[t]),i=game.card.build(a).appendTo(e),o.push(i.attr("id")))}),e.data("cards",JSON.stringify(o)),a&&a(e)},createUnitsDeck:function(n,a,e){var i,t=game.data.units,o=[];$.each(t,function(t,a){var s=!1;e&&$.each(e,function(a,e){e===t&&(s=!0)}),!s&&e||$.each(a,function(a,e){e.type=game.data.ui.summon,e.label=a,e.unit=t,e.speed=game.defaultSpeed,e.bounty||(e.bounty=game.unitBounty),e.buffsBox=!0,e.className=[t+"-"+a,t,"units"].join(" "),Object.assign(e,game.data.values.units[t][a]),i=game.card.build(e).appendTo(n),o.push(i.attr("id"))})}),n.data("cards",JSON.stringify(o)),a&&a(n)},createSkillsDeck:function(d,a,e,l,m){var t=game.data.skills,g=[];$.each(t,function(r,a){var t=!1;e&&$.each(e,function(a,e){e===r&&(t=!0)}),!t&&e||$.each(a,function(a,e){if(!m||m&&m.indexOf(e.deck)<0){var t;if(e.hero=r,e.label=a,e.skillId=r+"-"+a,e.className=[r+"-"+a,"skills",r].join(" "),e.type==game.data.ui.summon&&(e.className+=" summon"),Object.assign(e,game.data.values.skills[r][a]),e.buff&&(e.buff.buffId=r+"-"+a,e.buff.className=r+"-"+a,Object.assign(e.buff,game.data.values.skills[r][a].buffdata)),e.buffs)for(var s in e.buffs)for(var n in e.buffs[s])e.buffs[s][n].buffId=r+"-"+a+"."+s+"-"+n,e.buffs[s][n].className=r+"-"+a+" "+s+"-"+n,Object.assign(e.buffs[s][n],game.data.values.skills[r][a].buffsdata[s][n]);var i=1;for(l&&(i=e.cards),t=0;t<i;t+=1){var o=game.card.build(e);o.appendTo(d),g.push(o.attr("id"))}}})}),d.data("cards",JSON.stringify(g)),a&&a(d)},createItemsDeck:function(e,a){var t=game.data.items,r=[];$.each(t,function(i,a){var o=$("<div>").addClass(i).appendTo(e);$.each(a,function(a,e){var t="items";if(e.attribute==game.data.ui.consumable&&(t+=" consumable"),e.item=a,e.itemtype=i,e.className=[a,i,t].join(" "),Object.assign(e,game.data.values.items[i][a]),e.buff&&(e.buff.buffId=a,e.buff.className=a,Object.assign(e.buff,game.data.values.items[i][a].buffdata)),e.buffs)for(var s in e.buffs)for(var n in e.buffs[s])e.buffs[s][n].buffId=a+"."+s+"-"+n,e.buffs[s][n].className=a+" "+s+"-"+n,Object.assign(e.buffs[s][n],game.data.values.items[i][a].buffsdata[s][n]);t=game.card.build(e).appendTo(o);r.push(t.attr("id"))})}),e.data("cards",JSON.stringify(r)),a&&a(e)},randomCard:function(a){return this.length?a?$(this[parseInt(Math.random()*this.length,10)]):$(this[parseInt(game.random()*this.length,10)]):this},shuffleDeck:function(){var t=this,a=$(".card",t);a.length&&(a=a.shuffle(),$(a).each(function(a,e){t.append(e)}))}},game.enemy={startX:4,startY:6,money:0,placeHeroes:function(){game.enemy.heroesDeck=game.deck.build({name:"heroes",filter:game.enemy.picks,cb:function(a){a.addClass("cemitery enemy").hide().appendTo(game.states.table.enemy);var s=game.enemy.startX,n=game.height-1;$.each(JSON.parse(a.data("cards")),function(a,e){var t=$("#"+e),e=game.enemy.picks.indexOf(t.data("hero"));t.addClass("enemy").on("mousedown touchstart",game.card.select),t.place(game.map.mirrorPosition(game.map.toPosition(s+e,n))),"tutorial"==game.mode&&t.on("select",game.tutorial.selected)})}})},autoMove:function(a,e){game.recovering&&game.message.text(game.data.ui.enemymove),game.currentMoves="string"==typeof a?a.split("|"):a,game.enemy.autoMoveCount=0,game.enemy.moveEndCallback=e,game.currentMoves&&game.currentMoves.length&&game.currentMoves[0].length?game.enemy.autoMoving():game.enemy.movesEnd()},autoMoving:function(){var a,e,t,s,n=game.currentMoves[game.enemy.autoMoveCount];n&&n.length&&(s=n.split(":")),s&&s.length&&($(".enemyMoveHighlight").removeClass("enemyMoveHighlight"),$(".enemyMoveHighlightTarget").removeClass("enemyMoveHighlightTarget"),$(".source").removeClass("source"),game.enemy.moveAnimation=1e3,s[1]&&(n=game.recovering?s[1]:game.map.mirrorPosition(s[1]),s[2]&&(a=game.recovering?s[2]:game.map.mirrorPosition(s[2])),"M"===s[0]&&game.enemy.move(n,a),"A"===s[0]&&game.enemy.attack(n,a),"C"===s[0]&&(e=s[3],t=s[4],game.enemy.cast(n,a,e,t),game.enemy.moveAnimation=1600,"ult"==t&&(game.enemy.moveAnimation=2e3)),"P"===s[0]&&(game.enemy.moveAnimation=1200,a=game.recovering?s[1]:game.map.mirrorPosition(s[1]),e=s[2],t=s[3],game.enemy.passive(a,e,t)),"T"===s[0]&&(a=game.recovering?s[1]:game.map.mirrorPosition(s[1]),e=s[2],t=s[3],game.enemy.toggle(a,e,t)),"S"===s[0]&&(a=game.recovering&&"player"==game.currentTurnSide?s[1]:game.map.mirrorPosition(s[1]),creep=s[2],game.enemy.summonCreepMove(a,creep)),"D"===s[0]&&(e=s[1],t=s[2],game.enemy.discardMove(e,t),game.enemy.moveAnimation=800),"G"===s[0]&&(game.enemy.stopChanneling(n),game.enemy.moveAnimation=400),"B"===s[0]&&(game.enemy.buyItem(s[1],s[2]),game.enemy.moveAnimation=800),"U"===s[0]&&(n=game[game.mode].endPlayer,"enemy"==s[1]&&(n=game[game.mode].endEnemy),n())),game.enemy.autoMoveCount++,game.enemy.autoMoveCount<game.currentMoves.length&&!("single"==game.mode&&game.turn.counter<1)?game.timeout(game.enemy.moveAnimation,game.enemy.autoMoving):game.timeout(game.enemy.moveAnimation,game.enemy.movesEnd))},movesEnd:function(){$(".enemyMoveHighlight").removeClass("enemyMoveHighlight"),$(".enemyMoveHighlightTarget").removeClass("enemyMoveHighlightTarget"),$(".source").removeClass("source"),"single"==game.mode&&game.turn.counter<1?game.ai.endTurn():game.enemy.moveEndCallback?game.enemy.moveEndCallback():game[game.mode].endEnemy&&game[game.mode].endEnemy()},move:function(a,e){var t=$("#"+a+" .card"),s=$("#"+e),a=t.hasClass("can-move")&&t.hasClass("enemy");e&&(a||game.recovering)&&t.move&&s.hasClass("free")&&(t.addClass("enemyMoveHighlight"),t.removeClass("can-move"),t.move(e))},attack:function(a,e){var t=$("#"+a+" .card"),a=$("#"+e+" .card");e&&(t.hasClass("enemy")||game.recovering)&&t.attack&&a&&(t.addClass("enemyMoveHighlight"),t.attack(e),a.addClass("enemyMoveHighlightTarget"))},cast:function(a,e,t,s){var n=$("#"+a+" .card"),i=$("#"+e),o=t+"-"+s,a=$("."+game.currentTurnSide+"decks .hand .skills."+o+", ."+game.currentTurnSide+"decks .sidehand .skills."+o).first();n.hasClass("towers")&&(a=$(".table .items."+t+"."+s).first());var r,o=a.data("targets");o&&(0<=(o=JSON.parse(o)).indexOf(game.data.ui.enemy)||0<=o.indexOf(game.data.ui.ally)||0<=o.indexOf(game.data.ui.self))&&(r=$("#"+e+" .card")).length&&(i=r),a.addClass("showMoves"),n.addClass("enemyMoveHighlight"),i.hasClass(".card")&&i.addClass("enemyMoveHighlightTarget"),"single"==game.mode&&a.data("ai discard",void 0),a&&(n.hasClass("enemy")||game.recovering)&&n.cast&&game.timeout(game.enemy.moveAnimation,function(a,e,t,s){(n.hasClass("towers")&&game.items[t]&&game.items[t][s]&&game.items[t][s].cast||game.skills[t]&&game.skills[t][s]&&game.skills[t][s].cast)&&n.cast(a,e)}.bind(this,a,i,t,s))},passive:function(a,e,t){var s=$("#"+a+" .card"),a=e+"-"+t,a=$("."+game.currentTurnSide+"decks .hand .skills."+a+", ."+game.currentTurnSide+"decks .sidehand .skills."+a).first();a.addClass("showMoves"),s.addClass("enemyMoveHighlight"),game.timeout(game.enemy.moveAnimation,function(a,e,t,s){a.removeClass("showMoves"),game.skills[t][s].passive&&a&&e.hasClass("enemy")&&a.passive&&a.passive(e)}.bind(this,a,s,e,t))},toggle:function(a,e,t){var s=$("#"+a+" .card"),a=e+"-"+t,a=$("."+game.currentTurnSide+"decks .hand .skills."+a+", ."+game.currentTurnSide+"decks .sidehand .skills."+a).first();a.addClass("showMoves"),s.addClass("enemyMoveHighlight"),game.timeout(game.enemy.moveAnimation,function(a,e,t,s){a.removeClass("showMoves"),game.skills[t][s].toggle&&a&&e.hasClass("enemy")&&a.toggle&&a.toggle(e)}.bind(this,a,s,e,t))},summonCreep:function(a){var e=$(this),t=e.getPosition(),s=game.selectedCard,n=s.data("unit");!s.canPlay()&&"library"!=game.mode||game.units.summonCreep(e,t,n,a)},summonCreepMove:function(a,e){var t=$("#"+a),s=game[game.currentTurnSide||"enemy"].skills.sidehand.children(".creeps-"+e).first();t.hasClass("free")&&s.length&&(game.audio.play("activate"),s.addClass("showMoves"),game.timeout(game.enemy.moveAnimation,function(){game.fx.add("ld-return-target",t),s.removeClass("showMoves flipped").place(t),s.trigger("summon")}))},stopChanneling:function(a){a=$("#"+a+" .card");a.length&&a.stopChanneling()},buyItem:function(a,e){e=$(".items."+game.currentTurnSide+" ."+a+"."+e);e.length&&game.items.newCard(game.currentTurnSide,e),"player"==game.currentTurnSide&&(game.items.addMoney(game.currentTurnSide,-e.data("price")),e.data("buyTurn",game.totalTurns))},discard:function(a){game.skill.disableDiscard(),a.addClass("discardMove"),game.timeout(game.enemy.moveAnimation,function(){this.removeClass("discardMove"),this.discard()}.bind(a))},discardMove:function(a,e){var t=a+"-"+e,s=$("."+game.currentTurnSide+"decks .hand .skills."+t).first();s.length||(t=a+"."+e,s=$("."+game.currentTurnSide+"decks .sidehand .items."+t).first()),s&&(s.addClass("discardMove"),game.timeout(game.enemy.moveAnimation,s.discard.bind(s))),s.hasClass("items")&&game.items.addMoney(game.currentTurnSide,s.data("price")/2)},cardsInHand:function(){return game.enemy.skills.hand.children().length}},game.player={startX:4,startY:6,points:0,money:0,placeHeroes:function(t){game.player.heroesDeck=game.deck.build({name:"heroes",filter:game.player.picks,cb:function(a){var s,n,e=JSON.parse(a.data("cards"));a.addClass("cemitery player").appendTo(game.states.table.player).hide(),"library"==game.mode?((a=$("#"+e[0])).addClass("player").on("mousedown touchstart",game.card.select),s=parseInt(game.states.config[game.size].width/2),n=parseInt(game.states.config[game.size].height/2),a.place(game.map.toPosition(s,n))):(s=game.player.startX,n=game.height-1,$.each(e,function(a,e){var t=$("#"+e),e=game.player.picks.indexOf(t.data("hero"));t.addClass("player").on("mousedown touchstart",game.card.select),t.place(game.map.toPosition(s+e,n)),"tutorial"==game.mode&&t.on("select",game.tutorial.selected)})),t&&t()}})},move:function(a){var e=$(this),t=game.selectedCard,s=t.getPosition(),n=e.getPosition();t.canPlay()&&e.hasClass("free")&&s!==n&&t.hasClass("can-move")&&(t.removeClass("draggable").removeClass("can-move"),t.move(n),n="M:"+s+":"+n,game.history.saveMove(n),"online"==game.mode&&game.currentMoves.push(n))},attack:function(a){var e=$(this),t=game.selectedCard,s=t.getPosition(),n=e.getPosition();t.canPlay()&&t.data("damage")&&s!==n&&(e.data("current hp")||e.hasClass("trees"))&&(t.attack(e),n="A:"+s+":"+n,game.history.saveMove(n),"online"==game.mode&&game.currentMoves.push(n))},passive:function(a){var e=$(this),t=game.selectedCard,s=t.data("hero"),n=t.data("label"),i=e.getPosition();t.canPlay()&&s&&n&&!t.hasClass("casted")&&(t.addClass("casted"),t.passive(e),n="P:"+i+":"+s+":"+n,game.history.saveMove(n),"online"==game.mode&&game.currentMoves.push(n),game.skill.animateCast(t,e,a))},toggle:function(a){var e=$(this),t=game.selectedCard,s=t.data("hero"),n=t.data("label"),i=e.getPosition();t.canPlay()&&s&&n&&(t.toggle(e),n="T:"+i+":"+s+":"+n,game.history.saveMove(n),"online"==game.mode&&game.currentMoves.push(n),game.skill.animateCast(t,e,a))},cast:function(a){var e=$(this),t=game.selectedCard,s=t.side(),n=$(".map .source");n.length||(n=e),t.hasClass("items")&&(n=game[s].tower);var i=n.getPosition(),o=e.getPosition(),r=t.data("hero"),d=t.data("label"),s=t.data("secondary targets");t.hasClass("items")&&(r=t.data("itemtype"),d=t.data("item")),t.canPlay()&&r&&d&&i&&o&&!t.hasClass("casted")&&(s||(t.addClass("casted"),game.lockHighlight=!0),n.cast(t,o),t.data("type")==game.data.ui.summon&&e.removeClass("draggable"),s||(d="C:"+i+":"+o+":"+r+":"+d,game.history.saveMove(d),"online"==game.mode&&game.currentMoves.push(d),game.skill.animateCast(t,o,a)))},stopChanneling:function(a){var e="G:"+a.getPosition();game.history.saveMove(e),"online"==game.mode&&game.currentMoves.push(e),a.stopChanneling()},summonCreep:function(a){var e=$(this),t=e.getPosition(),s=game.selectedCard,n=s.data("label"),i="S:"+t+":"+n;s.canPlay()&&(game.history.saveMove(i),"online"==game.mode&&game.currentMoves.push(i),game.units.summonCreep(e,t,n,a))},discard:function(a){var e=a.data("hero"),t=a.data("label");a.hasClass("items")&&(e=a.data("itemtype"),t=a.data("item"));t="D:"+e+":"+t;game.history.saveMove(t),"online"==game.mode&&game.currentMoves.push(t),game.skill.disableDiscard(),a.addClass("slidedown"),game.timeout(200,function(){this.removeClass("slidedown"),this.discard()}.bind(a))},cardsInHand:function(){return game.player.skills.hand.children().length}},game.skill={extendjQuery:function(){$.fn.extend({canCast:game.skill.canCast,cast:game.skill.cast,passive:game.skill.passive,toggle:game.skill.toggle,discard:game.skill.discard,stopChanneling:game.skill.stopChanneling,addStack:game.skill.addStack,removeStack:game.skill.removeStack,addInvisibility:game.skill.addInvisibility,removeInvisibility:game.skill.removeInvisibility,summon:game.skill.summon,resummon:game.skill.resummon,getSkill:game.skill.getSkill})},build:function(a,e,t){game[a].skills={},game[a].skills.hand=$("<div>").appendTo(game.states.table[a]).addClass("deck skills hand"),game[a].skills.sidehand=$("<div>").appendTo(game.states.table[a]).addClass("deck skills sidehand"),game[a].skills.ult=$("<div>").hide().appendTo(game.states.table[a]).addClass("deck skills ult"),game[a].skills.temp=$("<div>").hide().appendTo(game.states.table[a]).addClass("deck skills temp"),game[a].skills.cemitery=$("<div>").hide().appendTo(game.states.table[a]).addClass("deck skills cemitery"),game[a].skills.deck=game.deck.build({name:"skills",multi:!e,filter:game[a].picks,cb:function(a){var e=this.side.toString();a.addClass("available").hide().appendTo(game.states.table[e]),$.each(JSON.parse(a.data("cards")),function(a,e){var t=$("#"+e),e=this.toString();t.addClass(e),"player"==e||"library"==game.mode||"local"==game.mode?t.on("mousedown touchstart",game.card.select).on("mouseenter",game.highlight.source).on("mouseleave",game.highlight.refresh):t.attr({title:""}).addClass("flipped"),t.data("deck")===game.data.ui.summon&&t.appendTo(game[e].unitsDeck),t.data("deck")===game.data.ui.temp&&t.appendTo(game[e].skills.temp),"ult"===t.data("label")&&t.appendTo(game[e].skills.ult)}.bind(e)),game[e].skills.deck=a,this.cb&&this.cb()}.bind({side:a,cb:t})})},calcMana:function(t){game[t].mana=0,$(game[t].picks).each(function(a,e){e&&(game[t].mana+=game.data.heroes[e].mana)}),game[t].cardsPerTurn=Math.round(game[t].mana/5)},buyCard:function(a){var e,t=$(".table ."+a+" .skills.available .card"),s=[],n=[];t.length<game[a].cardsPerTurn+1&&($(".table ."+a+" .skills.cemitery .card").appendTo(game[a].skills.deck),t=$(".table ."+a+" .skills.available .card")),$(".table .map ."+a+".heroes.card").each(function(){var a=$(this).data("hero");a&&n.push(a)});for(var i=0;i<t.length;i++){var o=$(t[i]);0<=n.indexOf(o.data("hero"))&&s.push(o)}e=$(s).randomCard(),game.skill.toHands(e,a)},toHands:function(a,e){a.removeClass("casted"),a.data("hand")===game.data.ui.right?game[e].skills.hand.children().length<game.maxSkillCards&&a.appendTo(game[e].skills.hand):game[e].skills.sidehand.children().length<game.maxSkillCards&&a.appendTo(game[e].skills.sidehand)},buyHand:function(a){game.units.buyCreeps(a),("challenger"==game[a].type||0<game[a].turn)&&game.skill.buyCards(game[a].cardsPerTurn,a)},buyCards:function(a,e){for(var t=0;t<a;t++)game.skill.buyCard(e)},buyCardsFromHero:function(a,e){var t,s=a.side(),n=a.data("hero");if(e){for(var i=[],o=0;o<e;o++)t=$("."+s+" .skills.available ."+n).randomCard(),game.skill.toHands(t,s),i.push(t);return i}return t=$("."+s+" .skills.available ."+n).randomCard(),game.skill.toHands(t,s),t},canCast:function(a){if(a&&a.length)return(!(a.hasClass("venge-ult")||a.hasClass("am-blink")||a.hasClass("blinkdagger"))||!this.hasClass("rooted"))&&!this.hasClasses("dead stunned silenced hexed disabled sleeping cycloned taunted")},cast:function(a,e){var t,s,n=this,i=a.data("hero"),o=a.data("label");return a.hasClass("items")&&(i=a.data("itemtype"),o=a.data("item")),o&&i&&("string"==typeof e&&(e=0<=(s=a.hasClass("items")?a.data("cast select")&&a.data("source")?game.data.items[i][o]["secondary targets"]:game.data.items[i][o].targets:a.data("cast select")&&a.data("source")?game.data.items[i][o]["secondary targets"]:game.data.skills[i][o].targets).indexOf(game.data.ui.spot)||0<=s.indexOf(game.data.ui.jungle)?$("#"+e):$("#"+e+" .card")),e.length&&(s={type:"cast",skill:a,source:n,target:e},a.data("cast select")&&!a.data("source")?(a.data("source",e.attr("id")),game.highlight.clearMap(),a.strokeSkill(e),game.highlight.active(s,e,a,"secondary")):(a.removeClass("draggable"),n.stopChanneling(),n.trigger("cast",s).trigger("action",s),a.trigger("cast",s),e.hasClass("spot")||e.trigger("casted",s),e.hasBuff("mirror-counter")&&n.side()!==e.side()||(0<=game.audio.sounds.indexOf(i+"/"+o)&&(t=i+"/"+o,e.hasClass("linken")?game.audio.play("activate"):"ult"!==o&&game.audio.play(t)),a.data("type")==game.data.ui.channel&&game.skill.channel(a,n,e,s),a.hasClass("items")?(o=a.data("itemtype"),s=a.data("item"),game.items[o][s].cast(a,e),game.skill.castafter(a,n,e)):e.hasClass("linken")?game.skill.castafter(a,n,e):game.fx.ult(a,function(a,e,t){var s=a.data("hero"),n=a.data("label");game.skills[s][n].cast(a,e,t),game.skill.castafter(a,e,t)}.bind(this,a,n,e),t))))),this},castafter:function(a,e,t){t=game.skill.castafterdiscard.bind(this,a,e,t);a.hasClass("dragTarget")?a.discard(e,t):game.timeout(400,a.discard.bind(a,e,t))},castafterdiscard:function(a,e,t){a.canPlay()&&a.hasClass("items")&&t&&t.hasClass("card")?t.hasClass("trees")?game.card.unselect():t.select():e.canPlay()&&e&&a.hasClass("selected")?e.select():game.highlight.refresh()},channel:function(a,e,t,s){var n=a.data("channel");t=t||e,(s=s||{skill:a,source:e,target:t}).type="channel",e.data("channel event",s),e.data("channeling",n),e.data("channel",n),e.data("channel skill",a),e.addClass("channeling"),a.addClass("channel-on")},stopChanneling:function(){var a=$(this);return a.hasClass("channeling")&&(a.trigger("channelend",a.data("channel event")),$(a.data("channel skill")).removeClass("channel-on on"),a.data("channel",null).data("channeling",null).data("channel skill",null).data("channel event",null),a.off("channel").off("channelend"),a.removeClass("channeling"),a.reselect()),this},activeStopChanneling:function(){var a=$(this);"player"==a.side()?game.player.stopChanneling(a):a.stopChanneling()},animateCast:function(a,e,t,s){var n;a.hasClass("dragTarget")||("string"==typeof e&&(e=$("#"+e)),n=a.offset(),e=t.clientX-n.left-150,n=t.clientY-n.top-220,a.css({transform:"translate("+e+"px, "+n+"px) scale(0.3)"}),game.timeout(400,function(a){$(this).css({transform:""}),a&&a()}.bind(a,s)))},passive:function(t){var a,s=this,i=s.data("hero"),e=s.data("label");return"string"==typeof t&&(t=$("#"+t+" .card")),e&&i&&(t.trigger("passive",{skill:s,target:t}),game.skills[i][e].passive(s,t),"aura"==e&&(a=t.side(),a=$(".table .card."+a+":not(.skills)"),$.each(a,function(a,e){t.addBuff($(e),s)}),t.on("death."+i+"-aura",function(a,e){e=e.target.side(),e=$(".table .card."+e+":not(.skills)");$.each(e,function(a,e){$(e).removeBuff(i+"-aura")})}),t.on("reborn."+i+"-aura",function(a,e){var t=e.target,s=game.data.skills[i].aura,e=t.side(),n=$(".table .card."+e+":not(.skills)");game.timeout(400,function(){$.each(n,function(a,e){t.addBuff($(e),s.buff)})})})),game.audio.play("activate"),t.shake(),s.removeClass("draggable"),a=function(a){this.appendTo(game.hidden),a.canPlay()?a.select():game.highlight.refresh()}.bind(s,t),s.hasClass("dragTarget")?a():game.timeout(400,a)),this},toggle:function(a){var e,t=this,s=t.data("hero"),n=t.data("label");return"string"==typeof a&&(a=$("#"+a+" .card")),n&&s&&(e={type:"toggle",skill:t,target:a},a.trigger("toggle",e),game.skills[s][n].toggle(t,a),0<=game.audio.sounds.indexOf(s+"/"+n)&&(t.is(".ld-ult:not(.on)")?game.audio.play(s+"/transform"):t.is(".pud-rot:not(.on)")?(game.audio.stop("pud/rot"),game.audio.play("activate")):game.audio.play(s+"/"+n)),a.shake(),t.removeClass("draggable"),t.hasClass("enemy")?--game.enemy.hand:t.hasClass("selected")&&game.timeout(400,function(a){"player"===a.side()&&a.select()}.bind(t,a))),this},summon:function(a){a.removeClass("draggable");var e=a.clone().addClass("units summoned").removeClass("skills selected flipped dragTarget can-attack can-move heroes").on("mousedown touchstart",game.card.select).on("mouseenter",game.highlight.source).on("mouseleave",game.highlight.refresh).css({transform:""});e.attr("id",game.card.newId()),a.data("summon name")&&e.find("legend").text(a.data("summon name")),e.find(".mana, .description, .castRange, .kd").remove(),e.data("summon",a.attr("id")),e.data("summoner",this.attr("id")),e.data("hp",a.data("hp")),e.data("damage",a.data("damage")),e.data("range",a.data("range")),e.data("armor",a.data("armor")),e.data("resistance",a.data("resistance"));a=a.data("speed")||game.defaultSpeed;return e.data("speed",a),"number"==typeof a&&(a=game.map.getRangeStr(a)),e.find(".speed").length||$("<p>").appendTo(e.find(".desc")).text(game.data.ui.speed+": "+a).addClass("speed"),e.data("current hp",e.data("hp")),e.data("current damage",e.data("damage")),e.data("current armor",e.data("armor")),e.data("current resistance",e.data("resistance")),e.data("current speed",e.data("speed")),e.find(".buffs").length||e.find("fieldset").append($("<div>").addClass("buffs")),game.timeout(400,function(a){"player"===this.side()&&a.select(),game.fx.text(a,"z")}.bind(this,e)),e},resummon:function(a){a.removeClass("dead").addClass("summonsleep").purge(),game.timeout(400,function(a){game.fx.text(a,"z")})},addStack:function(a){var e=this.data(a+"Stack");return e?this.data(a+"Stack",e+1):this.data(a+"Stack",1),this.addClass(a),this},removeStack:function(a){var e=this.data(a+"Stack")-1;return this.data(a+"Stack",e),e||this.removeClass(a),this},addInvisibility:function(s){var a;return this.addClass("invisible"),this.on("action.invisible",function(a,e){var t=$(this);"move"!==e.type&&(t.removeInvisibility(),t.trigger("invisibilityLoss",{target:t}),s&&t.removeBuff(s))}),s&&((a=this.data("invisibilityStack"))?this.data("invisibilityStack",a+1):this.data("invisibilityStack",1),s.on("expire",function(a,e){var t=e.target;t&&(e=t.data("invisibilityStack")-1,t.data("invisibilityStack",e),e||t.removeInvisibility())})),this},removeInvisibility:function(){return this.removeClass("invisible").off("action.invisible"),this},illusion:function(a){a=$(a);return a.clone().data(a.data()).addClass("illusion").on("mousedown touchstart",game.card.select)},disableDiscard:function(){game.items.shopEnabled?(game.states.table.shop.attr("disabled",!1),game.items.shopText()):game.states.table.shop.attr("disabled",!0)},enableDiscard:function(){game.states.table.shop.attr("disabled",!1).text(game.data.ui.discard)},shopDicardClick:function(){return game.states.table.shop.attr("disabled")||(game.states.table.shop.text()==game.data.ui.discard?game.skill.discardClick():game.items.shopClick()),!1},discardClick:function(){game.selectedCard&&game.selectedCard.hasClass("skills")&&game.canPlay()&&(game.highlight.clearMap(),game[game.selectedCard.side()].discard(game.selectedCard),game.skill.disableDiscard())},discard:function(a,e){var t;return this.removeClass("draggable"),this.hasClass("skills")?(this.hasClass("selected")&&(a&&a.canPlay()?a.select():game.card.unselect()),this.trigger("discard",{target:this}),t=this.side(),(a=this.data("discard-to"))?this.appendTo(game.resolve(a)):this.data("deck")===game.data.ui.temp?this.appendTo(game[t].skills.temp):this.data("type")===game.data.ui.summon?this.appendTo(game.hidden):this.appendTo(game[t].skills.cemitery),"enemy"==t&&this.addClass("flipped").removeClass("showMoves discardMove")):(this.hasClass("items")||this.closest(".map").length&&this.parent().addClass("free"),this.appendTo(game.hidden)),e&&e(),game.lockHighlight=!1,game.highlight.refresh(),this},getSkill:function(a){var e=this.side(),t=this.data("hero");return $("."+e+"decks .skills."+t+"-"+a).first()}},game.library={build:function(){game.library.buildSkills(),game.seed=(new Date).valueOf(),game.id=btoa(game.seed),game.player.type="challenged",game.enemy.type="challenger",game.setData("challenged",game.player.name),game.setData("challenger",game.enemy.name)},buildSkills:function(e){game.library.skills||(game.library.skills=game.deck.build({name:"skills",deckFilter:[game.data.ui.temp],cb:function(a){a.addClass("library").hide().appendTo(game.states.choose.el),$.each(JSON.parse(a.data("cards")),function(a,e){$("#"+e).addClass("player")}),e&&e(a)}}))},chooseStart:function(a){game.states.choose.pickedbox.show(),game.states.choose.intro.show(),game.states.choose.librarytest.show(),game.loader.removeClass("loading"),$(".slot").removeClass("available"),game.recovering=!1,game.message.text(game.data.ui.library),a?game.states.choose.selectHero(a,"force"):game.states.choose.selectFirst("force")},select:function(a,e){var t,s,n=a.data("hero");n===$(".choose .card.selected").data("hero")&&!e||(s=a.hasClass("dead"),$(".slot .card.skills").appendTo(game.library.skills),t=$(".library.skills .card."+n),$(".slot").each(function(a){a=$(t[a]);s&&a.addClass("dead"),a.appendTo(this),a.on("mouseup touchend",function(a){var e=$(this);return e.hasClass("zoom")?(game.states.choose.removeZoom(e),$(".choose .slot").removeClass("transparent"),$(".choose .pickedbox").removeClass("trans")):game.states.choose.lockZoom||game.selectedCardZoom||(game.states.choose.addZoom(e),$(".choose .slot").addClass("transparent"),$(".choose .pickedbox").addClass("trans"),e.parent().removeClass("transparent")),a&&a.preventDefault&&a.preventDefault(),!1})}),game.states.choose.pickedbox.hide().fadeIn(),$(".slot:empty").addClass("libhide"),a.data("disable")||(game.library.hero=a.data("hero"),game.setData("choose",game.library.hero)),game.states.choose.intro.attr("disabled",!game.data.heroes[game.library.hero].intro),game.states.choose.librarytest.attr("disabled",!!a.data("disable"))),game.states.choose.playVideo()},chooseEnd:function(){game.states.choose.clear(),game.states.changeTo("config")},setTable:function(){game.player.placeHeroes(),game.enemy.placeHeroes(),game.states.table.back.show(),game.states.table.surrender.hide(),game.items.enableShop(),game.states.table.enableUnselect(),game.turn.build(11),game.timeout(400,function(){game.skill.build("enemy"),game.skill.build("player",!1,function(){game.units.buyCreeps("player",!0),game.library.buildHand(),game.library.beginPlayer(),$(".map .player.card."+game.library.hero).select()})})},showIntro:function(){var a=game.library.hero,a=game.data.heroes[a].intro;return a&&!$(this).attr("disabled")&&game.states.choose.playVideo(a),!1},beginPlayer:function(){game.turn.begin("player",function(){game.tower.attack("enemy"),1<game.player.turn&&game.skill.buyHand("player"),game.items.addMoney("player",game.libReward)})},buildHand:function(){$(".card",game.player.skills.ult).appendTo(game.player.skills.deck),$(".card",game.player.skills.deck).each(function(){var a=$(this);a.data("hand")===game.data.ui.right?a.appendTo(game.player.skills.hand):a.appendTo(game.player.skills.sidehand)})},skip:function(){"player"==game.currentTurnSide&&game.library.endPlayer()},endPlayer:function(){game.turn.end("player",function(){setTimeout(game.library.beginEnemy,100)})},beginEnemy:function(){game.turn.begin("enemy",function(){game.loader.addClass("loading"),game.skill.buyHand("enemy"),game.tower.attack("player"),setTimeout(game.library.endEnemy,100)})},endEnemy:function(){game.turn.end("enemy",function(){setTimeout(game.library.beginPlayer,100)})},win:function(){game.states.table.clear(),game.states.changeTo("choose")},clear:function(){game.seed=0,game.id=null}},game.local={build:function(){game.seed=(new Date).valueOf(),game.id=btoa(game.seed),game.player.type="challenged",game.enemy.type="challenger",game.setData("challenged",game.player.name),game.setData("challenger",game.enemy.name)},chooseStart:function(a,e){var t=game.getData(game.player.type+"Deck");!e&&t?(game.player.picks=t.split("|"),game.local.secondDeck()):(game.loader.removeClass("loading"),game.states.choose.pickedbox.show(),game.states.choose.randombt.show().attr({disabled:!1}),game.states.choose.mydeck.show().attr({disabled:!0}),!e&&game.getData("mydeck")&&game.states.choose.mydeck.attr({disabled:!1}),e&&game.getData("mysecdeck")&&game.states.choose.mydeck.attr({disabled:!1}),game.states.choose.enablePick(),game.states.choose.counter.show().text(game.data.ui.clickpick),$(".slot").addClass("available"),e?game.message.text("Now, select player 2 deck"):game.message.text("Select player 1 deck"),a?game.states.choose.selectHero(a,"force"):game.states.choose.selectFirst("force"))},pick:function(){$(".slot.available:visible").length||(game.local.firstDeck?game.local.chooseEnd("picked"):(game.loader.addClass("loading"),game.timeout(100,game.local.secondDeck.bind(this,"picked"))))},secondDeck:function(a){game.local.firstDeck=!0,game.states.choose.fillPicks("player",a),game.setData(game.player.type+"Deck",game.player.picks.join("|")),game.states.choose.clear(),game.timeout(100,function(){game.local.chooseStart(!1,!0)})},chooseEnd:function(a){game.local.firstDeck?(game.states.choose.fillPicks("enemy",a),game.setData(game.enemy.type+"Deck",game.enemy.picks.join("|")),game.timeout(100,function(){game.states.choose.clear(),game.local.firstDeck=!1,game.states.changeTo("vs")})):game.timeout(100,game.local.secondDeck)},setTable:function(){game.player.placeHeroes(),game.enemy.placeHeroes(),game.audio.play("horn"),game.items.enableShop(),game.message.text(game.data.ui.battle),game.states.table.enableUnselect(),game.turn.build(6),game.timeout(400,function(){game.skill.build("enemy"),game.skill.build("player",!1,function(){game.timeout(1e3,game.local.beginPlayer)})})},startTurn:function(a){game.states.table.skip.attr("disabled",!1),game.turn.counter=game.timeToPlay,game.timeout(1e3,function(){game.turn.count(a,game.local.countEnd)})},countEnd:function(a){"player"==a?game.local.endPlayer():game.local.endEnemy()},beginPlayer:function(){game.turn.begin("player",function(){game.local.startTurn("player"),game.turn.buy("player")})},skip:function(){"player"==game.currentTurnSide?game.local.endPlayer():game.local.endEnemy()},endPlayer:function(){game.selectedCard&&game.selectedCard.unselect(),game.turn.end("player",game.local.beginEnemy)},beginEnemy:function(){game.turn.begin("enemy",function(){game.local.startTurn("enemy"),game.turn.buy("enemy")})},endEnemy:function(){game.selectedCard&&game.selectedCard.unselect(),game.turn.end("enemy",game.local.beginPlayer)},win:function(){game.turn.stopCount(),game.winner=game.player.type,game.states.changeTo("result")},surrender:function(){"enemy"==game.currentTurnSide?game.local.win():game.local.lose()},lose:function(){game.turn.stopCount(),game.winner=game.enemy.type,game.states.changeTo("result")},clear:function(){game.local.firstDeck=!1,game.seed=0,game.id=null}},game.online={build:function(a){game.online.builded=!0,game.tries=1,game.loader.addClass("loading"),a?game.currentData.challenger&&(game.player.name==game.currentData.challenger?game.online.battle("challenged",game.currentData.challenged):game.online.battle("challenger",game.currentData.challenger)):game.states.config.enable()},start:function(){game.online.started=!0,game.currentData={},game.newId(),game.setData("id",game.id),game.loader.addClass("loading"),game.message.text(game.data.ui.loading),game.tries=1,game.online.ask()},check:function(e){game.online.builded&&!game.online.started&&game.db({get:"waiting"},function(a){game.triesCounter.text(game.tries),a&&a.id&&"none"!==a.id&&a.id!==game.id?(game.online.found(a),game.states.changeTo("choose")):(e&&(game.states.changeTo("config"),game.states.config.enable()),game.online.builded&&!game.online.started&&(game.tries+=1,setTimeout(game.online.check,1e3)))})},backClick:function(){game.online.builded=!1,game.online.started=!1,game.db({set:"back",data:game.id}),game.states.changeTo("menu")},ask:function(){game.db({set:"waiting",data:game.id},function(a){game.triesCounter.text(game.tries),a&&a.id?"none"==a.id||a.id==game.id?game.online.wait():game.online.found(a):(game.tries+=1,setTimeout(game.online.ask,1e3))})},wait:function(){game.loader.addClass("loading"),game.setData("size",game.size),game.setData("id",game.id),game.player.type="challenged",game.setData("challenged",game.player.name),game.db({set:game.id+"challenged",data:game.currentData},function(){game.message.text(game.data.ui.waiting),game.online.waiting=!0,game.tries=1,setTimeout(game.online.searching,1e3)})},searching:function(){game.states.choose.back.attr({disabled:!1}),game.id&&game.online.waiting&&game.db({get:game.id+"challenger"},function(a){a.challenger?(game.online.waiting=!1,game.online.challengerFound(a.challenger)):(game.triesCounter.text(game.tries),game.tries>=game.waitLimit?game.online.ask():(game.tries+=1,game.timeout(1e3,game.online.searching)))})},challengerFound:function(a){game.states.changeTo("choose"),game.message.text(game.data.ui.gamefound),game.online.battle("challenger",a)},found:function(a){game.states.choose.back.attr({disabled:!0}),game.message.text(game.data.ui.gamefound),game.setId(a.id),game.player.type="challenger",game.setData("challenger",game.player.name),game.db({get:a.id+"challenged"},function(a){var e=a.challenged;e&&game.db({set:game.id+"challenger",data:game.currentData},function(){game.states.config.size(a.size),game.online.battle("challenged",e),game.states.changing=!1,game.states.changeTo("choose")})})},battle:function(a,e){game.tries=1,game.triesCounter.text(""),game.loader.removeClass("loading"),game.enemy.name=e,game.enemy.type=a,game.setData(a,e),game.message.html(game.data.ui.battlefound+" <b>"+game.player.name+'</b> vs <b class="enemy">'+game.enemy.name+"</b>"),game.states.choose.counter.show(),game.audio.play("battle"),setTimeout(game.online.enablePick,400)},chooseStart:function(){game.states.choose.randombt.show().attr({disabled:!0}),game.states.choose.mydeck.show().attr({disabled:!0}),game.states.choose.pickedbox.hide()},enablePick:function(){game.states.choose.randombt.show().attr({disabled:!1}),game.states.choose.mydeck.show(),game.getData("mydeck")&&game.states.choose.mydeck.attr({disabled:!1}),game.states.choose.enablePick(),game.states.choose.count=game.timeToPick,setTimeout(game.online.pickCount,1e3)},pickCount:function(){--game.states.choose.count,$(".slot.available").length&&game.states.choose.counter.text(game.data.ui.pickdeck+": "+game.states.choose.count),game.states.choose.count<0?(game.states.choose.counter.text(game.data.ui.getready),game.online.picked||(game.states.choose.disablePick(),game.states.choose.counter.text(game.data.ui.getready),game.states.choose.randomFill(game.online.chooseEnd))):game.timeout(1e3,game.online.pickCount)},pick:function(){0===$(".slot.available").length&&(game.online.picked||(game.online.picked=!0,game.online.chooseEnd("picked")))},chooseEnd:function(a){game.states.choose.disablePick(),game.states.choose.counter.text(game.data.ui.getready),game.states.choose.fillPicks("player",a),game.online.sendDeck()},sendDeck:function(){var a=game.player.picks.join("|");game.setData(game.player.type+"Deck",a),game.db({set:game.id+game.player.type,data:game.currentData},function(){game.online.loadDeck(game.enemy.type)})},loadDeck:function(e){game.message.text(game.data.ui.loadingdeck),game.loader.addClass("loading"),game.db({get:game.id+e},function(a){a[e+"Deck"]?game.online.foundDeck(e,a):(game.triesCounter.text(game.tries),game.tries>=game.timeToPick+game.connectionLimit?game.states.choose.back.attr({disabled:!1}):game.tries>=game.timeToPick+2*game.connectionLimit?game.online.backClick():(game.tries+=1,game.timeout(1e3,game.online.loadDeck.bind(this,e))))})},foundDeck:function(a,e){game.triesCounter.text("");a+="Deck";game.setData(a,e[a]),game.enemy.picks=e[a].split("|"),game.setData(game.enemy.type+"Deck",game.enemy.picks),game.states.choose.clear(),game.states.changeTo("vs")},setTable:function(){game.online.table||(game.online.table=!0,game.states.table.enableUnselect(),game.loader.addClass("loading"),game.message.text(game.data.ui.battle),game.audio.play("horn"),game.items.enableShop(),game.player.placeHeroes(),game.enemy.placeHeroes(),game.turn.build(6),game.timeout(400,function(){game.skill.build("enemy"),game.skill.build("player",0,function(){"challenger"===game.player.type?game.timeout(1e3,game.online.beginEnemy):game.timeout(1e3,game.online.beginPlayer)})}))},startTurn:function(a){game.turn.counter=game.timeToPlay;var e=1e3;"enemy"==a&&(e=3e3,game.loader.addClass("loading")),game.timeout(e,function(){game.turn.count(a,game.online.countEnd,game.online.preGetTurnData)})},countEnd:function(a){"player"==a&&game.online.endPlayer(),"enemy"==a&&(game.tries=1,game.loader.addClass("loading"),game.message.text(game.data.ui.loadingturn),game.online.getTurnData())},beginPlayer:function(){game.turn.begin("player",function(){game.online.startTurn("player"),game.turn.buy("player")})},skip:function(){game.turn.stopCount(),game.online.endPlayer()},endPlayer:function(){game.turn.end("player",game.online.sendTurnData)},sendTurnData:function(e){var a=game.player.type+"Turn";game.message.text(game.data.ui.uploadingturn),game.setData("moves",game.currentMoves.join("|")),game.setData(a,game.player.turn),game.db({get:game.id+game.enemy.type},function(a){a.surrender?game.online.win():e?e():game.db({set:game.id+game.player.type,data:game.currentData},game.online.beginEnemy)})},beginEnemy:function(){game.turn.begin("enemy",function(){game.online.startTurn("enemy"),game.turn.buy("enemy")})},preGetTurnData:function(a){"enemy"==a&&game.db({get:game.id+game.enemy.type},function(a){a[game.enemy.type+"Turn"]===game.enemy.turn+1&&(game.turn.stopCount(),game.online.beginEnemyMoves(a,"pre"))})},getTurnData:function(){game.db({get:game.id+game.enemy.type},function(a){a[game.enemy.type+"Turn"]===game.enemy.turn+1?game.online.beginEnemyMoves(a):(game.triesCounter.text(game.tries),game.tries>game.connectionLimit?game.debug?game.reset("online.js: Unable to load enemy turn data"):game.db({get:"server"},function(a){"online"==a.status&&game.online.win()}):(game.tries+=1,game.timeout(1e3,game.online.getTurnData)))})},beginEnemyMoves:function(a){a.surrender==game.enemy.type?game.online.win():(game.triesCounter.text(""),game.setData(game.enemy.type,game.enemy.turn),game.setData("moves",a.moves),game.enemy.autoMove(a.moves,game.online.endEnemy))},endEnemy:function(){game.turn.end("enemy",game.online.beginPlayer)},win:function(){game.turn.stopCount(),game.winner=game.player.type,game.player.points+=10,game.setData("points",game.player.points),game.online.sendTurnData(function(){game.states.changeTo("result")})},surrender:function(){game.turn.stopCount(),game.setData("surrender",game.player.type),game.setData(game.player.type+"Turn",game.player.turn),game.db({set:game.id+game.player.type,data:game.currentData},game.online.lose)},lose:function(){game.turn.stopCount(),game.winner=game.enemy.type,game.loader.removeClass("loading"),game.states.changeTo("result")},clear:function(){game.online.builded=!1,game.online.started=!1,game.online.picked=!1,game.online.table=!1,game.currentData={},game.seed=0,game.id=null}},game.single={build:function(){game.single.builded||(game.single.builded=!1,game.newId()),game.player.type="challenged",game.enemy.type="challenger",game.size="s5v5"},chooseStart:function(a){game.states.choose.randombt.show(),game.states.choose.mydeck.attr({disabled:!0}).show(),game.getData("mydeck")&&game.states.choose.mydeck.attr({disabled:!1}),game.states.choose.enablePick(),game.states.choose.counter.show().text(game.data.ui.clickpick)},pick:function(){$(".slot.available").length||(game.loader.addClass("loading"),game.states.choose.back.attr("disabled",!0),game.single.chooseEnd("picked"))},chooseEnd:function(a){game.states.choose.fillPicks("player",a),game.timeout(400,function(){game.states.changeTo("vs")})},setTable:function(){game.single.started||(game.audio.play("horn"),game.single.started=!0,game.items.enableShop(),game.states.table.enableUnselect(),game.message.text(game.data.ui.battle),game.loader.removeClass("loading"),game.player.placeHeroes(),game.enemy.placeHeroes(),game.turn.build(6),game.ai.start(),game.timeout(400,function(){game.skill.build("enemy"),game.skill.build("player",0,function(){game.timeout(1e3,game.single.beginPlayer)})}))},startTurn:function(a){game.turn.counter=("player"==a?game:game.ai).timeToPlay,game.timeout(1e3,function(){game.turn.count(a,game.single.countEnd)})},countEnd:function(a){"player"==a&&game.single.endPlayer()},beginPlayer:function(){game.turn.begin("player",function(){game.single.startTurn("player"),game.player.turn===game.ultTurn&&$(".card",game.player.skills.ult).appendTo(game.player.skills.deck),game.skill.buyHand("player"),game.tower.attack("enemy"),game.items.addMoney("player",game.turnReward),game.autoplay&&(game.ai.side="player",game.ai.end=game.single.endPlayer,game.timeout(1e3,game.ai.turnStart))})},skip:function(){game.single.endPlayer()},endPlayer:function(){game.turn.end("player",game.single.beginEnemy)},beginEnemy:function(){game.turn.begin("enemy",function(){game.single.startTurn("enemy"),game.enemy.turn===game.ultTurn&&$(".card",game.enemy.skills.ult).appendTo(game.enemy.skills.deck),game.skill.buyHand("enemy"),game.tower.attack("player"),game.items.addMoney("enemy",game.turnReward),game.ai.side="enemy",game.ai.end=game.single.endEnemy,game.timeout(1e3,game.ai.turnStart)})},endEnemy:function(){game.turn.stopCount(),game.turn.end("enemy",game.single.beginPlayer)},win:function(){game.turn.stopCount(),game.nextStage=!0,game.winner=game.player.type,game.player.points+=1,game.setData("points",game.player.points),game.states.changeTo("result")},surrender:function(){game.single.lose()},lose:function(){game.turn.stopCount(),game.winner=game.enemy.type,game.loader.removeClass("loading"),game.states.changeTo("result")},clear:function(){game.single.started=!1}},game.tutorial={build:function(){game.tutorial.builded||(game.tutorial.builded=!0,game.tutorial.axe=$("<div>").addClass("axe tutorial"),game.tutorial.axeimg=$("<div>").addClass("img").appendTo(game.tutorial.axe),game.tutorial.axebaloon=$("<div>").addClass("baloon").appendTo(game.tutorial.axe),game.tutorial.txtflip=$("<div>").addClass("txtflip").appendTo(game.tutorial.axebaloon),$("<span>").addClass("txtclip").appendTo(game.tutorial.txtflip),$("<span>").addClass("txtclip right").appendTo(game.tutorial.txtflip),game.tutorial.message=$("<span>").addClass("txt").appendTo(game.tutorial.txtflip),$("<span>").addClass("txtclip").appendTo(game.tutorial.txtflip),$("<span>").addClass("txtclip right").appendTo(game.tutorial.txtflip),game.tutorial.axe.appendTo(game.states.choose.el)),game.seed=(new Date).valueOf(),game.id=btoa(game.seed),game.message.text(game.data.ui.waiting),game.states.choose.enablePick(),game.tutorial.axeshow(),game.player.type="challenged",game.enemy.type="challenger"},axeshow:function(){game.tutorial.letter(game.data.ui.axepick),setTimeout(function(){"tutorial"==game.mode&&(game.tutorial.axe.addClass("up"),game.timeout(400,function(){"tutorial"==game.mode&&"choose"==game.currentState&&(game.audio.play("tutorial/axehere"),game.tutorial.axebaloon.fadeIn("slow"),game.message.text(game.data.ui.tutorialstart),game.loader.removeClass("loading"))}))},400)},letter:function(a){var s=game.tutorial.message,n=0;s.html(a),$(s[0].childNodes).each(function(a,e){var t=(e="#text"==e.nodeName?(t=$("<span>"+e.textContent+"</span>"),s[0].insertBefore(t[0],e),s[0].removeChild(e),t):$(e)).text().split("");e.empty(),$(t).each(function(){var a=$("<span>"+this+"</span>").css({opacity:0});e.append(a),setTimeout(function(){this.css({opacity:1})}.bind(a),20*(n+1)),n++})})},chooseStart:function(){game.states.choose.randombt.show(),$(".pickbox .card").addClass("hidden"),$(".am, .cm, .pud, .lina, .en",".pickbox").removeClass("hidden"),game.states.choose.selectFirst(),game.states.choose.counter.show().text(game.data.ui.clickpick)},pick:function(){var a=$(".slot.available").length;game.tutorial.axebaloon.hide().fadeIn("slow"),4===a?game.tutorial.letter(game.data.ui.axeheroes):3===a?game.tutorial.letter(game.data.ui.axemana):2===a?game.tutorial.letter(game.data.ui.axechooseorder):1===a&&game.tutorial.letter(game.data.ui.axeautodeck),a?"ru"==game.language.current?game.states.choose.counter.text(game.data.ui.togo+" "+a):game.states.choose.counter.text(a+" "+game.data.ui.togo):(game.states.choose.back.attr("disabled",!0),game.loader.addClass("loading"),game.message.text(game.data.ui.loadingdeck),game.states.choose.counter.text(game.data.ui.getready),game.audio.play("tutorial/axebattle"),game.tutorial.letter(game.data.ui.axebattle),setTimeout(game.tutorial.chooseEnd,2e3))},chooseEnd:function(){game.states.choose.fillPicks("player"),game.states.changeTo("vs")},setTable:function(){game.tutorial.started||(game.currentTurnSide="player",game.tutorial.started=!0,game.tutorial.lesson="Enemy",game.message.text(game.data.ui.battle),game.loader.removeClass("loading"),game.audio.play("horn"),game.player.placeHeroes(),game.enemy.placeHeroes(),game.states.table.skip.attr("disabled",!0),game.states.table.surrender.attr("disabled",!1),game.skill.disableDiscard(),game.turn.build(6),game.tutorial.axe.removeClass("up").appendTo(game.states.table.el),game.tutorial.axebaloon.hide(),game.tutorial.moveCountValue=5,game.message.text(game.data.ui.yourturn),game.tutorial.axe.addClass("up fleft"),game.enemy.tower.addClass("blink").on("select",game.tutorial.selected),game.timeout(400,function(){game.skill.build("enemy"),game.skill.build("player",0,function(){game.timeout(1e3,game.tutorial.selectEnemyLesson)})}))},selectEnemyLesson:function(){game.states.table.el.addClass("turn"),game.turn.time.text(game.data.ui.time+": 1:00 "+game.data.ui.day),game.turn.msg.text(game.data.ui.turns+": 1/0 (1)"),game.tutorial.axebaloon.fadeIn("slow"),game.tutorial.letter(game.data.ui.axeselectenemy)},selected:function(a,e){var t=e.card;return t.hasClass("blink")&&("Enemy"===game.tutorial.lesson&&game.tutorial.selectedTower(),"Creep"===game.tutorial.lesson&&game.tutorial.selectedCreep(t),"Move"===game.tutorial.lesson&&game.tutorial.moveLesson(),"Passive"===game.tutorial.lesson&&game.tutorial.selectedPassive(),"Jungle"===game.tutorial.lesson&&game.tutorial.selectedJungle(e),"JungleSummon"===game.tutorial.lesson&&game.tutorial.selectedJungleSummon(),"Passive"!==game.tutorial.lesson&&"Toggle"!==game.tutorial.lesson&&"Channel"!==game.tutorial.lesson&&"Cast"!==game.tutorial.lesson||game.tutorial.sourceBlink(e)),t},selectedTower:function(){$(".map .towers.enemy").removeClass("blink").off("select"),game.audio.play("tutorial/axeah"),game.tutorial.lesson="Unselect",game.tutorial.axebaloon.hide().fadeIn("slow"),game.tutorial.letter(game.data.ui.axeunselect),game.states.table.enableUnselect()},unselected:function(){"Unselect"===game.tutorial.lesson&&(game.tutorial.lesson="",game.tutorial.creepLesson(),game.tutorial.axe.removeClass("fleft"))},creepLesson:function(){game.tutorial.lesson="Creep",game.tutorial.axebaloon.hide().delay(800).fadeIn("slow"),game.tutorial.letter(game.data.ui.axecreep),game.units.buyCreeps("player",!0),$(".player .sidehand .card").addClass("blink").on("select",game.tutorial.selected),game.audio.play("tutorial/axemove")},selectedCreep:function(a){game.tutorial.axebaloon.hide().fadeIn("slow"),a.hasClass("creep")&&game.tutorial.letter(game.data.ui.axesummoncreep),game.tutorial.letter(game.data.ui.axesummoncreep),$(".player .sidehand .card, .map .player.ld").on("summon cast",game.tutorial.summonedCreep)},summonedCreep:function(){"Move"!=game.tutorial.lesson&&(game.tutorial.lesson="Move",$(".map .heroes.player").addClass("blink can-move").on("move.tutorial",game.tutorial.moveCount).on("select",game.tutorial.select)),$(".map .units.blink").removeClass("blink"),game.tutorial.axebaloon.hide().fadeIn("slow"),game.player.skills.sidehand.children().length?game.tutorial.letter(game.data.ui.axesummonselect):game.tutorial.letter(game.data.ui.axeselectplayer),--game.tutorial.moveCountValue},moveLesson:function(){game.tutorial.axebaloon.hide().fadeIn("slow"),game.selectedCard.hasClass("heroes")&&game.tutorial.letter(game.data.ui.axemove),game.selectedCard.hasClass("units")&&game.tutorial.letter(game.data.ui.axesummoncreep)},moveCount:function(a,e){e.card.removeClass("blink"),game.states.table.skip.attr("disabled",!1),game.tutorial.letter(game.data.ui.axemoveagain),--game.tutorial.moveCountValue,game.tutorial.moveCountValue<3&&game.tutorial.endTurnLesson()},endTurnLesson:function(){$(".map .heroes.player").removeClass("blink can-move").off("move.tutorial"),$(".blink").removeClass("blink"),game.states.table.skip.addClass("blink"),game.tutorial.axebaloon.hide().fadeIn("slow"),game.tutorial.letter(game.data.ui.axeendturn),game.tutorial.axe.addClass("fleft")},skip:function(){$(".map .player.card").removeClass("can-move"),game.states.table.el.removeClass("turn"),game.currentTurnSide="enemy",game.turn.time.text(game.data.ui.time+": 1:30 "+game.data.ui.night),game.turn.msg.text(game.data.ui.turns+": 1/1 (2)"),$(".blink").removeClass("blink"),game.message.text(game.data.ui.enemyturn),game.tutorial.letter(game.data.ui.axedone),game.tutorial.axebaloon.fadeIn("slow"),game.loader.addClass("loading"),game.camera.addClass("night"),game.timeout(2e3,game.tutorial.enemyStart)},enemyStart:function(){game.currentTurnSide="enemy",game.turn.el.removeClass("show"),game.units.buyCreeps("enemy",!0),$(".map .heroes.enemy").addClass("can-move"),$(".enemy .ld-rabid").first().appendTo(game.enemy.skills.hand).addClass("flipped"),$(".enemy .wk-stun").first().appendTo(game.enemy.skills.hand).addClass("flipped"),$(".enemy .am-blink").first().appendTo(game.enemy.skills.hand).addClass("flipped"),game.timeout(2400,game.tutorial.openShop)},openShop:function(){var a=$(".table .shop .card.items.sheepstick");game.items.addMoney("player",a.data("price")),game.items.enableShop(),$(".table .shop .card.items").hide(),a.show().addClass("blink"),game.tutorial.letter(game.data.ui.axeshop),game.tutorial.axebaloon.hide().fadeIn("slow"),game.states.table.shop.addClass("blink")},buyItem:function(){$(".table .card.items.sheepstick").removeClass("blink"),$(".table .shop .card.items.sheepstick").hide()},hideShop:function(){$(".player .sidehand .card.items").length&&(game.items.disableShop(),game.states.table.shop.removeClass("blink"),game.timeout(1e3,game.tutorial.enemyMove),game.tutorial.axe.removeClass("fleft"))},enemyMove:function(){game.tutorial.axebaloon.hide().fadeIn("slow"),game.tutorial.letter(game.data.ui.axeenemymove),game.message.html(game.data.ui.enemymove);var a=$("#G6").firstFreeSpotInLine($("#G5"),8).getPosition(),a=["M:"+game.map.mirrorPosition("E1")+":"+game.map.mirrorPosition("E3"),"C:"+game.map.mirrorPosition("E3")+":"+game.map.mirrorPosition("E4")+":ld:bear","C:"+game.map.mirrorPosition("G1")+":"+game.map.mirrorPosition(a)+":am:blink","S:"+game.map.mirrorPosition("K5")+":melee"].join("|");game.enemy.autoMove(a,game.tutorial.endTurn)},endTurn:function(){game.camera.removeClass("night"),game.turn.time.text(game.data.ui.time+": 1:30 "+game.data.ui.day),$(".spot").removeClass("free"),game.turn.el.text(game.data.ui.playerturn).addClass("show"),game.tutorial.axebaloon.hide(),game.audio.play("tutorial/axewait"),$(".map .heroes.enemy").removeClass("can-move"),game.timeout(2e3,game.tutorial.useItem)},useItem:function(){game.currentTurnSide="player",game.turn.msg.text(game.data.ui.turns+": 2/1 (3)"),game.enemy.skills.deck.removeClass("slide"),game.turn.el.removeClass("show"),game.states.table.el.addClass("turn"),game.message.text(game.data.ui.yourturn),game.card.unselect(),$(".table .card.items.sheepstick").addClass("blink").on("cast.tutorial",game.tutorial.itemCast),game.tutorial.axebaloon.fadeIn("slow"),game.tutorial.letter(game.data.ui.axeuseitem)},itemCast:function(){$(".table .card.items.sheepstick").off("cast.tutorial"),game.timeout(400,game.tutorial.attack)},attack:function(){game.tutorial.lesson="Attack",$(".map .player.heroes, .map .player.units").addClass("can-move can-attack"),$(".map .player.heroes, .map .player.units").each(function(a,e){var t=$(e),e=t.data("range");t.around(e,function(a){a.find(".card.enemy").length&&t.addClass("blink")})}),game.tutorial.axebaloon.fadeIn("slow"),game.tutorial.letter(game.data.ui.axeattack),game.audio.play("tutorial/axeattack"),$(".map .player.heroes, .map .player.units").on("attack.tutorial",function(){game.card.unselect(),$(".map .player.heroes, .map .player.units").off("attack.tutorial"),game.timeout(100,game.tutorial.passiveLesson)})},passiveLesson:function(){game.tutorial.lesson="Passive",$(".map .player").removeClass("blink");var a=$(".player .available.skills .lina-passive"),e=$(".map .player.heroes.lina");a.first().appendTo(game.player.skills.sidehand).addClass("blink").on("select",game.tutorial.selected),e.on("passive.tutorial",game.tutorial.jungleLesson),game.tutorial.axebaloon.hide().fadeIn("slow"),game.tutorial.letter(game.data.ui.axeskillselect)},sourceBlink:function(a){a.card.data("source")&&$("#"+a.card.data("source")).addClass("blink")},selectedPassive:function(){game.tutorial.axebaloon.hide().fadeIn("slow"),game.tutorial.letter(game.data.ui.axeskill)},jungleLesson:function(){game.tutorial.lesson="Jungle",$(".blink").removeClass("blink");$(".map .player.heroes.en").addClass("blink");game.tutorial.axebaloon.hide().fadeIn("slow"),game.tutorial.letter(game.data.ui.axejungle)},selectedJungle:function(a){$(".blink").removeClass("blink"),a.card.hasAllClasses("en player heroes")&&($("#B2").addClass("tutorialmovearea blink").on("mouseup.tutorial",game.tutorial.jungleSummonLesson),game.tutorial.axebaloon.hide().fadeIn("slow"),game.tutorial.letter(game.data.ui.jungleSummonLesson))},jungleSummonLesson:function(){var a=$(".map .player.heroes.en"),e=$(".player .available.skills .en-curse"),t=$(this);a.hasClass("selected")&&(game.tutorial.lesson="JungleSummon",$("#A1").addClass("free"),$("#B2").removeClass("tutorialmovearea blink").off("mouseup.tutorial"),$(".map .player.heroes.en").place(t).removeClass("can-move"),e.first().appendTo(game.player.skills.hand).addClass("blink").on("select",game.tutorial.selected),a.on("cast.tutorial",game.tutorial.toggleLesson),game.tutorial.axebaloon.hide().fadeIn("slow"),game.tutorial.letter(game.data.ui.axesummonjungle))},selectedJungleSummon:function(){$("#A1").addClass("blink")},toggleLesson:function(){game.tutorial.lesson="Toggle",$(".blink").removeClass("blink"),$(".map .player.heroes.en").off("cast.tutorial"),$(".player .available.skills .pud-rot").first().appendTo(game.player.skills.sidehand).addClass("blink").on("select",game.tutorial.selected),game.tutorial.axebaloon.hide().fadeIn("slow"),game.tutorial.letter(game.data.ui.axetoggle),$(".map .player.pud").on("toggle.tutorial",game.tutorial.toggleOffLesson)},toggleOffLesson:function(){game.tutorial.lesson="ToggleOff",$(".map .player.pud").off("toggle.tutorial").on("toggle.tutorialOff",game.tutorial.castLesson),game.tutorial.axebaloon.hide().fadeIn("slow"),game.tutorial.letter(game.data.ui.axetoggleoff),game.timeout(1e3,function(){$(".map .player.pud").addClass("blink"),$(".player .skills .pud-rot").select()})},castLesson:function(){$(".map .player.pud").off("toggle.tutorialOff"),game.tutorial.lesson="Cast",$(".blink").removeClass("blink"),card=$(".player .available.skills .am-blink"),hero=$(".map .player.am"),card.first().appendTo(game.player.skills.hand).addClass("blink").on("select",game.tutorial.selected),hero.on("cast.tutorial",game.tutorial.channelLesson),game.tutorial.axebaloon.hide().fadeIn("slow"),game.tutorial.letter(game.data.ui.axecast),$(".spot").each(function(a,e){$(".card",e).length||$(e).addClass("free")})},channelLesson:function(){game.tutorial.lesson="Channel",$(".blink").removeClass("blink");var a=$(".playerdecks .skills .cm-ult"),e=$(".map .player.cm").addClass("can-move");a.first().appendTo(game.player.skills.hand).addClass("blink").on("select",game.tutorial.selected),e.on("cast.tutorial",game.tutorial.casted),game.tutorial.axebaloon.hide().fadeIn("slow"),game.tutorial.letter(game.data.ui.axechannel)},casted:function(){$(".playerdecks .skills .cm-ult").hide(),game.timeout(5e3,game.tutorial.end)},surrender:function(){game.clear(),game.states.changeTo("menu")},end:function(){game.tutorial.axebaloon.hide().fadeIn("slow"),game.tutorial.letter(game.data.ui.axeend),game.audio.play("tutorial/axeah"),game.winner=game.player.type,game.player.points+=1,game.setData("points",game.player.points),game.setData("tutorial","done"),game.states.changeTo("result")},clear:function(){$(".table .blink").removeClass("blink"),$(".table .card.items").show(),game.tutorial.lesson="",game.tutorial.started=!1,game.states.choose.back.attr("disabled",!1),game.tutorial.axe&&(game.tutorial.axe.appendTo(game.states.choose.el),game.tutorial.axe.removeClass("up"),game.tutorial.axe.removeClass("left fleft"),game.tutorial.axebaloon.hide())}},game.achievements={build:function(){this.el=$("<div>").addClass("achievements").appendTo(game.container).on("mouseup tap touchend",this.clear.bind(this))},update:function(a){var e=$("<h1>").text(" "+a.title),a=$("<p>").text(a.description);this.el.html("").append(e,a).addClass("slide"),setTimeout(this.clear.bind(this),4e3)},clear:function(){this.el.removeClass("slide")}},game.chat={build:function(a){game.chat.builded||(game.chat.builded=!0,game.chat.el=$("<div>").addClass("chat").appendTo(document.body).html("<h1>Chat </h1>").hover(game.chat.hover),game.chat.dis=$("<div>").appendTo(game.chat.el).addClass("dis"),$('<iframe src="https://discordapp.com/widget?id=208322860333268993&theme=dark&username='+game.player.name+'" width="350" height="400" allowtransparency="true" frameborder="0">').appendTo(game.chat.dis)),game.chat.el.show()}},game.events={build:function(){$.fn.extend({clearEvents:game.events.clearEvents,getScale:game.events.getScale}),game.deck.extendjQuery(),game.card.extendjQuery(),game.buff.extendjQuery(),game.skill.extendjQuery(),game.highlight.extendjQuery(),game.map.extendjQuery(),game.screen.resize(),$(window).on("resize",game.screen.resize),$(window).on("error",game.events.error),$(window).on("keypress",game.events.keyboard),$(window).on("beforeunload ",game.events.leave),$(window).on("mousemove",game.parallax.move),$(window).on("deviceorientation",game.parallax.orientation),game.container.on("mousedown",game.events.hit),game.container.on("touchstart",game.events.hit),game.container.on("mousemove",game.events.move),game.container.on("touchmove",game.events.touchmove),game.container.on("touchend touchleave",game.events.touchend),game.container.on("mouseup mouseleave tap",game.events.end),game.container.on("contextmenu",game.events.rightclick),game.container.on("click tap",".button, .card",game.events.click),window.addEventListener("beforeinstallprompt",function(a){a.preventDefault(),game.events.deferredPrompt=a})},getCoordinates:function(a){var e,t={left:a.clientX,top:a.clientY};return a.originalEvent&&a.originalEvent.changedTouches&&(e=a.originalEvent.changedTouches.length-1,t.left=a.originalEvent.changedTouches[e].clientX,t.top=a.originalEvent.changedTouches[e].clientY),t},hit:function(a){var e,t,s=$(a.target).closest(".card");s&&s.hasClass("draggable")&&(e=game.events.getCoordinates(a),t=s.offset(),a="",s.closest(".map").length&&(a=" fromMap"),(s.closest(".hand").length||s.closest(".sidehand").length)&&(a+=" fromHand"),game.offset=game.container.offset(),game.events.dragTarget=s,game.events.draggingPosition=e,game.events.dragClone=s.clone().removeClass("dragTarget").addClass("hidden dragTargetClone "+game.currentState+a).appendTo(game.container),game.events.dragScale=s.getScale(),game.events.dragOffset={left:(e.left-t.left)/game.events.dragScale,top:(e.top-t.top)/game.events.dragScale})},touchmove:function(a){game.events.move.call(this,a),a.preventDefault&&a.preventDefault()},move:function(a){var e,t;!game.events.dragTarget||(((t=game.events.getCoordinates(a)).left<game.events.draggingPosition.left-2||t.top<game.events.draggingPosition.top-2)&&(t.left>game.events.draggingPosition.left+2||t.top>game.events.draggingPosition.top+2)||game.events.dragging)&&(game.events.dragging=!0,e=game.events.dragClone.getScale(),a=game.container.getScale(),game.events.dragClone.hasClass("fromMap")&&(e=1),game.events.dragTarget.addClass("dragTarget"),game.events.dragClone.css({left:(t.left-game.offset.left-game.events.dragOffset.left*e)/a+"px",top:(t.top-game.offset.top-game.events.dragOffset.top*e)/a+"px"}),setTimeout(function(){game.events.dragClone.removeClass("hidden")},80),t=$(document.elementFromPoint(t.left,t.top)),$(".drop").removeClass("drop"),t.hasClasses("slot picked targetarea casttarget movearea attacktarget")&&(game.events.dragClone.addClass("drop"),t.addClass("drop")))},touchend:function(a){a=game.events.getCoordinates(a),a=$(document.elementFromPoint(a.left,a.top));a.is("input, label *, select, form *, .options *")||a.mouseup()},end:function(a){target=$(a.target),target.closest(".chat").length||$(".chat").removeClass("hover"),game.events.dragging&&($(".dragTarget").removeClass("dragTarget"),$(".drop").removeClass("drop")),$(".dragTargetClone").remove(),game.events.dragging=!1,game.events.dragTarget=null},clearEvents:function(a){var e="mousedown mouseup touchstart touchend mouseover mouseleave";return a?(a="."+a+" ",a=e.split(" ").join(a)+a,this.off(a)):this.off(e),this},cancel:function(a){return a&&a.preventDefault&&a.preventDefault(),!1},leave:function(){if("online"==game.mode)return game.data.ui.leave},getScale:function(){var a=$(this).css("transform").split("(")[1],e=1;return a&&a.split&&(e=a.split(",")[0]),Number(e)},keyboard:function(a){32==a.keyCode&&game.states.table.skipClick(),43==a.keyCode&&game.options.keyboard(),13==a.keyCode&&$(".chat").toggleClass("hover")},click:function(){var a=$(this);a.attr("disabled")||(a.attr("disabled",!0),setTimeout(function(a){a.attr("disabled",!1)}.bind(this,a),300))},rightclick:function(a){return game.card.unselect(),game.events.cancel(a),!1},error:function(a){a=a.originalEvent,a=a.message+" "+a.filename+" "+a.lineno+":"+a.colno;game.overlay.error(a,function(){game.clear(),game.setData("state","menu"),location.reload(!0)})}},game.history={build:function(){game.history.last=game.getData("last-activity"),game.history.state=game.getData("state"),game.history.mode=game.getData("mode"),game.history.size=game.getData("size"),game.history.seed=game.getData("seed")},isSupported:function(a){try{var e="__some_key_you_are_not_going_to_use__";return window[a].setItem(e,e),window[a].removeItem(e),!0}catch(a){return!1}},recover:function(){game.audio.rememberVolume();var a=game.history.mode,e=game.history.state,t=game.states.validState(e),s=game.getData("name"),n=!0===game.getData("logged"),i=(new Date).valueOf()-game.history.last<2592e6,i=n&&s&&t&&i;game.player.name=s,i&&"log"!=e&&"loading"!=e?(game.options.opt.show(),game.states.log.out.show(),game.debug||"choose"==e&&"library"==a?game.history.jumpMode(a,e,i):game.history.jumpTo("menu",i)):game.states.changeTo("log")},jumpMode:function(a,e,t){"result"==e&&(a=!1,e="menu"),a&&(game.recovering=!0,game.history.match(a,t),game.history.picks()),game.history.jumpTo(e,t)},jumpTo:function(a,e){game.setData("last-activity",(new Date).valueOf());a={state:a,recover:e};game.debug?game.history.change.call(a,!0):(e=game.data.ui.welcome+" "+game.getData("name")+"! "+game.data.ui.log+"?",game.overlay.confirm(game.history.change.bind(a),e))},change:function(a){var e=this.state,t=this.recover;a?(game.history.rank(),"campaign"==this.state&&(game.states.build("campaign"),game.history.campaign()),game.chat.build(game.data.ui.reconnected),"AudioContext"in window&&game.audio.build(),game.states.changeTo(e,t)):game.states.changeTo("log")},campaign:function(){var a=game.getData("stage")||"start";if(game.states.campaign.stage=game.data.campaign[a],game.states.campaign.buildDesc(game.states.campaign.stage),game.getData("campaignDone"))game.states.campaign.done=!0,game.states.campaign.enableAllStages();else{game.states.campaign.lane=game.getData("lane")||["m","m"];var e=["start","easy","normal","hard","last"],t=e.indexOf(a);if(0<t)for(var s=1;s<=t;s++){var n=e[s];game.states.campaign[n+"Show"]()}}},match:function(a,e){game.setMode(a,e),game.states.config.size(game.history.size),game.seed=game.history.seed,game.setData("seed",game.seed),game.states.vs.buildMap()},rank:function(){var a=game.getData("points");"number"==typeof a&&(game.player.points=a)},picks:function(){var a=game.getData(game.player.type+"Deck");a&&(game.player.picks=a.split("|"));a=game.getData(game.enemy.type+"Deck");a&&(game.enemy.picks=a.split("|"))},saveMove:function(a){var e=game.getData("matchData");(e=e||[]).push(a),game.setData("matchData",e)},recoverMatch:function(){game.getData("challenged")==game.player.name?(game.player.type="challenged",game.enemy.type="challenger",game.currentTurnSide="player"):(game.player.type="challenger",game.enemy.type="challenged",game.currentTurnSide="enemy"),game.player.picks||(game.player.picks=game.getData(game.player.type+"Deck").split("|")),game.skill.calcMana("player"),game.enemy.picks||(game.enemy.picks=game.getData(game.enemy.type+"Deck").split("|")),game.skill.calcMana("enemy"),game.units.build("player"),game.units.build("enemy"),game[game.mode].setTable(),game.turn.el.text("Recovering").addClass("show"),setTimeout(function(){game.enemy.autoMove(game.getData("matchData"),function(){game.recovering=!1,game.turn.el.removeClass("show")})},1400)}},game.overlay={build:function(){game.overlay.el=$("<div>").addClass("game-overlay hidden").appendTo(game.container),game.overlay.el.on("click tap",function(a){a.target==game.overlay.el[0]&&(game.overlay.cb&&(game.overlay.cb(),game.overlay.cb=!1),game.overlay.clear())})},alert:function(a,e){var t=$("<div>").addClass("box");game.overlay.cb=e,game.overlay.el.removeClass("hidden").append(t),t.append($("<h1>").text(game.data.ui.warning)),t.append($("<p>").text(a)),t.append($("<div>").addClass("button").text(game.data.ui.ok).on("mouseup touchend",function(){return $(this).parent().remove(),game.overlay.el.children().length||game.overlay.clear(),e&&e(!0),!1}))},confirm:function(a,e,t){t=$("<div>").addClass("box "+(t||""));game.overlay.cb=a,game.overlay.el.removeClass("hidden").append(t),t.append($("<h1>").text(e||game.data.ui.sure));e=function(){return $(this).parent().remove(),game.overlay.el.children().length||game.overlay.clear(),a($(this).hasClass("alert")),!1};t.append($("<div>").addClass("button alert").text(game.data.ui.yes).on("mouseup touchend",e)),t.append($("<div>").addClass("button").text(game.data.ui.no).on("mouseup touchend",e))},error:function(a){var e=$("<div>").addClass("box error");game.overlay.el.removeClass("hidden").append(e);var t="Error",s="Reload",n="Ok";game.data.ui&&(t=game.data.ui.error,s=game.data.ui.reload,n=game.data.ui.ok),e.append($("<h1>").text(t)),e.append($("<p>").html(a+"<br>"+s)),e.append($("<div>").addClass("button alert").text(n).on("mouseup touchend",function(){location.reload()})),game.overlay.logError(a)},logError:function(a){game.debug||("string"!=typeof a&&(a=JSON.stringify(a)),a+=" "+(new Date).toDateString(),game.db({set:"errors",data:a}))},clear:function(){game.overlay.el.empty(),game.overlay.el.addClass("hidden"),game.overlay.cb=!1}},game.parallax={move:function(a){var e;clearTimeout(game.iddleTimeout),"log"!=game.currentState&&"menu"!=game.currentState&&"vs"!=game.currentState&&"result"!=game.currentState||(e=a.clientX,a=a.clientY,a=50+.01*(e-window.innerWidth/2)+"% "+(50+.01*(a-window.innerHeight/2))+"%",game.states[game.currentState].parallax.removeClass("iddle").css("perspective-origin",a),game.iddleTimeout=setTimeout(function(){$(".parallax").addClass("iddle")},8e3))},orientation:function(a){var e;clearTimeout(game.iddleTimeout),"log"!=game.currentState&&"menu"!=game.currentState&&"vs"!=game.currentState&&"result"!=game.currentState||(e={x:-a.originalEvent.gamma,y:-a.originalEvent.beta},window.innerHeight<window.innerWidth&&(e.x=a.originalEvent.beta,e.y=-a.originalEvent.gamma),e.x=Math.min(Math.max(e.x,-50),50),e.y=Math.min(Math.max(e.y,-50),50),e.x=(e.x+90)/180*100,e.y=(e.y+90)/180*100,e.x=Math.min(Math.max(e.x,20),80),e.y=Math.min(Math.max(e.y,20),80),e=e.x+"% "+e.y+"%",game.states[game.currentState].parallax.removeClass("iddle").css("perspective-origin",e),game.iddleTimeout=setTimeout(function(){$(".parallax").addClass("iddle")},8e3))}},game.poll={heroes:{inv:"Invoker",rub:"Rubik"},build:function(){for(var a in game.poll.voteBox=game.overlay.el.children().first().addClass("vote").html(""),game.poll.title=$("<h2>").text(game.data.ui.votenexthero).appendTo(game.poll.voteBox),game.poll.voteList=$("<p>").appendTo(game.poll.voteBox),game.poll.heroes)game.poll.addVote(a,game.poll.heroes[a]);game.poll.voteBt=$("<div>").addClass("button highlight").appendTo(game.poll.voteBox).attr({disabled:!0}).text(game.data.ui.vote).on("mouseup touchend",game.poll.vote),game.poll.closeBt=$("<div>").addClass("button").appendTo(game.poll.voteBox).text(game.data.ui.close).on("mouseup touchend",game.poll.close)},showVotes:function(){return game.poll.build(),game.states.log.input.val()||game.states.log.input.focus(),!1},addButton:function(){},addVote:function(a,e){game.poll[a]=$("<label>").appendTo(game.poll.voteList).append($("<img>").attr({src:game.imageServer+"/poll/"+a+".jpg"})).append($("<p>").append($("<input>").attr({type:"radio",name:"nexthero",value:a})).append($("<span>").text(e))).on("mouseup touchend",game.poll.enableVote).on("touchstart",function(){$(this).click()})},enableVote:function(){var a=$(this);return a.attr("disabled")||($("label",game.poll.voteBox).removeClass("voted"),a.addClass("voted"),game.poll.voteBt.attr({disabled:!1}).addClass("voteBt")),!1},vote:function(){var a;$(this);return game.poll.voteBt.attr("disabled")||($("label, input",game.poll.voteBox).attr("disabled",!0),game.poll.voteBt.attr("disabled",!0),a=$("input[name=nexthero]:checked",".vote"),game.poll.votedHero=a.val(),game.db({set:"poll",data:game.poll.votedHero},game.poll.voted)),!1},voted:function(a){game.setData("voted",game.poll.votedHero),game.poll[game.poll.votedHero]&&game.poll[game.poll.votedHero].addClass("vote-send"),game.poll.title.text(game.data.ui.thanksvote),a&&$.each(a,function(a,e){game.poll[a]&&$("span",game.poll[a]).after($("<span>").addClass("votes").text(e))})},close:function(){return game.overlay.clear(),setTimeout(function(){game.states.log.box.fadeIn()},200),!1}},game.rank={min:0,build:function(){this.el=$("<div>").appendTo(game.states.menu.el).addClass("rank"),this.title=$("<h1>").appendTo(this.el).text("WANTED"),this.list=$("<ol>").appendTo(this.el).addClass("hidden")},send:function(){!game.debug&&game.player.points>game.rank.min&&game.db({set:"rank",data:{name:game.player.name,points:game.player.points}},game.rank.update),50<game.player.points&&!game.debug&&$.ajax({type:"POST",url:"https://play.idevgames.co.uk/send/score.php",data:{scoreboardKey:"meaHKmMadVCwTQJKD8aYnaYZ",name:game.player.name,score:game.player.points}})},sortData:function(a){var t=[];return $.each(a,function(a,e){t.push({name:a,points:e})}),t.sort(function(a,e){return e.points-a.points}),t.length&&(game.rank.min=t[t.length-1].points),t},update:function(a){a=game.rank.sortData(a);5!=a.length&&(a=[{name:"Player 1",points:99},{name:"Player 2",points:80},{name:"Player 3",points:70},{name:"Player 4",points:60},{name:"Player 5",points:50}]),game.rank.results=a,game.rank.list.html("").removeClass("hidden"),$.each(a,function(a,e){game.rank.list.append($("<li>").html("<span>"+e.name+" </span><span>"+e.points+"</span>"))})}},game.timeout=function(a,e,t){game.recovering&&(a=parseInt(a/5));var s=setTimeout(function(a){e(a),game.timeoutArray.erase(s)},a,t);return game.timeoutArray.push(s),s},game.clearTimeouts=function(){for(var a=0;a<game.timeoutArray.length;a++)clearTimeout(game.timeoutArray[a]);game.timeoutArray=[]},game.utils=function(){Number.prototype.map||(Number.prototype.map=function(a,e,t,s){return t+(this-a)/(e-a)*(s-t)}),Number.prototype.limit||(Number.prototype.limit=function(a,e){return Math.min(e,Math.max(a,this))}),Number.prototype.round||(Number.prototype.round=function(a){return Math.round(this)}),Number.prototype.floor||(Number.prototype.floor=function(){return Math.floor(this)}),Number.prototype.ceil||(Number.prototype.ceil=function(){return Math.ceil(this)}),Number.prototype.toRad||(Number.prototype.toRad=function(){return this/180*Math.PI}),Number.prototype.toDeg||(Number.prototype.toDeg=function(){return 180*this/Math.PI}),Array.prototype.random||(Array.prototype.random=function(){return this[Math.floor(Math.random()*this.length)]}),Array.prototype.smartRandom||(Array.prototype.smartRandom=function(a){return this[Math.floor(Math.pow(Math.random(),a)*this.length)]}),Array.prototype.shuffle||(Array.prototype.shuffle=function(){if(this.length)for(var a,e,t=this.length;t;)e=Math.floor(Math.random()*t),a=this[--t],this[t]=this[e],this[e]=a;return this}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a,e){var t;if(null===this)throw new TypeError('"this" is null or not defined');var s=Object(this),n=s.length>>>0;if(0==n)return-1;e=+e||0;if(Math.abs(e)===1/0&&(e=0),n<=e)return-1;for(t=Math.max(0<=e?e:n-Math.abs(e),0);t<n;){if(t in s&&s[t]===a)return t;t++}return-1}),Array.prototype.erase||(Array.prototype.erase=function(a){for(var e=this.length-1;-1<e;--e)this[e]===a&&this.splice(e,1);return this}),Function.prototype.bind||(Function.prototype.bind=Function.prototype.bind||function(e){var t=this;return function(){var a=Array.prototype.slice.call(arguments);return t.apply(e||null,a)}}),$.fn.hasClasses=function(a){for(var e=a.split(" "),t=0;t<e.length;t+=1)if(this.hasClass(e[t]))return!0;return!1},$.fn.hasAllClasses=function(a){for(var e=a.split(" "),t=0;t<e.length;t+=1)if(!this.hasClass(e[t]))return!1;return!0},"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(a){"use strict";if(null===a)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(a),t=1;t<arguments.length;t++){var s=arguments[t];if(null!==s)for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},writable:!0,configurable:!0}),String.prototype.capitalize||(String.prototype.capitalize=function(){return this[0].toUpperCase()+this.slice(1)})},game.audio={defaultVolume:.5,defaultSounds:.25,defaultMusic:.25,build:function(){game.audio.context=new AudioContext,game.audio.volumeNode=game.audio.context.createGain(),game.audio.soundsNode=game.audio.context.createGain(),game.audio.musicNode=game.audio.context.createGain(),game.audio.soundsNode.connect(game.audio.volumeNode),game.audio.musicNode.connect(game.audio.volumeNode),game.audio.volumeNode.connect(game.audio.context.destination),game.audio.loadMusic(),game.audio.loadSounds(),game.audio.rememberVolume()},buffers:{},load:function(e,t){var a=new XMLHttpRequest;a.open("GET",game.audioServer+"/"+e+".mp3",!0),a.responseType="arraybuffer",a.onload=function(){game.audio.context.decodeAudioData(a.response,function(a){game.audio.buffers[e]=a,t&&t()})},a.send()},sounds:["activate","crit","horn","battle","pick","move","items/bkb","items/blademail","items/buckler","items/linken","items/lotus","items/medallion","items/meka","items/refresher","items/soul","tower/attack","tutorial/axehere","tutorial/axebattle","tutorial/axemove","tutorial/axeattack","tutorial/axetime","tutorial/axewait","tutorial/axeah","am/attack","am/burn","am/blink","am/ult","cat/attack","cat/leap","cat/arrow","cat/arrowhit","cat/star","cat/ult","com/attack","com/aoe","com/heal","com/counter","com/ult","com/ultvictory","cm/attack","cm/freeze","cm/slow","cm/ult","en/attack","en/curse","en/heal","en/ult","ld/attack","ld/bear","ld/roar","ld/cry","ld/rabid","ld/bearreturn","ld/transform","ld/ult","kotl/attack","kotl/illuminate","kotl/illuminaterelease","kotl/leak","kotl/mana","kotl/recall","kotl/recallend","kotl/ult","kotl/blind","nyx/attack","nyx/stun","nyx/burn","nyx/spike","nyx/ult","nyx/ultattack","bear/attack","bear/entangle","pud/attack","pud/hook","pud/rot","pud/ult","pud/ult-channel","wk/attack","wk/stun","wk/ult","lina/attack","lina/fire","lina/stun","lina/ult","venge/attack","venge/corruption","venge/stun","venge/ult","wind/attack","wind/run","wind/stun","wind/stunhit","wind/arrow","wind/ult","crit"],loadSounds:function(){$(game.audio.sounds).each(function(a,e){game.audio.load(e)})},musics:["RandomEncounter","Perspectives","DeathandAxes"],loadMusic:function(){$(game.audio.musics).each(function(a,e){game.audio.load("music/"+e)}),game.audio.song="SneakyAdventure",game.audio.load("music/"+game.audio.song,function(){"loading"!=game.currentState&&"table"!=game.currentState&&"vs"!=game.currentState&&"log"!=game.currentState&&setTimeout(game.audio.loopSong,1e3)})},loopSong:function(a){(a&&a!==game.audio.song||!game.audio.loopingSong)&&(a&&(game.audio.song=a),game.audio.play(a||game.audio.song,!0,"music"))},sources:[],play:function(a,e,t,s){if(!game.audio.context&&"AudioContext"in window&&(game.audio.context=new AudioContext),t&&(a="music/"+a),game.audio.context&&game.audio.context.createBufferSource&&game.audio.buffers[a]&&game.audio.buffers[a].duration){var n=game.audio.context.createBufferSource();return n.buffer=game.audio.buffers[a],t?((game.audio.songSource=n).connect(game.audio.musicNode),e&&(game.audio.loopingSong=!0)):n.connect(game.audio.soundsNode),(game.audio.sources[a]=n).loop=e,game.recovering||(n.start(),n.started=!0),s&&setTimeout(s,1e3*game.audio.buffers[a].duration),n}},stop:function(a){a=game.audio.sources[a];a&&a.started&&!game.recovering&&a.stop()},stopSong:function(){var a=game.audio.songSource;a&&(game.audio.loopingSong=!1,a&&a.started&&!game.recovering&&a.stop())},mute:function(){var a=game.audio.unmutedvolume||game.audio.volumeNode.gain.value||game.audio.defaultVolume;this.checked&&(a=0),game.audio.setVolume("volume",a)},setVolume:function(a,e){null==e&&(e=game.audio.defaultVolume,"music"==a&&(e=game.audio.defaultMusic),"sounds"==a&&(e=game.audio.defaultSounds));e=parseFloat(e);e<=0?(e=0,"volume"===a&&game.options.muteinput.prop("checked",!0)):"volume"===a&&(game.audio.unmutedvolume=e,game.options.muteinput.prop("checked",!1)),1<e&&(e=1),"number"==typeof e&&isFinite(e)&&(game.audio[a+"Node"]&&game.audio[a+"Node"].gain.setTargetAtTime(e,game.audio.context.currentTime+1,.1),game.options[a+"control"]&&game.options[a+"control"].css("transform","scale("+e+")"),game.setData(a,e))},rememberVolume:function(){var a=game.getData("volume");null==typeof a&&(a=game.audio.defaultVolume),game.audio.setVolume("volume",a);a=game.getData("music");null==typeof a&&(a=game.audio.defaultMusic),game.audio.setVolume("music",a);a=game.getData("sounds");null==typeof a&&(a=game.audio.defaultSounds),game.audio.setVolume("sounds",a)},volumeMouseDown:function(a){var e=$(a.target).closest(".volume").attr("id");game.audio.volumetarget=e,game.audio.volumeMouseMove(a),game.options[e+"input"].on("mousemove.volume",game.audio.volumeMouseMove)},volumeMouseUp:function(){game.audio.volumetarget&&(game.options[game.audio.volumetarget+"input"].off("mousemove.volume"),game.audio.volumetarget=!1)},volumeMouseMove:function(a){game.screen.scale;a=a.clientX-game.options.volumecontrol.offset().left,a=parseInt(a/game.screen.scale,10)/100;game.audio.volumetarget&&game.audio.setVolume(game.audio.volumetarget,a)},volumeControl:function(a){game.options[a+"control"]=$("<div>").addClass("volumecontrol"),game.options[a+"input"]=$("<div>").addClass("volume").attr("id",a).append(game.options[a+"control"]),$("<label>").appendTo(game.options.audio).append($("<span>").text(game.data.ui[a])).append(game.options[a+"input"])}},game.language={current:"en-US",available:["en-US","pt-BR","es","tr-TR","ru"],names:["English US","Portugus BR","Espaol ES","Trk TR","P RU"],dir:"",load:function(e){var a=game.getData("lang");a?(game.language.set(a),e&&e()):game.db({get:"lang"},function(a){a.lang&&(a=a.lang.split(";")[0].split(",")[0],0<(a=game.language.available.indexOf(a))&&(a=game.language.available[a],game.language.set(a))),e&&e()})},set:function(a){0<game.language.available.indexOf(a)&&($("html").attr("lang",a),game.language.current=a,game.language.dir=a+"/",game.setData("lang",a))},select:function(){var t=$("<select>").on("change",game.language.click);return $(game.language.available).each(function(a,e){$("<option>").val(e).text(game.language.names[a]).appendTo(t).attr("selected",e==game.getData("lang"))}),t},click:function(){var a=$(this).val();detectLanguage=game.language.available.indexOf(a),0<=detectLanguage&&game.setData("lang",a),game.options.backClick(),game.overlay.confirm(function(a){a&&location.reload()})}},game.options={build:function(){this.opt=$("<small>").addClass("opt").hide().text(game.data.ui.options+" ").appendTo(game.topbar).attr("title",game.data.ui.chooseoptions).on("mouseup touchend",game.options.show),this.box=$("<div>").addClass("box optbox"),this.title=$("<h1>").appendTo(this.box).text(game.data.ui.options),this.row=$("<div>").appendTo(this.box),this.screen=$("<div>").appendTo(this.row).addClass("screenresolution").append($("<h2>").text(game.data.ui.screenres)),this.auto=$("<label>").appendTo(this.screen).append($("<input>").attr({type:"radio",name:"resolution",value:"auto"})).append($("<span>").text(game.data.ui.auto)),this.high=$("<label>").appendTo(this.screen).append($("<input>").attr({type:"radio",name:"resolution",value:"high"})).append($("<span>").text(game.data.ui.high+" 1920x1080")),this.medium=$("<label>").appendTo(this.screen).append($("<input>").attr({type:"radio",name:"resolution",value:"medium"})).append($("<span>").text(game.data.ui.medium+" 1366x768")),this.default=$("<label>").appendTo(this.screen).append($("<input>").attr({type:"radio",name:"resolution",value:"default"})).append($("<span>").text(game.data.ui.default+" 1024x768")),this.low=$("<label>").appendTo(this.screen).append($("<input>").attr({type:"radio",name:"resolution",value:"low"})).append($("<span>").text(game.data.ui.low+" 800x600")),this.fullscreen=$("<input>").attr({type:"checkbox",name:"fullscreen",disabled:!0}),$("<label>").appendTo(this.screen).append(this.fullscreen).append($("<span>").text(game.data.ui.fullscreen)),this.side=$("<input>").attr({type:"checkbox",name:"side"}),$("<label>").appendTo(this.screen).append(this.side).append($("<span>").text(game.data.ui.leftmode)),game.getData("left-side")&&($(document.body).addClass("left-side"),this.side.prop("checked",!0)),this.flat=$("<input>").attr({type:"checkbox",name:"flat"}),$("<label>").appendTo(this.screen).append(this.flat).append($("<span>").text(game.data.ui.flat)),game.getData("flat-map")&&this.flat.prop("checked",!0),this.dark=$("<input>").attr({type:"checkbox",name:"dark"}),$("<label>").appendTo(this.screen).append(this.dark).append($("<span>").text(game.data.ui.dark)),game.getData("dark-theme")&&this.dark.prop("checked",!0),this.lang=$("<div>").appendTo(this.box).addClass("lang").attr({title:game.data.ui.lang}).append($("<h2>").text(game.data.ui.lang)),this.langSelect=game.language.select().appendTo(this.lang),this.audio=$("<div>").appendTo(this.row).addClass("audioconfig").append($("<h2>").text(game.data.ui.audioconfig)),this.muteinput=$("<input>").attr({type:"checkbox",name:"mute"}),$("<label>").appendTo(this.audio).append(this.muteinput).append($("<span>").text(game.data.ui.mute)),game.audio.volumeControl("volume"),game.audio.volumeControl("music"),game.audio.volumeControl("sounds"),$(document).on("mouseup.volume",game.audio.volumeMouseUp),this.back=$("<div>").addClass("back button").text(game.data.ui.back).on("mouseup touchend",this.backClick).appendTo(this.box),game.screen.rememberResolution(),game.screen.FSEvents()},events:function(){$("input[name=fullscreen]",".screenresolution").on("change",game.screen.toggleFS),$("input[name=side]",".screenresolution").on("change",game.screen.toggleSide),$("input[name=flat]",".screenresolution").on("change",game.screen.toggleFlat),$("input[name=dark]",".screenresolution").on("change",game.screen.toggleDark),$("input[name=resolution]",".screenresolution").on("change",game.screen.changeResolution),game.options.langSelect.on("change",game.language.click),$("input[name=mute]",".audioconfig").on("change",game.audio.mute),$(".volume",".audioconfig").on("mousedown.volume touchstart.volume",game.audio.volumeMouseDown),$(".option-state .game-overlay .box").on("mousemove.volume touchmove.volume",game.audio.volumeMouseMove)},show:function(){return game.overlay.el.removeClass("hidden"),game.overlay.el.append(game.options.box),game.overlay.cb=game.options.backClick,game.container.addClass("option-state"),game.screen.rememberResolution(),game.options.events(),!1},keyboard:function(){game.container.hasClass("option-state")?game.options.backClick():game.overlay.el.hasClass("hidden")&&game.options.show()},backClick:function(){return game.options.box.appendTo(game.hidden),game.container.removeClass("option-state"),game.overlay.el.children().length||game.overlay.el.addClass("hidden"),!1}},game.screen={width:970,height:600,scale:1,resolutions:["auto","low","high","medium","default"],resize:function(a){game.offset=game.container.offset();var e=1,t=document.body.offsetWidth,s=document.body.offsetHeight,n=t/s,e=game.screen.width/game.screen.height<n?s/game.screen.height:t/game.screen.width;n<.8&&(e*=1.26),(e=(.97*e).toFixed(2))<.5&&(e=.5),game.screen.scale=e,game.container.css("transform","translate3d(-50%, -50%, 0) scale("+e+")")},rememberResolution:function(){var a,e=game.getData("resolution");e&&-1<game.screen.resolutions.indexOf(e)&&(a=e),a?game.screen.setResotution(a):game.screen.setResotution("default")},setResotution:function(a){window.innerWidth<970*game.screen.scales[a]&&(a="auto"),$("input[name=resolution][value="+a+"]").attr("checked",!0),game.screen.changeResolution(a)},scales:{high:1.5,medium:1.2,default:1,low:.75},changeResolution:function(a){a&&"String"===a.constructor.name||(a=$("input[name=resolution]:checked",".screenresolution").val()||"default",game.screen.resolution=a),"auto"!==a&&(game.screen.scale=game.screen.scales[a]),game.container.removeClass(game.screen.resolutions.join(" ")).addClass(a),game.setData("resolution",a)},toggleFS:function(){BigScreen.enabled?BigScreen.toggle():game.options.fullscreen.attr("disabled",!0)},FSEvents:function(){BigScreen.enabled&&game.options.fullscreen.attr("disabled",!1),BigScreen.onenter=function(){game.options.fullscreen[0].checked=!0},BigScreen.onexit=BigScreen.onerror=function(){game.options.fullscreen[0].checked=!1}},toggleSide:function(){var a=$(".screenresolution input[name=side]").prop("checked");$(document.body).toggleClass("left-side",a),game.setData("left-side",a)},toggleFlat:function(){var a=$(".screenresolution input[name=flat]").prop("checked");game.map.el&&game.map.el.toggleClass&&game.map.el.toggleClass("flat",a),game.setData("flat-map",a)},detectDark:function(){var a=window.getComputedStyle(document.body)["background-color"];game.screen.dark="rgb(18, 23, 28)"==a,game.screen.dark&&"light"!==game.getData("dark-theme")&&game.setData("dark-theme","dark"),game.container.toggleClass("dark",game.screen.dark)},toggleDark:function(){game.screen.dark=$(".screenresolution input[name=dark]").prop("checked"),game.container.toggleClass("dark",game.screen.dark),game.setData("dark-theme",game.screen.dark?"dark":"light")}},game.skills.am={burn:{passive:function(a,e){e.selfBuff(a),e.on("pre-attack.am-burn",this.attack)},attack:function(a,e){var t=e.source,s=e.target,n=s.data("hero"),i=s.side(),o=s.data("mana")||0;i!=t.opponent()||t.data("miss-attack")||s.hasClass("bkb")||(e.bonus+=o,$("."+i+" .hand ."+n).randomCard().discard(),game.audio.play("am/burn"),game.fx.add("am-burn",s))}},mirror:{cast:function(a,e){e.hasBuff("mirror-passive")||e.selfBuff(a,"mirror-passive"),e.selfBuff(a,"mirror-counter"),e.on("casted",this.counter),game.fx.add("am-mirror",e)},counter:function(a,e){var t=e.source,s=e.target,e=e.skill;e.side()==s.opponent()&&(s.cast(e,t),game.fx.add("am-mirror",s))}},blink:{cast:function(a,e,t){t.hasClass("free")&&(game.fx.add("am-blink",e.parent()),game.timeout(200,e.place.bind(e,t)))}},ult:{cast:function(e,t,a){var s=e.data("aoe range");t.data("skill range bonus")&&(s+=t.data("skill range bonus"));t.opponent();var n=e.data("damage"),i=a.data("mana");a.alliesInRange(s,function(a){t.damage(n+i,a,e.data("damage type"))}),game.fx.add("am-ult",a),a.stopChanneling(),game.fx.shake()}}},game.skills.axe={taunt:{cast:function(e,t){game.fx.add("axe-taunt",t),t.selfBuff(e,"taunt-self").on("expire",this.expire);var a=e.data("aoe range"),s=[];t.opponentsInRange(a,function(a){game.timeout(400,a.attack.bind(a,t,"force")),a.addClass("taunted"),t.addBuff(a,e,"taunt-targets"),s.push(a.attr("id"))}),e.data("taunted",JSON.stringify(s))},expire:function(a,e){for(var t=e.buff,e=$("#"+t.data("source")),t=$("#"+t.data("skill")),s=JSON.parse(t.data("taunted")),n=0;n<s.length;n++){var i=s[n];$("#"+i).removeClass("taunted")}e.data("taunted",!1)}},enrage:{cast:function(a,e,t){game.fx.add("axe-enrage",t);a=e.addBuff(t,a);game.fx.add("axe-fire",t,a),e.damage(a.data("dot"),t,a.data("damage type")),a.on("buffcount",this.buffcount),a.on("expire",this.expire),t.on("kill.axe-enrage",this.expire)},buffcount:function(a,e){var t=e.target,s=e.buff,e=$("#"+s.data("source"));1!==s.data("duration")&&e.damage(s.data("dot"),t,s.data("damage type"))},expire:function(a,e){var t=e.source,e=e.buff;(t=t||$("#"+e.data("source"))).removeBuff("axe-enrage"),t.off("kill.axe-enrage")}},counter:{passive:function(a,e,t){e.selfBuff(a),e.on("attacked.axe-counter",this.counter)},counter:function(a,e){var t=e.source,s=e.target,n=s.getBuff("axe-counter"),e=n.data("chance")/100,i=$("#"+n.data("skill")),n=s.data("range");game.random()<e&&(game.fx.add("axe-counter",s),s.opponentsInRange(n,function(a){t.damage(i.data("damage"),a,i.data("damage type"))}))}},ult:{cast:function(a,e,t){game.fx.add("axe-ult",e,t,"flip"),t.data("current hp")<t.data("hp")/3?(e.damage(t.data("current hp")+t.data("current armor"),t,a.data("damage type")),game.timeout(350,game.fx.add.bind(this,"axe-ult-kill",e,t,"flip"))):e.damage(a.data("damage"),t,a.data("damage type")),game.timeout(600,function(){t.hasClass("dead")&&a.appendTo(game[a.side()].skills.hand).removeClass("casted")}),t.stopChanneling(),game.fx.shake()}}},game.skills.cat={arrow:{cast:function(a,e,t){var s=a.data("aoe range");e.data("skill range bonus")&&(s+=e.data("skill range bonus"));var n,i,o=a.data("distance damage bonus"),r=a.data("distance stun bonus"),d=a.data("damage"),l=e.firstCardInLine(t,s);game.timeout(50,game.fx.add.bind(this,"cat-arrow-source",e,t,"target",e.parent())),l&&l.side()==e.opponent()?(n=l.parent(),i=Math.abs(e.getX()-l.getX()||e.getY()-l.getY())-1,game.timeout(700,function(){game.fx.add("cat-arrow-impact",e,l),game.audio.play("cat/arrowhit"),l.shake(),l.hasClass("bkb")||e.addStun(l,a,i*r),e.damage(d+i*o,l,a.data("damage type"))})):n=e.lastSpotInLine(t,s),game.timeout(100,game.fx.add.bind(this,"cat-arrow",e,n,"target"))}},leap:{cast:function(a,e,t){e.selfBuff(a),e.move(t),game.timeout(50,game.fx.add.bind(this,"cat-leap",e.parent())),game.timeout(50,game.fx.add.bind(this,"cat-leap-path",e,t,"target")),game.timeout(150,game.fx.add.bind(this,"cat-leap",t))}},star:{cast:function(e,t){var a=e.data("cast range"),s=[];t.data("skill range bonus")&&(a+=t.data("skill range bonus")),t.opponentsInRange(a,function(a){a.hasClasses("cycloned invisible")||(game.fx.add("cat-star",t,a,"random"),game.timeout(900,t.damage.bind(t,e.data("damage"),a,e.data("damage type"))),s.push(a))}),s.length&&(a=s[Math.floor(game.random()*s.length)],game.timeout(900,function(a,e,t){game.fx.add("cat-star",a,e,"random"),game.timeout(900,a.damage.bind(a,t.data("damage"),e,t.data("damage type")))}.bind(this,t,a,e)))}},ult:{cast:function(e,t){var a=t.side();$(".map .heroes."+a+":not(.bkb)").each(function(){var a=$(this);t.addBuff(a,e).on("expire",game.skills.cat.ult.expire),a.addInvisibility(),a.on("invisibilityLoss",game.skills.cat.ult.end)}),game.timeout(400,game.fx.add.bind(this,"cat-ult",t.parent()))},end:function(a,e){e.target.removeBuff("cat-ult")},expire:function(a,e){e.target.removeInvisibility()}}},game.skills.cm={slow:{cast:function(e,t,a){var s=t.opponent(),n=e.data("aoe range");t.data("skill range bonus")&&(n+=t.data("skill range bonus")),game.fx.add("cm-slow",t,a),a.inRange(n,function(a){a=a.find(".card");a.hasClass(s)&&(game.timeout(900,t.damage.bind(t,e.data("damage"),a,e.data("damage type"))),a.hasClass("bkb")||t.addBuff(a,e))})}},passive:{passive:function(a,e){var t=e.side();game[t].cardsPerTurn+=1,e.on("death.cm-aura"),e.on("reborn.cm-aura"),e.selfBuff(a)},death:function(a,e){e=e.target.side();--game[e].cardsPerTurn},reborn:function(a,e){e=e.target.side();game[e].cardsPerTurn+=1}},freeze:{cast:function(a,e,t){t.addStack("rooted").addStack("disarmed").removeClass("can-attack"),t.stopChanneling();a=e.addBuff(t,a);e.damage(a.data("dot"),t,a.data("damage type")),a.on("buffcount",this.buffcount),a.on("expire",this.expire),game.timeout(400,game.fx.add.bind(this,"cm-freeze",e,t,"keep"))},buffcount:function(a,e){var t=e.target,s=e.buff,e=$("#"+s.data("source"));2!==s.data("duration")&&e.damage(s.data("dot"),t,s.data("damage type"))},expire:function(a,e){e=e.target;$(".fx.cm-freeze",e).addClass("reverse"),game.timeout(800,game.fx.stop.bind(this,"cm-freeze",e)),e.removeStack("rooted").removeStack("disarmed")}},ult:{cast:function(a,e){e.addClass("cm-ult"),e.selfBuff(a,"ult-source"),game.skills.cm.ult.damage(e,a),e.on("channel",this.channel),e.on("channelend",this.channelend)},channel:function(a,e){var t=e.source,e=e.skill;t.data("channeling")!==e.data("channel")&&(game.audio.play("cm/ult"),game.skills.cm.ult.damage(t,e))},damage:function(e,t){game.fx.shake();var a=t.data("aoe range");e.data("skill range bonus")&&(a+=e.data("skill range bonus")),e.opponentsInRange(a,function(a){game.timeout(900,e.damage.bind(e,t.data("damage"),a,t.data("damage type"))),a.hasClasses("bkb cycloned")||(e.addBuff(a,t,"ult-targets"),game.fx.add("cm-ult",e,a,"random"))})},channelend:function(a,e){e=e.source;e.removeClass("cm-ult"),e.removeBuff("cm-ult")}}},game.skills.com={aoe:{cast:function(e,t,a){var s=t.opponent(),n=e.data("damage"),i=e.data("aoe range");t.data("skill range bonus")&&(i+=t.data("skill range bonus")),a.inRange(i,function(a){a=a.find(".card");a.hasClass(s)&&(a.hasClass("units")&&(n+=e.data("damage per unit")),a.hasClass("heroes")&&(n+=e.data("damage per hero")))}),a.inRange(i,function(a){a=a.find(".card");a.hasClass(s)&&t.damage(n,a,e.data("damage type"))})}},heal:{cast:function(a,e,t){t.purge();a=e.addBuff(t,a);t.heal(a.data("heal")),a.on("buffcount",this.buffcount),t.select()},buffcount:function(a,e){var t=e.target,e=e.buff;3!==e.data("duration")&&t.heal(e.data("heal"))}},counter:{passive:function(a,e){var t=e.side();game[t].cardsPerTurn+=1,e.on("attacked.com-counter",this.attacked),e.selfBuff(a)},attacked:function(a,e){var t=e.source,s=e.target,n=e.damage,i=s.getBuff("com-counter"),e=i.data("lifesteal")/100,i=i.data("chance")/100;s.inAttackRange(t)&&game.random()<i&&s.side()==t.opponent()&&(game.audio.play("com/counter"),s.attack(t,"force"),s.heal(n*e))}},ult:{cast:function(a,e,t){e.addClass("nohighlight"),game.lockSelection=!0,e.on("death.com-ult",this.death),t.on("death.com-ult",this.death),e.data("com-ult-challenger",!0);for(var s=0;s<a.data("attacks");s++)game.timeout(1400*s,e.attack.bind(e,t,"force")),game.timeout(1400*s+700,t.attack.bind(t,e,"force"));game.timeout(4200,function(a,e){game.lockSelection=!1,a.removeClass("nohighlight").off("death.com-ult").reselect(),e.off("death.com-ult")}.bind(this,e,t))},death:function(a,e){var t=e.source,s=e.target;game.audio.play("com/ultvictory");var n=s.getSkill("ult");t.data("com-ult-challenger")&&(n=t.getSkill("ult"),(e=(e=t.getSkill("heal")).clone().data(e.data())).data("discard-to","hidden"),t.cast(e,t));n=n.data("damage bonus");t.setDamage(t.data("current damage")+n),t.data("com-ult-challenger",!1),s.data("com-ult-challenger",!1)}}},game.skills.en={passive:{passive:function(a,e,t){e.selfBuff(a,"passive-self"),e.data("en-passive",a.attr("id")),e.on("pre-attacked.en-passive",this.attacked)},attacked:function(a,e){var t=e.source,s=e.target,n=$("#"+s.data("en-passive")),n=s.addBuff(t,n,"passive-attacker");n&&(e.bonus+=-1*n.data("damage reduction"))}},curse:{cast:function(a,e,t){var s=e.side(),n=e.opponent();t.hasAllClasses("spot jungle free")?game.units.forestCreep(s,t).select():(t.hasClass("card")||(t=$(".card",t)),t.hasAllClasses(n+" heroes")||t.hasAllClasses(n+" ld-summon")?e.addBuff(t,a):t.hasAllClasses(n+" units")&&t.removeClass(n+" attacktarget").addClass(s).data("side",s))}},heal:{cast:function(t,s){var a=t.data("cast range");s.data("skill range bonus")&&(a+=s.data("skill range bonus"));var e=s.side(),n=s.selfBuff(t),i=[],o=[];if(s.on("death",this.death),s.around(a,function(a){a=$(".card",a);a.hasClass(e)&&!a.hasClasses("towers bkb cycloned")&&i.push(a)}),i.length){if(i.length>t.data("max targets"))for(var r=0;r<t.data("max targets");r++){var d=Math.floor(game.random()*i.length),d=i[d];o.push(d),i.erase(d)}else o=i;s.heal(n.data("heal")),n.on("buffcount",game.skills.en.heal.buffcount),n.on("expire",game.skills.en.heal.buffcount),$(o).each(function(a,e){n=s.addBuff(e,t),e.heal(n.data("heal")),n.on("buffcount",game.skills.en.heal.buffcount),n.on("expire",game.skills.en.heal.buffcount)})}},buffcount:function(a,e){var t=e.target,e=e.buff;3!==e.data("duration")&&t.heal(e.data("heal"))},death:function(a,e){e=e.target.side();$(".map .card."+e).each(function(){$(this).removeBuff("en-heal")})}},ult:{cast:function(a,e,t){var s=e.data("current damage"),n=2*(Math.abs(e.getX()-t.getX())+Math.abs(e.getY()-t.getY()));e.setDamage(s+n).addClass("nohighlight"),e.attack(t,"force","ult"),game.timeout(200,function(a,e){a.removeClass("nohighlight").setDamage(e)}.bind(this,e,s))}}},game.skills.kotl={illuminate:{cast:function(a,e,t){var s=e.getDirectionStr(t),n=e.side();a.addClass("channel-on"),e.selfBuff(a,"illuminate-channel"),e.addClass("illuminating illumi-"+s),e.data("illuminate",a.attr("id")),e.data("illuminate-target",t.attr("id")),e.on("channelend",this.channelend),a.data("discard-to",n+".skills.sidehand")},channelend:function(a,e){var t=$(this);game.skills.kotl.illuminate.release(t)},release:function(e){var a=$("#"+e.data("illuminate-target")),t=$(".table .skills .kotl-illuminate."+e.side()),s=t.data("damage"),n=t.data("aoe range");e.data("skill range bonus")&&(n+=e.data("skill range bonus"));var i=t.data("aoe width"),o=t.data("channel")-e.data("channeling")+1;game.audio.stop("kotl/illuminate"),game.audio.play("kotl/illuminaterelease"),e.data("illuminate-target",null),e.off("turnend.kotl-illuminate"),e.removeBuff("kotl-illuminate"),e.removeClass("illuminating illumi-left illumi-right illumi-top illumi-bottom"),t.data("discard-to",!1),t.removeClass("channel-on").discard(),game.fx.add("kotl-illuminate",e,a,"linear"),e.opponentsInLine(a,n,i,function(a){game.timeout(900,e.damage.bind(e,s*o,a,t.data("damage type")))}),game.camera.hasClass("night")||e.alliesInLine(a,n,i,function(a){game.timeout(900,a.heal.bind(a,s*o))})}},blind:{cast:function(s,n,e){game.fx.add("kotl-blind",n,e),game.timeout(1200,function(){var a=n.side(),t=game.opponent(a),a=$(".card",e);a.hasClass(t)&&game.skills.kotl.blind.target(s,n,a),e.inCross(1,0,function(a,e){a=$(".card."+t,a);a.length&&!a.hasClasses("towers ghost bkb")&&(game.skills.kotl.blind.target(s,n,a),(e=a.getDirSpot(e))&&e.hasClass("free")&&a.move(e))})})},target:function(a,e,t){e.addBuff(t,a),t.on("attack.kotl-blind",this.attack),t.stopChanneling(),e.damage(a.data("damage"),t,a.data("damage type"))},attack:function(a,e){var t=e.source,e=t.getBuff("kotl-blind").data("miss")/100;game.random()<e&&t.data("miss-attack",!0)}},mana:{cast:function(a,e){var t=e.side(),a=a.data("bonus cards");game.skill.buyCards(a,t),game.fx.add("kotl-mana",e)}},ult:{cast:function(s,n,i){var o=n;game.fx.add("kotl-ult",n,i),game.timeout(800,function(){var a=n.side(),e=game.opponent(a),t=$(".card",i),a=s.data("aoe range");o.data("skill range bonus")&&(a+=o.data("skill range bonus")),t.hasClass(e)&&game.skills.kotl.ult.target(s,n,t),i.inRange(a,function(a){a=$(".card."+e,a);a.length&&!a.hasClasses("tower ghost bkb")&&game.skills.kotl.ult.target(s,n,a)})})},target:function(a,e,t){e.addBuff(t,a),t.addClass("sleeping"),game.fx.text(t,"z"),t.on("attacked.kotl-ult",this.attacked),t.stopChanneling()},attacked:function(a,e){e=e.target;e.removeBuff("kotl-ult"),e.removeClass("sleeping"),$(".textsleep",e).remove()}}},game.skills.ld={bear:{cast:function(a,e,t){var s=$("#"+e.data("bear")),n=e.side(),i=$(".table ."+n+" .temp.skills .ld-bearreturn");s.length?e.resummon(s):(s=e.summon(a),e.data("bear",s.attr("id")),e.data("summon",s.attr("id")),e.data("return",i.attr("id")),e.addBuff(s,a,"demolish-source"),e.addBuff(s,a,"entangle-source"),e.on("pre-attacked.defender",this.transfer),e.on("death",this.death),s.on("pre-attack",this.attack),s.on("death",this.beardeath),s.data("return",i.attr("id")),s.data("death damage",a.data("death damage"))),e.addBuff(s,a,"defender-source"),i.appendTo(game[n].skills.sidehand).removeClass("casted"),s.setCurrentHp(s.data("hp")),game.fx.add("ld-return-target",t),game.timeout(400,function(){s.place(t)})},transfer:function(a,e){var t,s,n=e.target,i=$("#"+n.data("bear"));i&&(t=e.source,s=e.damage,(n=i.getBuff("defender-source").data("damage transfer"))<s&&(e.bonus+=-1*n,t.damage(n,i,game.data.ui.pure)))},attack:function(a,e){var t,s=e.target,n=e.source;n.data("miss-attack")||(s.hasClass("towers")?(t=n.getBuff("demolish-source"),e.bonus+=t.data("tower bonus")):s.side()==n.opponent()&&(t=n.getBuff("entangle-source").data("chance")/100,game.random()<t&&(game.audio.play("bear/entangle"),s.addStack("rooted"),game.fx.add("ld-root",n,s,"keep"),s.on("turnend.entangle-target",game.skills.ld.bear.turnend),t=$("#"+n.data("summoner")).getSkill("bear"),n.addBuff(s,t,"entangle-target"),s.stopChanneling())))},turnend:function(a,e){var t=e.target;t.hasBuff("entangle-target")?(e=t.getBuff("entangle-target"),$("#"+e.data("source")).damage(e.data("dot"),t,e.data("damage type"))):(t.removeStack("rooted"),$(".fx.ld-root",t).addClass("reverse"),game.timeout(1400,game.fx.stop.bind(this,"ld-root",t)),t.off("turnend.entangle-target"))},beardeath:function(a,e){var t=e.target,s=e.source,e=$("#"+t.data("summoner"));t.side()!=s.side()&&s.damage(t.data("death damage"),e,game.data.ui.pure),$("#"+t.data("return")).discard(),e.off("pre-attacked.defender"),e.data("bear",null),e.data("summon",null)},death:function(a,e){e=e.target;$("#"+e.data("return")).discard(),$("#"+e.data("bear")).discard()}},bearreturn:{cast:function(a,e,t){var s=$("#"+e.data("bear"));game.fx.add("ld-return",s.parent()),game.timeout(400,function(){s.addClass("hidden"),game.fx.add("ld-return-target",t)}),game.timeout(800,function(){s.removeClass("hidden").place(t)})}},link:{cast:function(a,e){e.selfBuff(a),e.shake(),game.fx.add("ld-link",e);var t=$("#"+e.data("bear"));t&&!t.hasClasses("bkb cycloned")&&(e.addBuff(t,a),game.fx.add("ld-link",t),t.shake(),e.on("attack",this.attack))},attack:function(a,e){var t=e.source,s=e.target,n=e.damage,i=t.getBuff("ld-link"),e=$("#"+t.data("bear"));i&&e&&(i=i.data("lifesteal")/100,s.side()!=t.opponent()||t.data("miss-attack")||e.heal(n*i))}},roar:{cast:function(e,a,t){t.opponentsInRange(e.data("range"),function(a){t.damage(e.data("damage"),a,e.data("damage type")),a.stopChanneling()}),game.fx.add("ld-roar",t);e.data("aoe range");var s=game.map.getX(t),n=game.map.getY(t);"enemy"===a.opponent()?(this.scare(a,game.map.getSpot(s+1,n-1)),this.scare(a,game.map.getSpot(s,n-1)),this.scare(a,game.map.getSpot(s-1,n-1)),this.scare(a,game.map.getSpot(s+1,n)),this.scare(a,game.map.getSpot(s-1,n)),this.scare(a,game.map.getSpot(s+1,n+1)),this.scare(a,game.map.getSpot(s,n+1)),this.scare(a,game.map.getSpot(s-1,n+1))):(this.scare(a,game.map.getSpot(s+1,n+1)),this.scare(a,game.map.getSpot(s,n+1)),this.scare(a,game.map.getSpot(s-1,n+1)),this.scare(a,game.map.getSpot(s+1,n)),this.scare(a,game.map.getSpot(s-1,n)),this.scare(a,game.map.getSpot(s+1,n-1)),this.scare(a,game.map.getSpot(s,n-1)),this.scare(a,game.map.getSpot(s-1,n-1))),t.reselect()},scare:function(a,e){var t,s;e&&e.length&&(s=a.opponent(),(t=e.find(".card."+s)).length&&!t.hasClasses("ghost bkb cycloned rooted stunned disabled")&&(a=game.map.getX(e),e=game.map.getY(e),s="enemy"===s?-1:1,(s=game.map.getSpot(a,e+s))&&s.hasClass("free")&&(t.stopChanneling(),t.removeInvisibility(),t.move(s),t.parent().addClass("free"),t.shake())))}},ult:{toggle:function(a,e){var t=e.side(),s=$(".table ."+t+" .skills .ld-cry");e.hasClass("transformed")?(e.removeClass("transformed"),a.removeClass("on"),s.discard(),e.removeBuff("ld-ult"),e.setRange(game.data.ui.long)):(e.addClass("transformed"),a.addClass("on"),e.data("ld-cry")||(s.appendTo(game[t].skills.hand),e.data("ld-cry",!0),e.on("turnstart",function(){$(this).data("ld-cry",!1)})),e.selfBuff(a),e.setRange(game.data.ui.melee),game.fx.ult(a))}},cry:{cast:function(a,e){e.selfBuff(a),e.shake(),game.fx.add("ld-cry",e);var t=$("#"+e.data("bear"));t&&!t.hasClasses("bkb cycloned")&&(e.addBuff(t,a),game.fx.add("ld-cry",t),t.shake()),e.select()}}},game.skills.lina={fire:{cast:function(e,t,a){game.fx.add("lina-fire",t,a,"linear");var s=e.data("aoe range");t.data("skill range bonus")&&(s+=t.data("skill range bonus"));var n=e.data("aoe width"),i=e.data("damage");t.opponentsInLine(a,s,n,function(a){game.timeout(900,t.damage.bind(t,i,a,e.data("damage type")))})}},stun:{cast:function(e,t,s){var a=e.data("aoe range");t.data("skill range bonus")&&(a+=t.data("skill range bonus"));var n=t.opponent(),i=e.data("damage");game.fx.add("lina-stun",t,s),s.cardsInRange(a,function(a){a.hasClass(n)&&(game.timeout(900,t.damage.bind(t,i,a,e.data("damage type"))),s.hasClass("bkb")||t.addStun(a,e)),a.hasClass("trees")&&game.tree.destroy(a)})}},passive:{passive:function(a,e){e.addBuff(e,a),e.on("cast",game.skills.lina.passive.cast)},cast:function(a,e){var t=e.source,s=t.getBuff("lina-passive"),e=s.data("cast damage bonus")||0;$("span",s).length?$("span",s).text(e+Number($("span",s).text())):s.append($("<span>").text(e)),game.fx.add("lina-passive",t,s),t.setDamage(t.data("current damage")+e),t.on("turnend.passive",game.skills.lina.passive.turnend)},turnend:function(){var a=$(this),e=a.getBuff("lina-passive"),t=e.data("cast damage bonus")||0;a.setDamage(a.data("current damage")-t),a.off("turnend.passive"),$("span",e).remove(),game.fx.stop("lina-passive",a)}},ult:{cast:function(a,e,t){game.fx.add("lina-ult",e,t,"target"),game.timeout(900,e.damage.bind(e,a.data("damage"),t,a.data("damage type")))}}},game.skills.nyx={stun:{cast:function(n,i,a){var e=n.data("aoe range");i.data("skill range bonus")&&(e+=i.data("skill range bonus"));var t=n.data("aoe width"),o=n.data("damage"),r=n.data("damage type");game.fx.shake();var d=i.opponent(),l=i.getX(),m=i.getY();i.inLine(a,e,t,function(a,e,t){var t=Math.abs(180*(l-e+(m-t))),s=$(".card",a);s.hasClass(d)&&!s.hasClass("bkb")?game.timeout(t,function(){i.damage(o,s,r),i.addStun(s,n),game.fx.add("nyx-stun",a)}):game.timeout(t,game.fx.add.bind(this,"nyx-stun",a,0,0,0,"miss"))})}},burn:{cast:function(a,e,t){var s=t.data("hero"),n=t.side();$("."+n+" .hand ."+s).randomCard().discard();s=(t.data("mana")||1)*a.data("multiplier"),a=a.data("damage type");e.damage(s,t,a),game.fx.add("nyx-burn",e,t)}},spike:{cast:function(a,e){var t=e.selfBuff(a);e.addClass("nyx-spike"),e.on("damage.nyx-spike",this.damage),e.data("nyx-spike",a.attr("id")),t.on("expire",this.expire),game.fx.add("nyx-spike",e,0,"keep")},damage:function(a,e){var t=e.target;game.timeout(900,function(a,e){var t=$("#"+e),s=$("#"+t.data("nyx-spike")),n=s.data("damage type"),e=a.source,a=a.originalDamage;e.hasClass("towers")||(t.damage(a,e,n),t.addStun(e,s))}.bind(this,e,t.attr("id")))},expire:function(a,e){e=e.target;e.data("nyx-spike",null),e.off("damage.nyx-spike"),e.removeClass("nyx-spike");e=$(".fx.nyx-spike",e);e.addClass("end"),e.on("animationend webkitAnimationEnd MSAnimationEnd oAnimationEnd",function(){this.remove()})}},ult:{cast:function(a,e){a=e.selfBuff(a);a.on("expire",this.expire),e.on("pre-attack.nyx-ult",this.attack),e.on("invisibilityLoss.nyx-ult",this.invisibilityLoss),e.addInvisibility(a),e.addClass("nyx-ult")},attack:function(a,e){var t=e.source,s=e.target,n=t.getBuff("nyx-ult");s.hasClass("towers")?e.bonus+=-1*n.data("damage bonus")+1:game.audio.play("nyx/ultattack"),t.removeClass("nyx-ult"),t.off("pre-attack.nyx-ult"),t.removeBuff("nyx-ult")},invisibilityLoss:function(a,e){e.target.removeClass("nyx-ult")},expire:function(a,e){e=e.target;e.removeClass("nyx-ult"),e.off("pre-attack.nyx-ult")}}},game.skills.pud={hook:{cast:function(a,e,t){var s=a.data("aoe range");e.data("skill range bonus")&&(s+=e.data("skill range bonus"));var n=e.firstCardInLine(t,s),i=e.firstFreeSpotInLine(t,s,n);n&&n.hasClasses("heroes units")&&!n.hasClasses("ghost towers")?(n.shake(),n.side()==e.opponent()&&(t.hasClass("bkb")||e.damage(a.data("damage"),n,a.data("damage type")),n.stopChanneling(),n.removeInvisibility())):(s=e.lastFreeSpotInLine(t,s),n=$("<div>").addClass("fx ghost").appendTo(s));game.fx.add("pud-hook",e,n,"linear",e.parent());n.getSpot()==i.getSpot()&&(i=!1),game.lockHighlight=!0,game.timeout(700,function(a,e,t){!a.hasClass("ghost")&&e&&e.getPosition()!=a.getPosition()&&a.move(e),game.timeout(300,function(a,e){a.hasClass("ghost")&&a.remove(),game.lockHighlight=!1,game.highlight.map()}.bind(this,a,t))}.bind(this,n,i,e,t))}},rot:{toggle:function(a,e){var t,s,n;a.hasClass("on")?(a.removeClass("on"),e.off("turnend.rot"),e.data("pud-rot",null),e.removeClass("pud-rot"),e.removeBuff("pud-rot"),t=e.side(),$(".pud-rot-target-"+t).removeClass("pud-rot-target-"+t),$(".map .card."+e.opponent()).removeBuff("pud-rot"),game.fx.stop("pud-rot",e)):(a.addClass("on"),e.on("turnend.rot",game.skills.pud.rot.turnend),e.data("pud-rot",a.attr("id")),e.addClass("pud-rot"),e.selfBuff(a,"rot-source"),s=a.data("aoe range"),n=game.skills.pud.rot.curse.bind({source:e,skill:a}),e.opponentsInRange(s,n),e.on("moved.rot",function(){e.opponentsInRange(s,n)}),game.fx.add("pud-rot",e))},curse:function(a){var e=this.source,t=this.skill,s=e.side();a.addClass("pud-rot-target-"+s),e.addBuff(a,t,"rot-targets")},turnend:function(a,e){var t=e.target,s=t.side(),n=$("#"+t.data("pud-rot")),i=n.data("aoe range"),o=n.data("damage");t.damage(o,t,n.data("damage type"));e=game.skills.pud.rot.curse.bind({source:t,skill:n});t.opponentsInRange(i,e),$(".pud-rot-target-"+s).each(function(a,e){target=$(e),t.damage(o,target,n.data("damage type")),target.removeClass("pud-rot-target-"+s)}),game.fx.add("pud-rot",t)}},passive:{passive:function(a,e){var t=e.selfBuff(a);e.on("kill",this.kill);a=e.data("kills");game.skills.pud.passive.bonus(t,e,a)},bonus:function(a,e,t){var s=e.data("current damage"),n=a.data("damage per kill")*t,i=e.data("hp"),o=a.data("hp per kill")*t;s&&n&&i&&o&&(e.setDamage(s+n),e.setHp(i+o),i=e.data("current hp"),e.setCurrentHp(i+o),$("span",a).length?$("span",a).text(t+Number($("span",a).text())):a.append($("<span>").text(t)),e.reselect())},kill:function(a,e){var t=e.source,s=e.target,e=t.getBuff("pud-passive");t.side()==s.opponent()&&s.hasClass("heroes")&&e&&game.skills.pud.passive.bonus(e,t,1)}},ult:{cast:function(a,e,t){e.selfBuff(a,"ult-source"),e.addBuff(t,a,"ult-target"),e.addClass("pud-ult"),t.addClass("disabled").removeClass("can-attack"),t.data("pud-ult-source",e.attr("id")),t.on("death.pud-ult",this.death),game.skills.pud.ult.bite(e,t,a),e.on("channel",this.channel),e.on("channelend",this.channelend)},channel:function(a,e){var t=e.source,s=e.target,e=e.skill;t.data("channeling")!==e.data("channel")&&game.skills.pud.ult.bite(t,s,e)},bite:function(a,e,t){game.audio.play("pud/ult-channel"),e.shake(),e.stopChanneling(),e.removeInvisibility(),a.damage(t.data("dot"),e,t.data("damage type")),a.heal(t.data("dot")),game.fx.add("pud-ult",a,e)},death:function(a,e){e=e.target;$("#"+e.data("pud-ult-source")).stopChanneling()},channelend:function(a,e){var t=e.source,e=e.target;e.removeClass("disabled"),e.data("pud-ult-source",null),e.off("death.pud-ult"),e.removeBuff("pud-ult"),t.removeBuff("pud-ult"),t.removeClass("pud-ult")}}},game.skills.terror={summon:{cast:function(a,e,t){var s=$("#"+e.data("mirror image"));e.side();s.length?e.resummon(s):((s=e.summon(e)).addClass("illusion"),e.data("mirror image",s.attr("id")),e.data("summon",s.attr("id")));var n=Math.floor(e.data("hp")/2),e=Math.floor(e.data("damage")/2);s.setHp(n).setCurrentHp(n),s.setDamage(e).data("damage",e),game.fx.add("ld-return-target",t),game.timeout(400,function(){s.place(t)})}},mirror:{cast:function(e,t){var a=e.data("aoe range");t.data("skill range bonus")&&(a+=t.data("skill range bonus")),t.opponentsInRange(a,function(a){game.timeout(400,t.damage.bind(t,a.data("current damage"),a,e.data("damage type")))})}},morph:{cast:function(a,e){var t;e.selfBuff(a),e.data("mirror image")&&(t=$("#"+e.data("mirror image")),e.addBuff(t,a))}},ult:{cast:function(a,e,t){var s=e.data("current hp");e.setCurrentHp(t.data("current hp")),t.setCurrentHp(s),e.data("current hp")<e.data("current resistance")&&e.setCurrentHp(e.data("current resistance")),t.data("current hp")<t.data("current resistance")&&t.setCurrentHp(t.data("current resistance"))}}},game.skills.venge={stun:{cast:function(a,e,t){t.hasClass("bkb")||e.addStun(t,a),e.damage(a.data("damage"),t,a.data("damage type")),game.timeout(200,game.fx.projectile.bind(this,e,t,"venge-stun",1.5)),game.timeout(600,game.fx.add.bind(this,"cat-leap",t.parent()))}},corruption:{cast:function(n,i,a){var e=n.data("aoe range");i.data("skill range bonus")&&(e+=i.data("skill range bonus"));var t=n.data("aoe width"),o=n.data("damage"),r=i.getX(),d=i.getY(),l=i.opponent();i.inLine(a,e,t,function(a,e,t){var t=Math.abs(180*(r-e+(d-t))),s=$(".card",a);s.hasClass(l)&&!s.hasClass("bkb")?game.timeout(t,function(){i.damage(o,s,n.data("damage type")),i.addBuff(s,n),game.fx.add("venge-corruption",a,0,"random")}):game.timeout(t,game.fx.add.bind(this,"venge-corruption",a,0,"random",0,"miss"))})}},aura:{passive:function(a,t){t.on("death.venge-aura",this.death),t.on("reborn.venge-aura",this.reborn),t.data("venge-aura",a.attr("id")),game.fx.add("venge-aura",t),game.timeout(200,function(){var a=t.side();$(".table .map .card."+a).each(function(a,e){e=$(e);e.hasBuff("venge-aura")&&e[0]!==t[0]&&game.fx.add("venge-aura-target",e)})})},death:function(a,e){var t=e.target,s=t.side(),n=$("#"+t.data("venge-aura")),i=JSON.parse(n.data("buff"));game.timeout(200,function(){i["damage bonus"]*=2,n.data("buff",JSON.stringify(i)),$(".table .card."+s+":not(.skills)").each(function(){var a=$(this);t.addBuff(a,n)})})},reborn:function(a,e){var t=e.target,e=t.side(),t=$("#"+t.data("venge-aura"));$(".table .card."+e+":not(.skills)").each(function(){$(this).removeBuff("venge-aura")});e=JSON.parse(t.data("buff"));e["damage bonus"]/=2,t.data("buff",JSON.stringify(e))}},ult:{cast:function(a,e,t){t.side()==e.side()&&t.purge(),t.stopChanneling(),game.timeout(300,function(a,e){var t=a.getPosition(),s=e.getPosition();e.place(t),a.place(s),game.fx.add("venge-ult",a,e,"rotate",0,0,{scale:2.2,offset:{x:-80}}),game.fx.add("venge-ult",e,a,"rotate",0,0,{scale:2.2,offset:{x:-80}})}.bind(this,e,t))},after:function(a,e){a.parent().removeClass("free"),e.parent().removeClass("free"),a.reselect()}}},game.skills.wind={stun:{cast:function(a,e,t){e.shake();var s=e.behindTarget(t);s&&!s.hasClasses("ghost dead towers bkb")?(s.shake(),game.audio.play("wind/stunhit"),s.side()==e.opponent()?(e.addStun(t,a),e.addStun(s,a)):s.hasClass("trees")&&e.addStun(t,a)):(s=-a.data("stun")/2,e.addStun(t,a,s))}},arrow:{cast:function(a,e,t){var s=a.data("aoe range");e.data("skill range bonus")&&(s+=e.data("skill range bonus"));var n=a.data("aoe width"),i=[];e.inLine(t,s,n,function(a){a=a.children(".card");a.side()==e.opponent()?i.push(a):a.hasClass("trees")&&game.tree.destroy(a)});var o=a.data("damage")-a.data("damage reduction")*(i.length-1);$(i).each(function(){game.timeout(900,e.damage.bind(e,o,this,a.data("damage type")))}),game.timeout(900,game.fx.add.bind(this,"wind-arrow",e,e.lastSpotInLine(t,s),"target"))}},run:{cast:function(a,e){a=e.selfBuff(a);e.on("attacked.wind-run",this.attacked).addClass("windrun"),a.on("expire",this.expire)},attacked:function(a,e){e.source.data("miss-attack",!0)},expire:function(a,e){e.target.off("attacked.wind-run").removeClass("windrun")}},ult:{cast:function(a,e,t){var s=e.data("current damage"),n=a.data("damage reduction");e.setDamage(s-n).addClass("nohighlight"),game.lockSelection=!0;for(var i=0;i<a.data("attacks");i++)game.timeout(900*i,e.attack.bind(e,t,"force"));game.timeout(3600,function(a,e){a.removeClass("nohighlight").setDamage(e),game.lockSelection=!1}.bind(this,e,s))}}},game.skills.wk={stun:{cast:function(a,e,t){e.addStun(t,a),t.data("wk-dot-count",3),t.on("turnend.wk-stun",this.turnend.bind(this,e,t,a)),game.fx.projectile(e,t,a),game.timeout(400,function(a,e,t){game.fx.add("wk-stun-hit",a,e),a.damage(t.data("damage"),e,t.data("damage type"))}.bind(this,e,t,a))},turnend:function(a,e,t){var s=JSON.parse(t.data("buff")),n=e.data("wk-dot-count");e.data("wk-dot-count",n-1),2===n&&(s=a.addBuff(e,t),game.fx.add("wk-stun",a,s)),0<=n&&n<=2&&a.damage(s.dot,e,s["damage type"]),0===n&&e.off("turnend.wk-stun").data("wk-dot-count",null).removeBuff("wk-stun")}},aura:{passive:function(a,e){e=e.side();$(".table .card."+e+":not(.skills)").on("attack.wk-aura",this.attack)},attack:function(a,e){var t=e.source,s=e.target,n=e.damage,e=t.getBuff("wk-aura");e&&(e=e.data("lifesteal")/100,s.side()!=t.opponent()||t.data("miss-attack")||(t.heal(n*e),game.fx.add("wk-lifesteal",t)))}},crit:{passive:function(a,e){e.selfBuff(a),e.on("pre-attack.wk-crit",this.attack)},attack:function(a,e){var t=e.source,s=e.target,n=(e.damage,t.side()),e=t.getBuff("wk-crit"),e=(e.data("chance"),e.data("multiplier"));game.fx.add("axe-ult-kill",t,s,"flip"),t.data("critical-attack",e),game.units.clone($(".table ."+n+" .temp.skills .wk-skeleton")).appendTo(".table ."+n+" .sidehand.skills").on("mousedown touchstart",game.card.select)}},skeleton:{cast:function(a,e,t){var s=e.summon(a);game.fx.add("ld-return-target",t),game.timeout(400,function(){s.place(t)})}},ult:{passive:function(a,e){e.selfBuff(a,"ult-source"),e.on("death.wk-ult",this.death),e.data("wk-ult",a.attr("id"))},death:function(a,e){var t=e.target,s=e.spot,e=t.side();s.addClass("cript block").removeClass("free"),t.on(e+"turnstart.wk-ult",game.skills.wk.ult.turnstart),t.data("wk-ult-spot",s.attr("id"))},turnstart:function(a,e){var t=e.target,s=$("#"+t.data("wk-ult-spot")),e=$("#"+t.data("wk-ult"));game.audio.play("wk/ult"),game.fx.ult(e,game.skills.wk.ult.reborn.bind(this,t,s,e))},reborn:function(e,a,t){var s=e.side(),n=game.data.skills.wk.ult.buffs.ult.source.range;e.data("skill range bonus")&&(n+=e.data("skill range bonus")),game.fx.shake(),e.reborn(a),e.addClass("can-attack"),a.removeClass("cript block"),e.opponentsInRange(n,function(a){a.hasClass("bkb")||e.addBuff(a,t,"ult-targets")}),e.off(s+"turnstart.wk-ult"),e.off("death.wk-ult"),e.data("wk-ult-spot",null),"library"==game.mode?t.removeClass("casted").appendTo(game[s].skills.sidehand):t.appendTo(game[s].skills.cemitery),"enemy"==s&&t.addClass("flipped")}}},game.states.campaign={lane:["m","m"],build:function(){for(var a in game.data.campaign)game.data.campaign[a].id=a;this.map=$("<div>").addClass("campaign-map"),this.desc=$("<div>").addClass("campaign-box box"),this.buttonbox=$("<div>").addClass("buttonbox"),this.back=$("<div>").addClass("back button").text(game.data.ui.back).on("mouseup touchend",this.backClick).appendTo(this.buttonbox),this.toChoose=$("<div>").addClass("campaign-play button highlight").text(game.data.ui.battle).on("mouseup touchend",this.toChoose).appendTo(this.buttonbox),this.el.append(this.map).append(this.desc).append(this.buttonbox),this.buildDesc(game.data.campaign.start),this.buildStages(),this.buildPaths()},buildStages:function(){this.st=$("<div>").attr("id","st").data("id","start").addClass("stages start blink").appendTo(this.map),this.et=$("<div>").attr("id","et").data("id","easy").addClass("stages easy top").appendTo(this.map),this.em=$("<div>").attr("id","em").data("id","easy").addClass("stages easy mid").appendTo(this.map),this.eb=$("<div>").attr("id","eb").data("id","easy").addClass("stages easy bot").appendTo(this.map),this.ru=$("<div>").attr("id","ru").data("id","rune").addClass("stages rune").appendTo(this.map),this.ro=$("<div>").attr("id","ro").data("id","roshan").addClass("stages roshan").appendTo(this.map),this.sh=$("<div>").attr("id","sh").data("id","shop").addClass("stages shop").appendTo(this.map),this.nm=$("<div>").attr("id","nm").data("id","normal").addClass("stages normal mid").appendTo(this.map),this.ht=$("<div>").attr("id","ht").data("id","hard").addClass("stages hard top").appendTo(this.map),this.hm=$("<div>").attr("id","hm").data("id","hard").addClass("stages hard mid").appendTo(this.map),this.hb=$("<div>").attr("id","hb").data("id","hard").addClass("stages hard bot").appendTo(this.map),this.fi=$("<div>").attr("id","fi").data("id","last").addClass("stages last").appendTo(this.map),this.ot=$("<div>").attr("id","ot").data("id","optional").addClass("stages optional top").appendTo(this.map),this.om=$("<div>").attr("id","om").data("id","optional").addClass("stages optional mid").appendTo(this.map),this.ob=$("<div>").attr("id","ob").data("id","optional").addClass("stages optional bot").appendTo(this.map)},buildPaths:function(){this.el.css({display:"block",visibility:"hidden"}),this.createPath(this.st,this.et,"st-et",!0),this.createPath(this.st,this.em,"st-em",!0),this.createPath(this.st,this.eb,"st-eb",!0),this.createPath(this.et,this.nm,"et-nm"),this.createPath(this.et,this.ot,"et-ot"),this.createPath(this.et,this.ro,"et-ro"),this.createPath(this.em,this.nm,"em-nm"),this.createPath(this.em,this.om,"em-om"),this.createPath(this.em,this.sh,"em-sh"),this.createPath(this.eb,this.nm,"eb-nm"),this.createPath(this.eb,this.ob,"eb-ob"),this.createPath(this.eb,this.ru,"eb-ru"),this.createPath(this.nm,this.ht,"nm-ht"),this.createPath(this.nm,this.hm,"nm-hm"),this.createPath(this.nm,this.hb,"nm-hb"),this.createPath(this.ht,this.fi,"ht-fi"),this.createPath(this.hm,this.fi,"hm-fi"),this.createPath(this.hb,this.fi,"hb-fi"),this.el.css({display:"none",visibility:""})},start:function(){this.clear(),game.mode||game.setMode("single"),game.message.text(game.data.ui.campaign),game.nextStage&&(game.states.campaign.nextStage(),game.nextStage=!1)},nextStage:function(){switch(this.stage.id){case"last":game.overlay.alert("Congratulation, you beat our Campaign! Thanks a lot for participating in our beta test!"),this.done=!0,game.setData("campaignDone",!0),this.enableAllStages();break;case"hard":this.stage=game.data.campaign.last;break;case"rune":this.done||$("#ru").removeClass("blink enabled").addClass("done").off("mouseup touchend"),this.stage=game.data.campaign.normal;break;case"shop":this.done||$("#sh").removeClass("blink enabled").addClass("done").off("mouseup touchend"),this.stage=game.data.campaign.normal;break;case"roshan":this.done||$("#ro").removeClass("blink enabled").addClass("done").off("mouseup touchend"),this.stage=game.data.campaign.normal;break;case"optional":this.done||$("#o"+game.states.campaign.lane[0]).removeClass("blink enabled").addClass("done").off("mouseup touchend"),this.stage=game.data.campaign.normal;break;case"normal":this.stage=game.data.campaign.hard;break;case"easy":this.stage=game.data.campaign.normal;break;default:this.stage=game.data.campaign.easy}game.setData("stage",this.stage.id),game.setData("lane",this.lane),this[this.stage.id+"Show"]&&!this.done&&this[this.stage.id+"Show"]()},startClick:function(){$(".campaign-path").css("opacity",.2),$(".blink").removeClass("blink"),game.states.campaign.st.addClass("blink"),game.states.campaign.buildDesc(game.data.campaign.start)},easyClick:function(){var a=$(this);$(".blink").removeClass("blink"),a.addClass("blink"),game.states.campaign.pathHighlight(a),game.states.campaign.buildDesc(game.data.campaign.easy)},easyShow:function(){this.st.removeClass("blink").on("mouseup touchend",this.startClick).addClass("done"),$(".campaign-path").css("opacity",.2),$(".stages.easy").addClass("enabled blink").on("mouseup touchend",this.easyClick),$(".campaign-path.et-nm").removeClass("hidden"),$(".campaign-path.et-ot").removeClass("hidden"),$(".campaign-path.et-ro").removeClass("hidden"),$(".campaign-path.em-nm").removeClass("hidden"),$(".campaign-path.em-om").removeClass("hidden"),$(".campaign-path.em-sh").removeClass("hidden"),$(".campaign-path.eb-nm").removeClass("hidden"),$(".campaign-path.eb-ob").removeClass("hidden"),$(".campaign-path.eb-ru").removeClass("hidden"),$(".campaign-path.st-et").css("opacity",.6),$(".campaign-path.st-em").css("opacity",.6),$(".campaign-path.st-eb").css("opacity",.6),$(".campaign-path.st-e"+game.states.campaign.lane[0]).css("opacity",1),this.buildDesc(game.data.campaign.easy)},normalClick:function(){var a=$(this);$(".blink").removeClass("blink"),a.addClass("blink"),game.states.campaign.pathHighlight(a),game.states.campaign.buildDesc(game.data.campaign.normal)},optionalClick:function(){var a=$(this);game.states.campaign.lane[0]="m",a.hasClass("top")&&(game.states.campaign.lane[0]="t"),a.hasClass("bot")&&(game.states.campaign.lane[0]="b"),$(".blink").removeClass("blink"),a.addClass("blink"),game.states.campaign.pathHighlight(a),game.states.campaign.buildDesc(game.data.campaign.optional)},normalShow:function(){$(".stages.easy").removeClass("blink enabled").addClass("done").off("mouseup touchend"),$("#e"+game.states.campaign.lane[0]).addClass("enabled").on("mouseup touchend",this.easyClick),this.nm.addClass("enabled blink").on("mouseup touchend",this.normalClick);var a=$("#o"+game.states.campaign.lane[0]);a.addClass("enabled").on("mouseup touchend",this.optionalClick),a.hasClass("done")||a.addClass("blink"),$(".campaign-path").css("opacity",.2),$(".campaign-path.nm-ht").removeClass("hidden"),$(".campaign-path.nm-hm").removeClass("hidden"),$(".campaign-path.nm-hb").removeClass("hidden"),"t"==game.states.campaign.lane[0]&&(this.ro.addClass("enabled").on("mouseup touchend",this.roshanClick),$(".campaign-path.et-ro").css("opacity",.6),this.ro.hasClass("done")||this.ro.addClass("blink")),"m"==game.states.campaign.lane[0]&&(this.sh.addClass("enabled").on("mouseup touchend",this.shopClick),$(".campaign-path.em-sh").css("opacity",.6),this.sh.hasClass("done")||this.sh.addClass("blink")),"b"==game.states.campaign.lane[0]&&(this.ru.addClass("enabled").on("mouseup touchend",this.runeClick),$(".campaign-path.eb-ru").css("opacity",.6),this.ru.hasClass("done")||this.ru.addClass("blink")),$(".campaign-path.e"+game.states.campaign.lane[0]+"-nm").css("opacity",.6),$(".campaign-path.e"+game.states.campaign.lane[0]+"-o"+game.states.campaign.lane[0]).css("opacity",.6),$(".campaign-path.st-e"+game.states.campaign.lane[0]).css("opacity",1),this.buildDesc(game.data.campaign.normal)},hardClick:function(){var a=$(this);$(".blink").removeClass("blink"),a.addClass("blink"),game.states.campaign.pathHighlight(a),game.states.campaign.buildDesc(game.data.campaign.hard)},roshanClick:function(){var a=$(this);game.states.campaign.lane[0]="t",$(".blink").removeClass("blink"),a.addClass("blink"),game.states.campaign.pathHighlight(a),game.states.campaign.buildDesc(game.data.campaign.roshan)},runeClick:function(){var a=$(this);game.states.campaign.lane[0]="b",$(".blink").removeClass("blink"),a.addClass("blink"),game.states.campaign.pathHighlight(a),game.states.campaign.buildDesc(game.data.campaign.rune)},shopClick:function(){var a=$(this);game.states.campaign.lane[0]="m",$(".blink").removeClass("blink"),a.addClass("blink"),game.states.campaign.pathHighlight(a),game.states.campaign.buildDesc(game.data.campaign.shop)},hardShow:function(){$("#nm").removeClass("blink").addClass("done"),$(".stages.hard").addClass("enabled blink").on("mouseup touchend",this.hardClick),$(".stages.optional, #ro, #ru, #sh").removeClass("blink").addClass("done"),$(".campaign-path").css("opacity",.2),$(".campaign-path.ht-fi").removeClass("hidden"),$(".campaign-path.hm-fi").removeClass("hidden"),$(".campaign-path.hb-fi").removeClass("hidden"),$(".campaign-path.nm-ht").css("opacity",.6),$(".campaign-path.nm-hm").css("opacity",.6),$(".campaign-path.nm-hb").css("opacity",.6),$(".campaign-path.st-e"+game.states.campaign.lane[0]).css("opacity",1),$(".campaign-path.e"+game.states.campaign.lane[0]+"-nm").css("opacity",1),this.buildDesc(game.data.campaign.hard)},lastClick:function(){var a=$(this);$(".blink").removeClass("blink"),a.addClass("blink"),game.states.campaign.pathHighlight(a),game.states.campaign.buildDesc(game.data.campaign.last)},lastShow:function(){$(".stages.hard").removeClass("blink enabled").addClass("done").off("mouseup touchend"),$("#h"+game.states.campaign.lane[1]).addClass("enabled").on("mouseup touchend",this.hardClick),$("#fi").addClass("enabled blink").on("mouseup touchend",this.lastClick),$(".campaign-path").css("opacity",.2),$(".campaign-path.st-e"+game.states.campaign.lane[0]).css("opacity",1),$(".campaign-path.e"+game.states.campaign.lane[0]+"-nm").css("opacity",1),$(".campaign-path.nm-h"+game.states.campaign.lane[1]).css("opacity",1),$(".campaign-path.h"+game.states.campaign.lane[1]+"-fi").css("opacity",1),this.buildDesc(game.data.campaign.last)},enableAllStages:function(){game.states.campaign.stage=game.data.campaign.start,$(".stages").removeClass("done"),$(".campaign-path").removeClass("hidden").css("opacity",1),$(".stages").addClass("enabled blink").each(function(){var a=$(this);a.on("mouseup touchend",game.states.campaign[a.data("id")+"Click"])}),$(".stages.start").removeClass("blink"),this.buildDesc(game.data.campaign.start)},buildDesc:function(a){a?this.stage=a:a=this.stage,this.desc.html(""),game.ai.mode=a.ai,game.enemy.name="AI "+game.ai.mode,$("<h2>").text(a.name).appendTo(this.desc),$("<div>").addClass("campaign-img "+a.img).appendTo(this.desc),$("<p>").text(a.title).appendTo(this.desc),$(a.achievements).each(function(a,e){$("<p>").addClass("achieve").text(e.name+" - "+e.description).appendTo(game.states.campaign.desc)});var e=$("<div>").addClass("campaign-heroes").appendTo(this.desc);game.single.enemypicks=a.picks;for(var t=game.single.enemypicks.length-1;-1<t;t--){var s=game.single.enemypicks[t],n=$("<div>").addClass("portrait").append($("<div>").addClass("img"));$("<div>").addClass("heroes "+s).append(n).appendTo(e)}},createPath:function(a,e,t,s){var n=(n=Number(game.screen.scale))||1,i=a.position(),o=e.position(),a=a.width()/n/2;i.left/=n,i.top/=n,o.left/=n,o.top/=n,i.left+=a-4,i.top+=a-4;n=e.width()/n/2;o.left+=n-4,o.top+=n-4;var n=o.left-i.left,o=o.top-i.top,r=Math.atan2(o,n),o=Math.pow(Math.pow(n,2)+Math.pow(o,2),.5),d=9+a;o-=9+d;for(var l,m,g=Math.floor(o/18)-1,c=0;c<g;c++)l=i.left+d*Math.cos(r)+18*c*Math.cos(r),m=i.top+d*Math.sin(r)+18*c*Math.sin(r),t="campaign-path "+t,s||(t+=" hidden"),$("<div>").addClass(t).css({left:l,top:m}).appendTo(game.states.campaign.map)},pathHighlight:function(a){$(".campaign-path").css("opacity",.2),"e"==a.attr("id")[0]&&(game.states.campaign.lane[0]=a.attr("id")[1],$(".campaign-path.st-"+a.attr("id")).css("opacity",1));var e=game.states.campaign.lane[0];"o"==a.attr("id")[0]&&($(".campaign-path.st-e"+e).css("opacity",1),$(".campaign-path.e"+e+"-o"+e).css("opacity",1)),"ro"==a.attr("id")&&($(".campaign-path.st-e"+e).css("opacity",1),$(".campaign-path.e"+e+"-ro").css("opacity",1)),"sh"==a.attr("id")&&($(".campaign-path.st-e"+e).css("opacity",1),$(".campaign-path.e"+e+"-sh").css("opacity",1)),"ru"==a.attr("id")&&($(".campaign-path.st-e"+e).css("opacity",1),$(".campaign-path.e"+e+"-ru").css("opacity",1)),"nm"==a.attr("id")&&($(".campaign-path.st-e"+e).css("opacity",1),$(".campaign-path.e"+e+"-nm").css("opacity",1)),"h"==a.attr("id")[0]&&(game.states.campaign.lane[1]=a.attr("id")[1],$(".campaign-path.st-e"+e).css("opacity",1),$(".campaign-path.e"+e+"-nm").css("opacity",1),$(".campaign-path.nm-h"+a.attr("id")[1]).css("opacity",1));var t=game.states.campaign.lane[1];"fi"==a.attr("id")&&($(".campaign-path.st-e"+e).css("opacity",1),$(".campaign-path.e"+e+"-nm").css("opacity",1),$(".campaign-path.nm-h"+t).css("opacity",1),$(".campaign-path.h"+t+"-fi").css("opacity",1)),game.setData("lane",game.states.campaign.lane)},clearPaths:function(){$(".campaign-path",game.states.campaign.map).hide()},toChoose:function(){"Stage 1"==game.states.campaign.stage.name?game.states.changeTo("choose"):game.states.changeTo("vs")},backClick:function(){game.clear(),game.states.changeTo("menu")},clear:function(){$(".stage",game.states.campaign.el).removeClass("enabled"),this.st.addClass("enabled")},end:function(){}},game.states.choose={size:100,event:"mouseup.choose touchend.choose",build:function(){this.pickbox=$("<div>").addClass("pickbox").appendTo(this.el),this.pickedbox=$("<div>").addClass("pickedbox").hide(),this.slots=this.buildSlots(),this.counter=$("<p>").addClass("counter").hide().appendTo(this.pickedbox),game.library.buildSkills(game.states.choose.buildDeck),this.buttonbox=$("<div>").addClass("buttonbox"),this.back=$("<div>").addClass("back button alert").text(game.data.ui.back).on("mouseup touchend",this.backClick).appendTo(this.buttonbox),this.intro=$("<div>").addClass("intro button").text(game.data.ui.intro).on("mouseup touchend",game.library.showIntro).appendTo(this.buttonbox),this.randombt=$("<div>").addClass("random button").text(game.data.ui.random).on("mouseup touchend",game.states.choose.randomClick).appendTo(this.buttonbox),this.mydeck=$("<div>").addClass("mydeck button highlight").text(game.data.ui.mydeck).on("mouseup touchend",this.savedDeck).appendTo(this.buttonbox),this.librarytest=$("<div>").addClass("librarytest button highlight").text(game.data.ui.librarytest).on("mouseup touchend",this.testHeroClick).appendTo(this.buttonbox),this.el.append(this.buttonbox).append(this.pickedbox),this.video=$("<iframe>").hide().addClass("video").attr({frameborder:0,width:760,height:340,allow:"autoplay; fullscreen",rel:0}).appendTo(this.pickbox)},start:function(){$(".choose .buttonbox .button").not(".back").hide(),game.audio.loopSong("SneakyAdventure");var a=game.getData("choose");this.sort(),$(".slot").removeClass("available"),$(".slot:nth-child(1)").addClass("available"),"s3v3"!=game.size&&"s5v5"!=game.size||($(".slot:nth-child(2)").addClass("available"),$(".slot:nth-child(3)").addClass("available")),"s5v5"==game.size&&($(".slot:nth-child(4)").addClass("available"),$(".slot:nth-child(5)").addClass("available")),game.mode||game.states.changeTo("menu"),game.states.buildState("vs"),game.states.buildState("table"),"library"!=game.mode&&this.selectFirst("force"),game.mode&&game[game.mode].chooseStart&&game[game.mode].chooseStart(a)},buildDeck:function(a){return game.deck.build({name:"heroes",cb:function(a){(game.states.choose.pickDeck=a).addClass("pickdeck").appendTo(game.states.choose.pickbox),$.each(JSON.parse(a.data("cards")),function(a,e){card=$("#"+e),card[0].dataset.index=a,card.on(game.states.choose.event,game.states.choose.select)}),a.width(game.states.choose.size*a.children().length)}})},buildSlots:function(){for(var a=[],e=0;e<5;e+=1)a.push($("<div>").appendTo(this.pickedbox).attr({title:game.data.ui.rightpick}).data("slot",e).addClass("slot available").on("mouseup touchend",this.pick));return a},select:function(a){var e,t=$(this);return t.hasClass&&t.hasClass("card")&&("force"!=a&&t.hasClass("selected")&&!game.events.dragging?t.hasClass("zoom")?($(".choose .pickedbox").removeClass("transparent"),game.states.choose.removeZoom(t)):($(".choose .pickedbox").addClass("transparent"),game.states.choose.addZoom(t)):"force"!=a&&game.events.dragging||("library"==game.mode&&game.library.select(t,a),$(".choose .selected").removeClass("selected draggable"),$(".choose .half").removeClass("half"),t.addClass("selected"),t.prev().addClass("half"),t.next().addClass("half"),"library"!=game.mode&&t.addClass("draggable"),void 0===(e=t.siblings(":visible").addBack().index(t))&&(e=t.index()),game.states.choose.pickDeck.css("left",-.78*e*game.states.choose.size),t.hasClass("dead")||game.setData("choose",t.data("hero")))),game.events.dragging&&a&&a.target&&"touchend"==a.type&&game.states.choose.pick.call($(a.target),a),a&&a.preventDefault&&(game.events.end(a),a.preventDefault()),!1},addZoom:function(a){$(".choose .card").addClass("transparent"),a.addClass("zoom").removeClass("transparent draggable"),$(".choose .slot").addClass("transparent"),game.states.choose.buttonbox.addClass("hidden")},removeZoom:function(a){$(".choose .card").removeClass("transparent"),a.removeClass("zoom"),game.states.choose.buttonbox.removeClass("hidden"),$(".choose .slot").removeClass("transparent"),"library"!=game.mode&&a.addClass("draggable")},enablePick:function(){game.states.choose.pickEnabled=!0,game.states.choose.pickedbox.show()},disablePick:function(){game.states.choose.pickEnabled=!1},pick:function(a){var e,t=$(this).closest(".slot"),s=$(".pickbox .card.selected");if(t.length||(t=$(".slot.drop")),t.length||(t=$(".card.picked.drop").parent()),!s.data("disable")&&game.states.choose.pickEnabled&&"library"!==game.mode&&(game.states.choose.mydeck.attr("disabled",!0),game.audio.play("activate"),t.hasClass("available")?(t.removeClass("available"),e=(e=s.prevAll(":visible").first()).length?e:s.nextAll(":visible").first()):(e=t.children(".card")).on(game.states.choose.event,game.states.choose.select).insertBefore(s).removeClass("picked"),s.addClass("picked").appendTo(t).clearEvents("choose"),game.states.choose.sort(),game.states.choose.select.call(e,"force"),game[game.mode]&&game[game.mode].pick&&game[game.mode].pick()),"touchend"==a.type)return!1},selectFirst:function(a){var e=game.states.choose.pickDeck.children(":visible").first();this.select.call(e,a)},selectHero:function(a,e){a=game.states.choose.pickDeck.children("."+a);this.select.call(a,e)},sort:function(){$(".pickdeck .card").sort(function(a,e){return a.dataset.index-e.dataset.index}).appendTo(".pickdeck")},savedDeck:function(){var a;return $(this).attr("disabled")||($(this).attr("disabled",!0),(a=(a=game.getData("mydeck"))&&a.split(","))&&5==a.length&&(game.states.choose.randombt.attr("disabled",!0),game.states.choose.remember(a),game[game.mode].chooseEnd&&(game.states.choose.selectFirst(),game.timeout(1e3,game[game.mode].chooseEnd)))),!1},remember:function(t){$(".slot").each(function(a){var e=$(this),a=t[a],a=$(".pickbox .card."+a);a&&e.hasClass("available")&&e.append(a).removeClass("available selected"),0===$(".choose .card.selected").length&&game.states.choose.selectFirst()})},randomClick:function(a){return $(this).attr("disabled")||($(this).attr("disabled",!0),game.states.choose.randomFill(),game[game.mode].chooseEnd&&game.timeout(1e3,game[game.mode].chooseEnd)),a.preventDefault(),!1},randomFill:function(a){$(".slot:visible").each(function(){var a,e=$(this);e.hasClass("available")&&(a=$(".pickbox .card").not(".dead, .hidden").randomCard("noseed"),e.append(a).removeClass("available selected"))}),a&&a()},fillPicks:function(t,a){t=t||"player",game[t].picks||(game[t].picks=[],$(".slot").each(function(){var a=$(this),e=a.find(".card");game[t].picks[a.data("slot")]=e.data("hero")})),a&&"player"==t&&game.setData("mydeck",game.player.picks.join("|")),a&&"enemy"==t&&game.setData("mysecdeck",game.enemy.picks.join("|"))},playVideo:function(a){var e;!game.states.choose.videoPlaying&&a?(game.states.choose.videoPlaying=!0,game.states.choose.video.attr({src:"https://www.youtube.com/embed/"+a+"?autoplay=1"}).show(),e=""+(e=game.states.choose.intro.text()).substr(1),game.states.choose.intro.text(e).addClass("playing")):(game.states.choose.videoPlaying=!1,game.states.choose.video.attr({src:"about:blank"}).hide(),e=""+(e=game.states.choose.intro.text()).substr(1),game.states.choose.intro.text(e).removeClass("playing"))},testHeroClick:function(){return game.states.choose.librarytest.attr("disabled")?game.overlay.alert("Sorry but this hero is still under development!"):game.library.chooseEnd(),!1},backClick:function(){var a;return $(this).attr("disabled")||("online"==game.mode?game.online.backClick():"single"==game.mode?game.states.changeTo("campaign"):"local"==game.mode?(a=game.mode,game.clear(),game.setMode(a),game.states.changeTo("config")):(game.clear(),game.states.changeTo("menu")),game.setData("mode",!1)),!1},clear:function(a){$(".slot .card.skills").appendTo(game.library.skills),$(".pickbox .card").removeClass("hidden"),$(".slot").addClass("available"),this.mydeck&&this.mydeck.attr("disabled",!1),this.randombt&&this.randombt.attr("disabled",!1),this.back&&this.back.attr({disabled:!1}),this.counter&&this.counter.hide(),this.pickedbox&&this.pickedbox.hide(),$(".choose .buttonbox .button").not(".back").hide(),this.video&&this.playVideo(),$(".slot .card.heroes").prependTo(this.pickDeck).on(game.states.choose.event,game.states.choose.select),this.sort(),$(".choose .card").removeClass("transparent zoom"),$(".choose .pickedbox").removeClass("transparent"),game.states.choose.lockZoom=!1}},game.states.config={s1v1:{width:9,height:6,tower:"B6",trees:"A2 A3"},s3v3:{width:11,height:7,tower:"B6",trees:"A2 B3 A4"},s5v5:{width:13,height:8,tower:"B7",trees:"A2 A3 A4 B3 D8 J8"},build:function(){this.buttonbox=$("<div>").addClass("buttonbox"),this.title=$("<h1>").addClass("title").text(game.data.ui.choose).appendTo(this.el),this.one=$("<div>").addClass("one button clickSize").text("1v1").on("mouseup touchend",this.clickSize).appendTo(this.buttonbox),this.three=$("<div>").addClass("three button clickSize").text("3v3").on("mouseup touchend",this.clickSize).appendTo(this.buttonbox),this.five=$("<div>").addClass("five button clickSize").text("5v5").on("mouseup touchend",this.clickSize).appendTo(this.buttonbox),this.back=$("<div>").addClass("back button alert").text(game.data.ui.back).on("mouseup touchend",this.backClick).appendTo(this.buttonbox),this.el.append(this.buttonbox)},start:function(){game.mode||game.states.changeTo("menu"),game.message.text(game.player.name+" Config "+game.mode),this.title.addClass("show")},enable:function(){$(".config .button.clickSize").attr("disabled",!1)},disable:function(){$(".config .button.clickSize").attr("disabled",!0)},validSizes:["s1v1","s3v3","s5v5"],size:function(a,e){a&&0<=game.states.config.validSizes.indexOf(a)&&(game.size=a,game.setData("size",a),game.states.config.clearSize(),game.container.addClass(a))},clearSize:function(){game.container.removeClass(game.states.config.validSizes.join(" "))},clickSize:function(){var a=$(this);a.attr("disabled")||(a.hasClass("one")?game.states.config.size("s1v1"):a.hasClass("three")?game.states.config.size("s3v3"):game.states.config.size("s5v5"),"online"==game.mode&&game.online.start(),"library"==game.mode?game.states.changeTo("vs"):game.states.changeTo("choose"))},backClick:function(){return $(this).attr("disabled")||("library"==game.mode?game.states.changeTo("choose"):(game.clear(),game.states.changeTo("menu"))),!1},end:function(){this.title.removeClass("show")}},game.states.loading={updating:0,totalUpdate:10,build:function(){this.el=$(".state.loading").removeClass("hidden"),this.h2=$(".state.loading .loadtext"),this.box=$(".state.loading .box")},start:function(){game.debug&&game.states.loading.ping(),game.states.loading.package(),game.language.load(function(){game.states.loading.updated(),game.states.loading.json("values",game.states.loading.updated),game.states.loading.json("campaign",game.states.loading.updated),game.states.loading.json("units",game.states.loading.updated,!0),game.states.loading.json("ui",game.states.loading.updated,!0),game.states.loading.json("heroes",game.states.loading.updated,!0),game.states.loading.json("skills",game.states.loading.updated,!0),game.states.loading.json("items",game.states.loading.updated,!0)}),game.states.loading.rank(),game.states.loading.progress()},updated:function(){game.states.loading.updating+=1,game.states.loading.progress()},progress:function(){var a=parseInt(game.states.loading.updating/game.states.loading.totalUpdate*100);$(".progress").text(a+"%"),game.states.loading.updating>=game.states.loading.totalUpdate&&game.states.loading.finished()},preloadimgs:["log/sky.jpg","log/towers.png","log/title.png","log/front.png","menu/ground.png","menu/sky.png","menu/mountains.png","menu/icons.png","menu/bush.png","menu/dolls.png"],imgload:0,finished:function(){game.states.loading.box.addClass("hidden"),game.container.append(game.topbar).addClass("loaded"),game.options.build(),game.states.build(function(){game.rank.build(),$.each(game.states.loading.preloadimgs,function(){$("<img>").attr("src",game.imageServer+"/"+this).on("load",function(){game.states.loading.imgload++,game.states.loading.imgload==game.states.loading.preloadimgs.length&&game.states.menu.el.addClass("loaded")}).appendTo(game.hidden)}),game.achievements.build(),game.timeout(400,function(){game.screen.resize(),game.history.recover()})})},json:function(e,t,a){var s=game.dynamicHost+"json/"+e+".json";a&&(s=game.dynamicHost+"json/"+game.language.dir+e+".json"),$.ajax({type:"GET",url:s,complete:function(a){a=JSON.parse(a.responseText);game.data[e]=a,t&&t(a)}})},package:function(){$.ajax({type:"GET",url:game.dynamicHost+"package.json",complete:function(a){game.states.loading.updated();a=JSON.parse(a.responseText);$.each(a,function(a){game[a]=this})}})},ping:function(e){var t=new Date;$.ajax({type:"GET",url:game.dynamicHost,complete:function(a){game.ping=new Date-t,4===a.readyState&&location.host.search("localhost")<0?game.offline=!1:game.offline=!0,e&&e()}})},rank:function(){game.db({get:"rank"},function(a){game.rank.db||game.states.loading.updated(),game.rank.db=!0,5==game.rank.sortData(a).length?(game.rank.data=a,game.rank.el&&game.rank.update(a)):setTimeout(game.states.loading.rank,3e3)})}},game.states.log={remembername:!0,build:function(){this.box=$("<div>").addClass("box").hide(),this.parallax=$("<div>").addClass("parallax"),this.towers=$("<div>").appendTo(this.parallax).addClass("logpara towers"),this.title=$("<div>").appendTo(this.parallax).addClass("logpara title"),this.parallax.append(this.box),this.front=$("<div>").appendTo(this.parallax).addClass("logpara front"),this.form=$("<form>").appendTo(this.box).on("submit",function(a){return a.preventDefault(),!1}),this.input=$("<input>").appendTo(this.form).attr({placeholder:game.data.ui.choosename,type:"text",required:"required",minlength:3,maxlength:24,tabindex:1}).keydown(function(a){if(13===a.which)return game.states.log.login(),!1}),this.button=$("<button>").addClass("button").appendTo(this.form).text(game.data.ui.log).attr({type:"submit"}).on("mouseup touchend",this.login),this.rememberlabel=$("<label>").addClass("remembername").appendTo(this.form).append($("<span>").text(game.data.ui.remember)),this.remembercheck=$("<input>").attr({type:"checkbox",name:"remember",checked:!0}).change(this.remember).appendTo(this.rememberlabel),this.out=$("<small>").addClass("logout").hide().insertAfter(game.message).text(game.data.ui.logout).on("mouseup touchend",this.logout);var a=game.getData("name");a&&this.input.val(a),this.el.append(this.parallax)},start:function(){game.states.log.out.hide(),game.options.opt.show(),game.loader.removeClass("loading"),game.triesCounter.text(""),setTimeout(function(){game.screen.resize()},1e3),game.states.log.input.attr({value:"Player"+parseInt(1e4*Math.random())}),game.states.log.alert||(game.states.log.alert=!0,game.states.log.alertBox(),!game.getData("voted")&&game.poll.heroes&&game.poll.button.show())},alertBox:function(){var a=$("<div>").addClass("log box");game.overlay.el.removeClass("hidden").append(a),game.overlay.cb=game.poll.close,a.append($("<h1>").text(game.data.ui.warning)),a.append($("<p>").html(game.data.ui.alphaalert+'<small class="version">'+game.version+"</small>")),game.poll.button=$("<div>").hide().addClass("button highlight large").text(game.data.ui.votenexthero).on("mouseup touchend",game.poll.showVotes),a.append($("<a>").text("Rating: Eveyone 10+ ESRB").addClass("rating").attr({rel:"nofollow noopener",href:"http://www.esrb.org/ratings/ratings_guide.aspx#rating_categories"})),a.append(game.poll.button),a.append($("<div>").addClass("button").text(game.data.ui.close).on("mouseup touchend",game.poll.close))},login:function(){var a=game.states.log.input[0].checkValidity(),e=game.states.log.input.val();return e&&a?(game.player.name=e,game.states.log.remembername?game.setData("name",e):game.setData("name",!1),game.setData("logged",!0),game.setData("last-activity",(new Date).valueOf()),game.states.log.button.attr("disabled",!0),game.chat.build(game.data.ui.joined),"AudioContext"in window&&game.audio.build(),game.states.changeTo("menu")):game.states.log.input.focus(),!1},logout:function(){return game.overlay.confirm(function(a){a&&(game.audio.stopSong(),game.setData("logged",!1),game.clear(),game.chat.el.hide(),game.states.changeTo("log"))}),!1},remember:function(){game.states.log.remembername=!game.states.log.remembername},end:function(){this.button.attr("disabled",!1)}},game.states.menu={build:function(){this.parallax=$("<div>").appendTo(this.el).addClass("parallax"),this.sky=$("<div>").appendTo(this.parallax).addClass("sky"),this.stars=$("<div>").appendTo(this.parallax).addClass("stars");for(var a=0;a<10;a++)$("<div>").appendTo(this.stars).addClass("star");for(this.sun=$("<div>").appendTo(this.parallax).addClass("sun"),this.cloud=$("<div>").appendTo(this.parallax).addClass("cloud"),this.mountains=$("<div>").appendTo(this.parallax).addClass("mountains"),this.eyes=$("<div>").appendTo(this.mountains).addClass("eyes"),a=0;a<8;a++)$("<div>").appendTo(this.eyes).addClass("eye");this.boom=$("<div>").appendTo(this.mountains).addClass("boom map").on("mouseup touchend",this.boomClick),this.fire=$("<div>").appendTo(this.parallax).addClass("fire hidden").on("mouseup tap",function(){$(this).toggleClass("hidden")}),this.ground=$("<div>").appendTo(this.parallax).addClass("ground"),this.amdoll=$("<div>").appendTo(this.parallax).addClass("amdoll"),this.cmdoll=$("<div>").appendTo(this.parallax).addClass("cmdoll"),this.bush=$("<div>").appendTo(this.parallax).addClass("bush"),this.icons=$("<div>").appendTo(this.el).addClass("icons"),this.tutorial=$("<div>").addClass("tutorial icon").appendTo(this.icons).attr({title:game.data.ui.choosetutorial}).append($("<span>").text(game.data.ui.tutorial)).on("mouseup touchend",function(){game.setMode("tutorial"),game.states.changeTo("choose")}),this.campaign=$("<div>").addClass("campaign icon").appendTo(this.icons).attr({title:game.data.ui.choosecampaign}).append($("<span>").text(game.data.ui.campaign)).on("mouseup touchend",function(){game.setMode("single"),game.states.changeTo("campaign")}),this.online=$("<div>").addClass("online icon").appendTo(this.icons).attr({title:game.data.ui.chooseonline}).append($("<span>").text(game.data.ui.online)).on("mouseup touchend",function(){game.setMode("online"),game.online.check("first")}),(game.getData("tutorial")?game.getData("campaign")?this.online:this.campaign:this.tutorial).addClass("highlight"),this.local=$("<div>").addClass("local icon").appendTo(this.icons).attr({title:game.data.ui.chooselocal}).append($("<span>").text(game.data.ui.local)).on("mouseup touchend",function(){game.setMode("local"),game.states.changeTo("config")}),this.library=$("<div>").addClass("library icon").appendTo(this.icons).attr({title:game.data.ui.chooselibrary}).append($("<span>").text(game.data.ui.library)).on("mouseup touchend",function(){game.setMode("library"),game.states.changeTo("choose")}),this.credits=$("<a>").addClass("credits icon").appendTo(this.icons).attr({title:game.data.ui.choosecredits}).append($("<span>").text(game.data.ui.credits)).on("mouseup touchend",function(){var a=$("<div>").addClass("credits box"),e=$("<div>").addClass("credithide").appendTo(a);$("<div>").addClass("creditscroll").appendTo(e).append($("<h1>").text(game.data.ui.credits)),a.append($("<div>").addClass("button").text(game.data.ui.ok).on("mouseup touchend",function(){return game.overlay.clear(),!1})),game.overlay.el.removeClass("hidden").append(a)})},start:function(){game.clear(),game.loader.removeClass("loading"),game.triesCounter.text(""),game.message.text(game.data.ui.welcome+" "+game.player.name+"!"),game.states.buildState("campaign"),game.states.buildState("choose"),game.states.buildState("config"),game.states.log.out.show(),game.rank.update(game.rank.data),game.audio.loopSong("SneakyAdventure"),game.states.menu.boomCount=0},addToHome:function(){game.events.deferredPrompt&&game.timeout(2e3,function(){game.overlay.confirm(function(a){a&&game.events.deferredPrompt.prompt(),game.events.deferredPrompt=null},"Add to home screen","home")})},boomCount:0,boomClick:function(){game.states.menu.boomCount++;var a,e=$(this);!e.hasClass("playing")&&9<game.states.menu.boomCount&&(game.states.menu.boomCount=0,a=["lina-stun","wk-stun-hit"],a=$("<span>").addClass("fx "+a[parseInt(Math.random()*a.length)]).on("animationend webkitAnimationEnd MSAnimationEnd oAnimationEnd",function(){this.remove()}),e.addClass("playing").append(a),clearTimeout(game.states.menu.boomTimeout),game.states.menu.boomTimeout=setTimeout(function(){game.states.menu.boom.removeClass("playing")},2e3))}},game.states.result={build:function(){this.resultsbox=$("<div>").addClass("resultsbox box"),this.title=$("<h1>").appendTo(this.resultsbox).addClass("resultTitle"),this.sub=$("<div>").addClass("sub").appendTo(this.resultsbox),this.towers=$("<h1>").appendTo(this.sub),this.kills=$("<h1>").appendTo(this.sub),this.deaths=$("<h1>").appendTo(this.sub),this.turns=$("<h1>").appendTo(this.sub),this.playerResults=$("<div>").appendTo(this.resultsbox).addClass("results"),this.enemyResults=$("<div>").appendTo(this.resultsbox).addClass("results enemy"),$("<div>").addClass("button close").appendTo(this.resultsbox).text(game.data.ui.close).on("mouseup touchend",this.close),this.el.append(this.resultsbox),this.parallax=$("<div>").addClass("parallax bkgdeck"),this.el.prepend(this.parallax).addClass("iddle")},playerHeroResult:function(){var a=$("#"+this),e=a.data("hero"),t=$("<div>").addClass("portrait").append($("<div>").addClass("img")),a=$("<span>").text(a.data("name")+": "+a.data("kills")+" / "+a.data("deaths"));$("<p>").data("hero",e).addClass(e+" heroes").append(a,t).appendTo(game.states.result.playerResults)},enemyHeroResult:function(){var a=$("#"+this),e=a.data("hero"),t=$("<div>").addClass("portrait").append($("<div>").addClass("img")),a=$("<span>").text(a.data("name")+": "+a.data("kills")+" / "+a.data("deaths"));$("<p>").data("hero",e).addClass(e+" heroes").append(t,a).appendTo(game.states.result.enemyResults)},start:function(a){this.update(),a&&this.close()},update:function(){this.clear(),game.rank.send(),game.audio.stopSong(),game.audio.loopSong("SneakyAdventure"),"tutorial"==game.mode&&game.tutorial.axe.addClass("show").appendTo(this.el);var a=game.data.ui.win,e=game.player.name,t=game.player.picks;game.winner!=game.player.type&&(a=game.data.ui.lose,e=game.enemy.name,t=game.enemy.picks),this.bkgdeck(t),"local"==game.mode&&(a=game.data.ui.lose);t=e+" "+game.data.ui.victory;$(JSON.parse(game.player.heroesDeck.data("cards"))).each(this.playerHeroResult),$(JSON.parse(game.enemy.heroesDeck.data("cards"))).each(this.enemyHeroResult);e=game.states.result.playerResults.children();e.sort(function(a,e){return game.player.picks.indexOf($(a).data("hero"))-game.player.picks.indexOf($(e).data("hero"))}),game.states.result.playerResults.append(e),(e=game.states.result.enemyResults.children()).sort(function(a,e){return game.enemy.picks.indexOf($(e).data("hero"))-game.enemy.picks.indexOf($(a).data("hero"))}),game.states.result.enemyResults.append(e),game.message.text(a),this.title.text(t),this.towers.text(game.data.ui.towers+" HP: "+game.player.tower.data("current hp")+"/"+game.enemy.tower.data("current hp")),this.kills.text(game.data.ui.kills+": "+game.player.kills+"/"+game.enemy.kills),this.deaths.text(game.data.ui.death+": "+game.player.deaths+"/"+game.enemy.deaths),this.turns.text(game.data.ui.turns+": "+game.player.turn+"/"+game.enemy.turn+" ("+game.totalTurns+")")},close:function(){return"single"==game.mode?(game.single.started=!1,game.states.table.clear(),game.states.vs.clear(),game.states.choose.clear(),game.matchClear(),game.states.changeTo("campaign")):(game.clear(),game.states.changeTo("menu")),!1},bkgdeck:function(a){game.states.choose.clear(),game.states.result.parallax.empty(),$(a).each(function(a,e){e&&$(".pickbox .card."+e).clone().appendTo(game.states.result.parallax)})},clear:function(){$(".result .results .heroes").remove(),this.title.text(""),this.towers.text(""),this.kills.text(""),this.deaths.text(""),this.turns.text("")}},game.states.table={build:function(){game.camera=$("<div>").addClass("camera"),this.selectedArea=$("<div>").addClass("selectedarea"),this.selectedCard=$("<div>").addClass("selectedcard").appendTo(this.selectedArea),this.cardBack=$("<div>").addClass("cardback").appendTo(this.selectedCard),this.treeDeck=$("<div>").appendTo(this.el).addClass("tree-deck"),this.player=$("<div>").addClass("playerdecks player"),this.enemy=$("<div>").addClass("enemydecks enemy"),this.buttonbox=$("<div>").addClass("buttonbox"),this.surrender=$("<div>").appendTo(this.buttonbox).addClass("surrender alert button").text(game.data.ui.surrender).on("mouseup touchend",this.surrenderClick),this.back=$("<div>").hide().appendTo(this.buttonbox).addClass("back alert button").text(game.data.ui.back).on("mouseup touchend",this.backClick),this.shop=$("<div>").appendTo(this.buttonbox).addClass("shop button").attr({disabled:!0}).text(game.data.ui.shop).on("mouseup touchend",game.skill.shopDicardClick),this.skip=$("<div>").appendTo(this.buttonbox).addClass("skip button highlight").attr({disabled:!0,title:"SPACE"}).text(game.data.ui.skip).on("mouseup touchend",this.skipClick),this.el.append(game.camera).append(this.selectedArea).append(this.buttonbox).append(this.player).append(this.enemy),game.fx.buildUlt()},start:function(a){game.turn.el&&(game.turn.time.show(),game.turn.msg.show()),game.mode&&!game.states.table.setup&&(game.states.table.setup=!0,game.items.build(),game.tower.place(),game.tree.place(),game.states.table.forestSpot(),game.states.table.fountainSpot()),game.states.buildState("result"),game.states.table.recover()},recover:function(){game.recovering&&game.getData(game.player.type+"Deck")?game.history.recoverMatch():game.player.picks&&game.player.picks.length?game[game.mode||"library"].setTable():game.states.changeTo("menu")},music:function(){"library"==game.mode?game.audio.loopSong("Perspectives"):game.audio.loopSong("DeathandAxes")},enableUnselect:function(){game.states.table.el.on("mousedown touchstart",function(a){$(a.target).closest(".button, .card, .movearea, .targetarea").length||(game.card.unselect(),game.mode&&game[game.mode].unselected&&game[game.mode].unselected())})},forestSpot:function(){$("#A1, #"+game.map.mirrorPosition("A1")).addClass("jungle").attr({title:game.data.ui.jungle})},fountainSpot:function(){var a="A"+game.height;$("#"+a+", #"+game.map.mirrorPosition(a)).addClass("fountain").attr({title:game.data.ui.heal})},skipClick:function(){return!game.states.table.skip.attr("disabled")&&game.canPlay()&&(game.states.table.skip.attr("disabled",!0),game.turn.stopCount(),game[game.mode].skip&&game[game.mode].skip(),game.highlight.refresh()),!1},surrenderClick:function(){if(!game.states.table.surrender.attr("disabled"))return game.overlay.confirm(function(a){a&&game.mode&&game[game.mode].surrender&&game[game.mode].surrender()},game.data.ui.leave),!1},backClick:function(){return game.audio.stopSong(),game.states.table.clear(!0),game.states.changeTo("choose"),!1},clear:function(a){this.selectedCard&&this.selectedCard.removeClass("flip"),game.states.table.setup=!1,a||game.matchClear(),game.card.clearSelection(),game.fx.clear(),game.audio.stopSong(),$(".deck",game.states.table.el).remove(),$(".card",game.states.table.el).remove(),$(".card",game.hidden).remove(),game.items.clear(),this.back.hide(),this.surrender.show().attr("disabled",!0),game.skill.disableDiscard(),game.map.el&&game.map.el.remove(),this.skip.attr("disabled",!0),this.el.removeClass("turn"),game.turn.el&&game.turn.el.removeClass("show"),game.states.table.el.removeClass("turn"),game.clearTimeouts()},end:function(){game.turn.el&&(game.turn.el.removeClass("show"),game.turn.msg.hide(),game.turn.time.hide())}},game.states.unsupported={build:function(){this.box=$("<div>").addClass("box"),this.logo=$("<div>").appendTo(this.box).addClass("logo slide"),this.h2=$("<h1>").appendTo(this.box).html("DotaCard requires a <i>modern browser</i>"),this.p=$("<p>").appendTo(this.box).html('<a href="http://whatbrowser.org/" rel="nofollow noopener">How can I get a <i>modern browser</i>?</a>'),this.el.append(this.box)}},game.states.vs={build:function(){this.parallax=$("<div>").addClass("parallax"),this.player=$("<div>").addClass("vsplayer slide"),this.playername=$("<h1>").appendTo(this.player),this.playerdeck=$("<div>").addClass("vsdeckplayer").appendTo(this.player),this.playerinfo=$("<div>").addClass("vsplayerinfo").appendTo(this.player),this.vs=$("<p>").text("VS").addClass("versus").appendTo(this.el),this.enemy=$("<div>").addClass("vsenemy slide"),this.enemyname=$("<h1>").appendTo(this.enemy),this.enemydeck=$("<div>").addClass("vsdeckenemy").appendTo(this.enemy),this.enemyinfo=$("<div>").addClass("vsenemyinfo").appendTo(this.enemy),this.parallax.append(this.player),this.parallax.append(this.enemy),this.el.append(this.parallax)},start:function(a){this.clear(),game.message.text(game.data.ui.battle),a&&"online"==game.mode?game.states.changeTo("log"):(game.audio.stopSong(),"library"!==game.mode?game.audio.play("RandomEncounter",!1,"music",game.states.table.music):setTimeout(game.states.table.music,1600),this.buildPlayer(),this.buildEnemy(),this.buildMap(),this.player.removeClass("slide"),this.enemy.removeClass("slide"),game.units.build("player"),game.units.build("enemy"),this.toTable())},buildMap:function(){game.size||(game.size=game.history.size||game.getData("size")||"s5v5"),game.width=game.states.config[game.size].width,game.height=game.states.config[game.size].height,game.map.el&&game.map.el.remove(),game.map.build().prependTo(game.camera)},buildPlayer:function(){this.playername.text(game.player.name),game.player.type||(game.player.type="challenged"),game.player.picks=game.states.vs.playerPicks(),game.deck.build({name:"heroes",filter:game.player.picks,cb:function(a){a.addClass("vsplayerdeck").appendTo(game.states.vs.playerdeck);var e=a.children();e.sort(function(a,e){return game.player.picks.indexOf($(a).data("hero"))-game.player.picks.indexOf($(e).data("hero"))}),a.append(e)}}),game.skill.calcMana("player"),"library"!=game.mode?this.playerinfo.text(game.data.ui.cardsperturn+": "+game.player.cardsPerTurn):(game.player.cardsPerTurn=10,this.playerinfo.text(game.data.ui.mana+": "+$(".vsplayerdeck .card").data("mana")))},buildEnemy:function(){"tutorial"==game.mode&&(game.enemy.name=game.data.ui.tutorial),"library"==game.mode&&(game.enemy.name=game.data.ui.library),"single"==game.mode&&(game.enemy.name=game.states.campaign.stage.name),"local"==game.mode&&(game.enemy.name="Challenger"),game.setData("enemyname",game.enemy.name),this.enemyname.text(game.enemy.name),game.enemy.type||(game.enemy.type="challenger"),game.enemy.picks=game.states.vs.enemyPicks(),game.deck.build({name:"heroes",filter:game.enemy.picks,cb:function(a){a.addClass("vsenemyrdeck").appendTo(game.states.vs.enemydeck);var e=a.children();e.sort(function(a,e){return game.enemy.picks.indexOf($(a).data("hero"))-game.enemy.picks.indexOf($(e).data("hero"))}),a.append(e)}}),game.skill.calcMana("enemy"),this.enemyinfo.text(game.data.ui.cardsperturn+": "+game.enemy.cardsPerTurn)},playerPicks:function(){var a,e;return"library"==game.mode?(game.library.hero?a=game.library.hero:(a=game.getData("choose"),game.library.hero=a),[a]):"single"==game.mode?("start"==game.states.campaign.stage.id?(e=game.player.picks,game.single.playerpicks=game.player.picks,game.setData("mydeck",game.player.picks.join("|"))):e=(e=game.single.playerpicks)||game.getData("mydeck").split("|"),e):(!(e=game.player.picks)&&game.recovering&&(e=game.getData(game.player.type+"Deck").split("|")),e&&5===e.length?e:void 0)},enemyPicks:function(){var a;return"library"==game.mode?"s1v1"==game.size?[game.library.hero]:"s3v3"==game.size?["ld","am","wind"]:["lina","pud","wk","com","cm"]:"tutorial"==game.mode?["wk","cm","am","pud","ld"]:"single"==game.mode?game.single.enemypicks:"online"!=game.mode&&"local"!=game.mode||(!(a=game.enemy.picks)&&game.recovering&&(a=game.getData(game.enemy.type+"Deck").split("|")),!a||5!==a.length)?void 0:a},toTable:function(){var a=4600;"library"==game.mode&&(a=1600),game.timeout(a-300,function(){this.player.addClass("slide"),this.enemy.addClass("slide"),game.fx.build()}.bind(this)),game.timeout(a,function(){game.states.vs.clear(),game.setData(game.player.type+"Deck",game.player.picks.join("|")),game.setData(game.enemy.type+"Deck",game.enemy.picks.join("|")),game.states.changeTo("table")})},clear:function(){$(".card",game.states.vs.el).remove()},end:function(){}},game.buff={extendjQuery:function(){$.fn.extend({selfBuff:game.buff.selfBuff,addStun:game.buff.addStun,addBuff:game.buff.addBuff,hasBuff:game.buff.hasBuff,getBuff:game.buff.getBuff,removeBuff:game.buff.removeBuff,clearBuffs:game.buff.clearBuffs,purge:game.buff.purge})},addStun:function(a,e,t){var s;return a.hasClass("towers")||a.hasClass("cycloned")||(s=e.data("stun"),a.stopChanneling(),a.removeInvisibility(),a.removeClass("can-attack"),t&&(s+=t),a.hasClass("stunned")?a.removeBuff("stun"):a.addClass("stunned"),this.addBuff(a,{name:"Stun",buffId:"stun",className:"stun",source:this,skill:e,duration:s,description:"Unit is stunned and cannot move, attack or cast"})),this},selfBuff:function(a,e,t,s){return this.addBuff(this,a,e,t,s)},addBuff:function(a,e,t,s,n){var i=$(this);if(!a.hasClass("cycloned")&&(!a.hasClass("towers")||s)){var o,r=e;if(t?t&&"string"==typeof t&&(s=t.split("-"),"string"==typeof r.buffs?o=JSON.parse(r.buffs):e instanceof jQuery&&e.data("buffs")&&(o=JSON.parse(e.data("buffs"))),o[s[0]]&&o[s[0]][s[1]]&&(r=o[s[0]][s[1]])):e instanceof jQuery&&(r=JSON.parse(e.data("buff"))),r){r.buffId||(r.buffId=t||r.skillId),!r.buffId&&e.data&&e.data("skillId"),r.className||(r.className=r.buffId),!r.name&&e.data&&(r.name=e.data("name")),r.source||(r.source=this.attr("id")),!r.skill&&e.attr&&(r.skill=e.attr("id")),r.target||(r.target=a.attr("id")),!r.description&&e.data&&(r.description=e.data("description")),r.duration&&!r.unpurgeable&&(r.className+=" purgeable "+(i.side()||game.selectedCard.side())),e.hasClass&&e.hasClass("items")&&(r.className+=" items "+e.data("itemtype")),a.removeBuff(r.buffId);var d=$("<div>").addClass("buff "+r.className).attr({title:r.name+": "+r.description});return $.each(r,function(a,e){!e||"Array"!=e.constructor.name&&"Object"!=e.constructor.name||(e=JSON.stringify(e)),d.data(a,e)}),$("<div>").appendTo(d).addClass("img"),$("<div>").appendTo(d).addClass("overlay"),r.duration&&d.append($("<span>").text(r.duration)),n||(r["hp bonus"]&&"number"==typeof r["hp bonus"]&&(a.setHp(a.data("hp")+r["hp bonus"]),a.setCurrentHp(a.data("current hp")+r["hp bonus"])),r["damage bonus"]&&"number"==typeof r["damage bonus"]&&a.setDamage(a.data("current damage")+r["damage bonus"]),r["damage reduction"]&&"number"==typeof r["damage reduction"]&&a.setDamage(a.data("current damage")-r["damage reduction"]),r["armor bonus"]&&"number"==typeof r["armor bonus"]&&a.setArmor(a.data("current armor")+r["armor bonus"]),r["armor reduction"]&&"number"==typeof r["armor reduction"]&&a.setArmor(a.data("current armor")-r["armor reduction"]),r["resistance bonus"]&&"number"==typeof r["resistance bonus"]&&a.setResistance(a.data("current resistance")+r["resistance bonus"]),r["resistance reduction"]&&"number"==typeof r["resistance reduction"]&&a.setResistance(a.data("current resistance")-r["resistance reduction"]),r["speed bonus"]&&"number"==typeof r["speed bonus"]&&a.setSpeed(a.data("current speed")+r["speed bonus"]),r["speed slow"]&&"number"==typeof r["speed slow"]&&a.setSpeed(a.data("current speed")-r["speed slow"]),r["range bonus"]&&"number"==typeof r["range bonus"]&&a.setRange(a.data("range")+r["range bonus"])),a.find(".buffs").append(d),a.reselect(),d}}},hasBuff:function(a){return this.find(".buffs ."+a).length},getBuff:function(a){return this.find(".buffs ."+a)},removeBuff:function(a,n){var e,i=this;return a.hasClass&&a.hasClass("buff")?(e=a,n=!0):n?"all"==n?e=$(".buff:not([class*=aura])",i):"purge"==n&&(e=$(".buff.purgeable."+i.opponent(),i)):e=a.split(" "),$.each(e,function(a,e){var t,s=n?$(e):i.find(".buffs > ."+e);s&&s.data&&((t=s.data())&&(t["hp bonus"]&&"number"==typeof t["hp bonus"]&&(i.setHp(i.data("hp")-t["hp bonus"]),(e=i.data("current hp")-t["hp bonus"])<1&&(e=1),i.setCurrentHp(e)),"stun"==t.buffId&&i.removeClass("stunned"),t["damage bonus"]&&"number"==typeof t["damage bonus"]&&i.setDamage(i.data("current damage")-t["damage bonus"]),t["damage reduction"]&&"number"==typeof t["damage reduction"]&&i.setDamage(i.data("current damage")+t["damage reduction"]),t["armor bonus"]&&"number"==typeof t["armor bonus"]&&i.setArmor(i.data("current armor")-t["armor bonus"]),t["armor reduction"]&&"number"==typeof t["armor reduction"]&&i.setArmor(i.data("current armor")+t["armor reduction"]),t["resistance bonus"]&&"number"==typeof t["resistance bonus"]&&i.setResistance(i.data("current resistance")-t["resistance bonus"]),t["resistance reduction"]&&"number"==typeof t["resistance reduction"]&&i.setResistance(i.data("current resistance")+t["resistance reduction"]),t["speed bonus"]&&"number"==typeof t["speed bonus"]&&i.setSpeed(i.data("current speed")-t["speed bonus"]),t["speed slow"]&&"number"==typeof t["speed slow"]&&i.setSpeed(i.data("current speed")+t["speed slow"]),t["range bonus"]&&"number"==typeof t["range bonus"]&&i.setRange(i.data("range")-t["range bonus"])),s.trigger("expire",{target:i,buff:s}),s.remove())}),"purge"!=n||(e=$(".buff.eul",i)).length&&(i.removeClass("cycloned"),e.remove()),i.reselect(),this},purge:function(){this.removeStack("rooted").removeStack("disarmed"),game.fx.stop(this.opponent(),this),this.removeBuff(0,"purge")},turn:function(n){n.find(".buffs > .buff").each(function(a,e){var t=$(e),s=t.data("duration"),e=t.data("buffId");t.trigger("buffcount",{target:n,buff:t}),s&&"Number"==s.constructor.name&&(1<s?(--s,t.data("duration",s),$("span",t).text(s),t.closest(".card").reselect()):e&&n.removeBuff(e))})}},game.fx={ultList:{},heroes:{am:{blink:["blink"],mirror:["mirror"],burn:["burn"],ult:["ult"]},axe:{taunt:["taunt"],enrage:["enrage"],fire:["fire"],counter:["counter"],ult:["ult","ult-kill"]},cm:{slow:["slow"],freeze:["freeze"],ult:["ult","ult1","ult2","ult3"]},cat:{arrow:["arrow","arrow-impact","arrow-source","arrow-source-horiz"],star:["star"],leap:["leap","leap-path"],ult:["ult"]},ld:{link:["link"],roar:["roar"],cry:["cry"],return:["return","return-target"],root:["root"]},lina:{fire:["fire"],stun:["stun"],passive:["passive"],ult:["ult-close","ult-far"]},nyx:{stun:["stun","stun1"],burn:["burn"],spike:["spike"]},pud:{hook:["hook"],rot:["rot"],ult:["ult"]},kotl:{illuminate:["illuminate"],mana:["mana"],leak:["leak"],ult:["ult"],blind:["blind"],recall:["recall","recall-source"]},venge:{stun:["stun"],aura:["aura","target"],corruption:["corruption","corruption1"],ult:["ult"]},wind:{arrow:["arrow"]},wk:{stun:["stun","stun-hit"],lifesteal:["lifesteal"]},meteor:{cast:["ult"]},projectile:{hit:["hit"]}},build:function(){$("<img>").appendTo(game.hidden).attr({src:game.imageServer+"/fx/ultfx.png"});var e=[];$.each(game.player.picks,function(a,s){$.each(game.fx.heroes[s],function(t,a){a&&$.each(a,function(a,e){game.fx.preload(s,e,t)})}),e.push(s)}),$.each(game.enemy.picks,function(a,s){e.indexOf(s)<0&&$.each(game.fx.heroes[s],function(t,a){a&&$.each(a,function(a,e){game.fx.preload(s,e,t)})}),$.each(["cm"],function(a,e){$("<img>").addClass(e+"-ult-fx").appendTo(game.hidden).attr({src:game.imageServer+"/skills/"+e+"/ult-fx.png"})})})},preload:function(a,e,t){var s=a+"-"+e;game.hidden.children("."+s).length||$("<img>").addClass(s).appendTo(game.hidden).attr({src:game.imageServer+"/fx/"+a+"/"+e+".png"})},offset:{x:210,y:310},imgs:[],add:function(a,e,t,s,n,i,o){t=t||e;var r=a.split("-"),d=r[0],l=r[1];if(!game.recovering&&game.fx.heroes[d]&&game.fx.heroes[d][l]){game.fx.stop(a,e);var m=(m=$(e).side())||"neutral";i=i||"";r=$("<div>").addClass(a+" fx fx-"+d+" "+m+" "+i),a=e.getX()-t.getX(),m=e.getY()-t.getY();return"linear"==s&&(i=e.getDirectionStr(t),r.addClass(i+" d"+Math.abs(a||m))),"target"==s&&(1<Math.abs(a)||1<Math.abs(m)?r.addClass("far"):r.addClass("close"),r.addClass("r"+a+m)),"rotate"==s&&(m=180*Math.atan2((e.getX()-t.getX())*game.fx.offset.y,(t.getY()-e.getY())*game.fx.offset.y)/Math.PI,r.data("rotate",m).appendTo(game.map.el),game.fx.projectileMove(r,t,o.scale,o.offset),n=n||game.map.el),"flip"==s&&t.getX()<e.getX()&&r.addClass("flip"),"random"==s&&(d=game.fx.heroes[d][l].length,(d=Math.floor(Math.random()*d))&&r.addClass(l+d),game.timeout(50+600*Math.random(),game.fx.append.bind(this,r,t,n))),"random"!==s&&game.fx.append(r,t,n),"keep"!=s&&r.on("animationend webkitAnimationEnd MSAnimationEnd oAnimationEnd",function(){this.remove()}),t.closest(".card").reselect(),r}},append:function(a,e,t){t?a.appendTo(t):a.appendTo(e),game.fx.play(a)},play:function(a){a[0].style.animationPlayState="running"},pause:function(a){a[0].style.animationPlayState="paused"},hide:function(a){game.fx.pause(a),a.removeClass("top bottom right left far close r-1-1 r-10 r-11 r0-1 r00 r01 r1-1 r10 r11 r-21 r-20 r-2-1 r21 r20 r2-1 r-1-2 r0-2 r1-2 r-12 r02 r12").appendTo(game.hidden)},stop:function(a,e){e.find(".fx."+a).remove()},projectile:function(a,e,t,s){if(!game.recovering){var n=a.data("hero");a.hasClass("towers")&&(n="towers "+a.side()),a.hasClass("units")&&(n="units "+a.data("label")+" "+a.side()),t&&("string"==typeof t?n+=" "+t:n=t.data("hero"));t=$("<div>").addClass("projectile "+n),n=180*Math.atan2((a.getX()-e.getX())*game.fx.offset.y,(e.getY()-a.getY())*game.fx.offset.y)/Math.PI;return t.data("rotate",n).appendTo(game.map.el),game.fx.projectileMove(t,a,s),game.timeout(65,game.fx.projectileMove.bind(this,t,e,s)),game.timeout(465,t.remove.bind(t)),t}},projectileMove:function(a,e,t,s){var n,i;t=t||2.5,a&&e&&(n=a.data("rotate")||0,i=e.getX(),e=e.getY(),s?a.css({transform:"translate(-50%, -50%) translate3d("+(110+i*game.fx.offset.x)+"px,"+(160+e*game.fx.offset.y)+"px, 20px) rotate("+n+"deg) translate("+(s.x||0)+"px,"+(s.y||0)+"px) scale("+t+")"}):a.css({transform:"translate(-50%, -50%) translate3d("+(110+i*game.fx.offset.x)+"px,"+(160+e*game.fx.offset.y)+"px, 20px) rotate("+n+"deg) scale("+t+")"}))},textDelay:600,text:function(a,e,t,s){if("z"==e)for(var n=0;n<3;n++)game.timeout(1e3*n,game.fx.sleep.bind(this,a));else(0<t||"string"==typeof t)&&(e=$("<span>").addClass("textfx "+e).text(t),(t=a.data("textFxDelay"))?(game.timeout(t,e.appendTo.bind(e,a)),a.data("textFxDelay",t+game.fx.textDelay)):(e.appendTo(a),a.data("textFxDelay",game.fx.textDelay)),game.timeout(game.fx.textDelay,function(){a.data("textFxDelay",a.data("textFxDelay")-game.fx.textDelay)}.bind(this,a)),s&&game.timeout(s,e.remove.bind(e)))},sleep:function(a){$("<span>").addClass("textfx textsleep").text("z").appendTo(a)},buildUlt:function(){game.fx.ultfx=$("<div>").addClass("ultfx").appendTo(game.camera),game.fx.ultfx.append($("<div>").addClass("stripe1 stripes hide")),game.fx.ultfx.append($("<div>").addClass("stripe2 stripes hide"));for(var a=0;a<6;a++)$("<div>").appendTo(game.fx.ultfx).addClass("ulfx star hide")},ult:function(a,e,t){var s=a.data("label"),n=a.data("skillId");"ult"!=s||game.fx.ultList[n]?e&&e():(game.fx.ultList[n]=!0,$(".ultfx *").removeClass("hide"),n=$("<div>").addClass(n+" fx"),a.data("vertical")&&game.fx.ultfx.addClass("vertical-ult"),game.fx.ultfx.append(n),game.timeout(1900,function(){$(".ultfx .star").addClass("hide")}),game.timeout(2100,function(){game.fx.ultfx&&game.fx.ultfx.children&&game.fx.ultfx.children(".fx").remove(),$(".ultfx .stripes").addClass("hide"),game.fx.ultfx.removeClass("vertical-ult"),t&&game.audio.play(t),e&&e()}))},shake:function(){var a=game.states[game.currentState].el;a.addClass("shake"),setTimeout(function(){this.removeClass("shake")}.bind(a),260)},clear:function(){$(".ultfx *").addClass("hide"),game.fx.ultfx&&game.fx.ultfx.children&&game.fx.ultfx.children(".fx").remove(),$(".map .fx").remove(),game.fx.ultList={}}},game.highlight={extendjQuery:function(){$.fn.extend({highlightSource:game.highlight.source,highlightAlly:game.highlight.ally,highlightTargets:game.highlight.targets,highlightAttack:game.highlight.attack,highlightMove:game.highlight.move,strokeSkill:game.highlight.strokeSkill,strokeAttack:game.highlight.strokeAttack,highlightArrows:game.highlight.highlightArrows,highlightCreep:game.highlight.highlightCreep,radialStroke:game.highlight.radialStroke,crossStroke:game.highlight.crossStroke,linearStroke:game.highlight.linearStroke})},map:function(a){game.highlight.clearMap();var e=game.selectedCard;!game.selectedCard||e.hasClass("nohighlight")||game.lockHighlight||(e.hasClasses("heroes units")&&("tutorial"==game.mode?("Select"!==game.tutorial.lesson&&"Unselect"!==game.tutorial.lesson&&"Creep"!==game.tutorial.lesson&&e.highlightMove(),"Select"!==game.tutorial.lesson&&"Unselect"!==game.tutorial.lesson&&"Creep"!==game.tutorial.lesson&&"Move"!==game.tutorial.lesson&&e.highlightAttack()):(e.highlightMove(),e.highlightAttack())),e.hasClass("skills")&&(e.highlightSource(),e.hasClass("channel-on")||e.strokeSkill(),e.canPlay()&&(e.addClass("draggable"),e.highlightArrows(),e.highlightTargets(a)),e.closest(".hand").length&&"tutorial"!=game.mode&&e.canPlay()&&game.skill.enableDiscard()),e.hasClass("towers")&&e.strokeAttack(),e.hasClass("units")&&e.parent().is(".sidehand")&&(game[e.side()].tower.strokeAttack(),e.canPlay()&&(e.addClass("draggable"),e.highlightCreep())),e.hasAllClasses("items buy")?game.items.enableBuy():e.hasClass("items")&&(game.items.enableSell(),e.strokeSkill(),e.canPlay()&&(e.addClass("draggable"),e.highlightArrows(),e.highlightTargets(a))))},source:function(){var a=$(this),e=a.data("hero");return e&&$(".map .card."+a.side()+".heroes."+e).addClass("source"),a},channelStop:function(a,e,t){t.addClass("casttarget").on("mouseup.highlight",game.skill.activeStopChanneling)},targets:function(a){var e=this,t=$("#"+e.data("source"));return e.hasClass("items")||t&&t.length||(t=$(".map .source"),e.data("source",t.attr("id"))),(e.hasClass("items")||t.hasClasses("heroes units"))&&(e.data("type")===game.data.ui.passive?game.highlight.passive(t):e.data("type")===game.data.ui.toggle?game.highlight.toggle(e,t):!e.hasClass("items")&&e.data("type")!==game.data.ui.active&&e.data("type")!==game.data.ui.channel&&e.data("type")!==game.data.ui.summon||game.highlight.active(a,t,e),(a=JSON.parse(e.data("targets")))&&0<a.indexOf(game.data.ui.summon)&&(t=$("#"+t.data("summon")),game.highlight.possible(t)&&t.addClass("casttarget").on("mouseup.highlight",game.player.cast))),e},active:function(a,e,t,s){var n=JSON.parse(t.data("targets"));s&&(n=JSON.parse(t.data("secondary targets"))),e.canCast(t)&&(t.hasClass("channel-on")?game.highlight.channelStop(a,t,e):n&&(0<=n.indexOf(game.data.ui.tree)&&game.highlight.tree(t.side()),0<=n.indexOf(game.data.ui.self)&&game.highlight.self(e),0<=n.indexOf(game.data.ui.ally)&&game.highlight.ally(e,t),0<=n.indexOf(game.data.ui.enemy)&&game.highlight.enemy(e,t),0<=n.indexOf(game.data.ui.jungle)&&game.highlight.jungle(e,t),0<=n.indexOf(game.data.ui.sumonner)&&game.highlight.summoner(e,t),0<=n.indexOf(game.data.ui.spot)&&(0<=n.indexOf(game.data.ui.range)?game.highlight.atRange(e,t,0<=n.indexOf(game.data.ui.free)):0<=n.indexOf(game.data.ui.free)?game.highlight.freeSpots(e,t):((n=t.data("aoe"))===game.data.ui.radial&&game.highlight.radial(e,t),n===game.data.ui.linear&&game.highlight.linear(e,t)))))},passive:function(a){a.hasClass("dead")||a.addClass("casttarget").on("mouseup.highlight",game.player.passive)},toggle:function(a,e){e.hasClasses("dead stunned silenced hexed disabled sleeping cycloned taunted")||e.addClass("casttarget").on("mouseup.highlight",game.player.toggle)},tree:function(a){$(".map .spot:not(.enemyarea) .card.trees"+("enemy"==a?".dire":"player"==a?".rad":"")).addClass("casttarget").on("mouseup.highlight",game.player.cast)},self:function(a){a.hasClass("cycloned")||a.addClass("casttarget").on("mouseup.highlight",game.player.cast)},tower:function(a){game[a].tower.addClass("casttarget").on("mouseup.highlight",game.player.cast)},ally:function(a,e){var t=e.data("cast range"),s=e.side()||a.side();999===t||e.hasClass("items")?$(".map .card."+s).each(function(){game.highlight.card($(this),e,s)}):(a.data("skill range bonus")&&!e.data("fixed range")&&(t+=a.data("skill range bonus")),a.around(t,function(a){a=$(".card",a);a.length&&game.highlight.card(a,e,s)}))},enemy:function(a,e){var t=e.data("cast range");!t&&e.hasClass("items")&&(t="global");var s=e.opponent()||a.opponent();"global"!==t&&a?(a.data("skill range bonus")&&!e.data("fixed range")&&(t+=a.data("skill range bonus")),a.data("attack range bonus")&&e.data("attack cast range")&&(t+=a.data("attack range bonus")),a.inRange(t,function(a){a=$(".card",a);a.length&&game.highlight.card(a,e,s)})):$(".map .card."+s).each(function(){game.highlight.card($(this),e,s)})},card:function(a,e,t){var s="dead towers source ghost",n=JSON.parse(e.data("targets"));e.data("cast")&&(s+=" stunned disabled silenced hexed taunted sleeping"),e.data("cycloned")||(s+=" cycloned"),n&&0<=n.indexOf(game.data.ui.heroes)&&(s+=" units"),a.hasClass(t)&&!a.hasClasses(s)&&a.addClass("casttarget").on("mouseup.highlight",game.player.cast)},jungle:function(a,e){var t=e.data("cast range");a.data("skill range bonus")&&!e.data("fixed range")&&(t+=a.data("skill range bonus")),a.inRange(t,function(a){a.hasAllClasses("jungle free")&&!a.hasClasses("block cript")&&a.addClass("targetarea").on("mouseup.highlight",game.player.cast)})},summoner:function(a,e){a.data(game.data.ui.summoner).around(e.data("cast range"),function(a){a.hasClass("free")&&!a.hasClasses("block cript")&&a.addClass("targetarea").on("mouseup.highlight",game.player.cast)})},freeSpots:function(a,e){var t,s;a?(t=e.data("cast range"),a.data("skill range bonus")&&!e.data("fixed range")&&(t+=a.data("skill range bonus")),s=e.hasClass("ld-bear")||e.hasClass("ld-bearreturn"),e=$("#"+a.data("summon")),s&&e.hasClass("cycloned")||a.around(t,function(a){a.hasClass("free")&&!a.hasClasses("block cript")&&a.addClass("targetarea").on("mouseup.highlight",game.player.cast)})):$(".map .spot.free").each(function(){var a=$(this);a.hasClasses("block cript enemyarea jungle")||a.addClass("targetarea").on("mouseup.highlight",game.player.cast)})},radial:function(a,e){var t=e.data("cast range");!t&&e.data("cast select")&&(t=e.data("selected cast range")),a.data("skill range bonus")&&!e.data("fixed range")&&(t+=a.data("skill range bonus")),a.around(t,function(a){var e=a.find(".card");e.length&&!e.hasClass("invisible")?e.addClass("casttarget").on("mouseup.highlight",game.player.cast):a.hasClasses("block")||a.addClass("targetarea").on("mouseup.highlight",game.player.cast)})},linear:function(a,e){a.getPosition();var t=e.data("cast range"),s=e.data("cast width");!a.data("skill range bonus")||e.data("fixed range")||e.data("fixed cast range")||(t+=a.data("skill range bonus")),a.inCross(t,s,function(a){var e=a.find(".card");e.length&&!e.hasClass("invisible")?e.addClass("casttarget").on("mouseup.highlight",game.player.cast):a.hasClasses("block cript")||a.addClass("targetarea").on("mouseup.highlight",game.player.cast)})},atRange:function(a,e,t){var s=e.data("cast range");a.data("skill range bonus")&&!e.data("fixed range")&&(s+=a.data("skill range bonus")),a.atRange(s,function(a){t&&(!a.hasClass("free")||a.hasClass("cript block"))||a.addClass("targetarea").on("mouseup.highlight",game.player.cast)})},move:function(){var a,e=this;return e.canPlay()&&e.hasClasses("units heroes")&&e.canMove()&&(e.hasClass("selected")&&e.addClass("draggable"),1<(a=game.map.getRangeInt(e.data("current speed")))&&e.inMovementRange(Math.round(a),function(a){a.hasClass("free")&&!a.hasClass("block")&&a.addClass("movearea").on("mouseup.highlight",game.player.move)})),e},attack:function(){var a,e=this;return e.canPlay()?e.canAttack()&&e.canPlay()&&e.hasClasses("units heroes")&&(e.hasClass("selected")&&e.addClass("draggable"),e.strokeAttack(),a=e.data("range"),e.data("attack range bonus")&&(a+=e.data("attack range bonus")),e.inRange(a,function(a){a=$(".card",a);a.hasClass(e.opponent())&&!a.hasClasses("invisible ethereal cycloned")&&a.addClass("attacktarget").on("mouseup.highlight",game.player.attack),a[0]!==e[0]&&a.hasAllClasses(e.side()+" units")&&a.data("current hp")<Math.floor(a.data("hp")/3)&&!a.hasClasses("ethereal cycloned")&&a.addClass("attacktarget").on("mouseup.highlight",game.player.attack),a.hasClass("trees")&&e.hasClass("quelling")&&a.addClass("attacktarget").on("mouseup.highlight",game.player.attack)})):e.strokeAttack(),e},strokeAttack:function(){var a,e=this;return e.hasClasses("dead stunned disabled disarmed hexed")||(a=e.data("range"),e.data("attack range bonus")&&(a+=e.data("attack range bonus")),e.radialStroke(a,e.side()+"attack")),e},strokeSkill:function(a){var e=this,t=e.data("hero");return a=a||$(".map .source"),(t||e.hasClass("items"))&&(game.skill.castsource=a,game.skill.castrange=e.data("cast range")||e.data("stroke range"),!a.data("skill range bonus")||e.data("fixed range")||e.data("fixed cast range")||(game.skill.castrange+=a.data("skill range bonus")),a.data("attack range bonus")&&e.data("attack cast range")&&(game.skill.castrange+=a.data("attack range bonus")),e.data("aoe")&&(game.skill.aoe=e.data("aoe"),game.skill.aoewidth=e.data("aoe width"),game.skill.aoerange=e.data("aoe range"),a.data("skill range bonus")&&!e.data("fixed range")&&(game.skill.aoerange+=a.data("skill range bonus")),game.skill.castwidth=e.data("cast width"),game.map.el.addClass("aoe"),$(".map .spot").on("mouseover.highlight mouseleave.highlight",game.highlight.hover)),a&&(game.skill.aoe===game.data.ui.linear?(a.crossStroke(game.skill.aoerange,game.skill.aoewidth,"skillstroke"),game.skill.castrange&&!e.hasClass("channel-on")&&a.crossStroke(game.skill.castrange,game.skill.castwidth,"skillstroke")):game.skill.castrange&&a.radialStroke(game.skill.castrange,"skillstroke"),(t=JSON.parse(e.data("targets")))&&t.length&&0<t.indexOf(game.data.ui.summon)&&(a=$("#"+a.data("summon")),game.highlight.possible(a)&&(game.skill.summonHover=!0,a.radialStroke(game.skill.castrange,"skillstroke"))))),e},hover:function(a){var e=$(this);game.map.el.hasClass("aoe")&&($(".map .spot").removeClass("skillstroke skillhoverstroke stroke top right left bottom toparrow bottomarrow leftarrow rightarrow"),$(".map .card").removeClass("toparrow bottomarrow leftarrow rightarrow"),e.hasClass("targetarea")||e.find(".casttarget").length?e.hasClasses("block")||game.highlight.strokeAtCursor(e):game.highlight.strokeAtCaster())},strokeAtCursor:function(a){game.selectedCard.highlightArrows(a),game.skill.aoe===game.data.ui.linear?a.linearStroke(game.skill.aoerange,game.skill.aoewidth,"skillhoverstroke"):game.skill.aoe===game.data.ui.radial&&a.radialStroke(game.skill.aoerange,"skillhoverstroke")},strokeAtCaster:function(){var a;game.selectedCard.highlightArrows(),game.skill.aoe===game.data.ui.linear?(game.skill.castsource.crossStroke(game.skill.aoerange,game.skill.aoewidth,"skillstroke"),game.skill.castsource.crossStroke(game.skill.castrange,game.skill.castwidth,"skillstroke")):game.skill.aoe===game.data.ui.radial&&(game.skill.castsource.radialStroke(game.skill.castrange,"skillstroke"),game.skill.summonHover&&(a=$("#"+game.skill.castsource.data("summon")),game.highlight.possible(a)&&a.radialStroke(game.skill.castrange,"skillstroke")))},possible:function(a){return a&&game.map.el.has(a)&&!a.hasClass("cycloned")},highlightArrows:function(a){var e,t,s,n,i=$(".map .source"),o=this.data("aoe range"),r=i.opponent();"top"==this.data("highlight")&&(n=$("#"+i.data("summon")),e="top","enemy"==i.side()&&(e="bottom"),a?a.around(o,function(a){a.hasClasses("block cript")||a.addClass(e+"arrow"),$(".card."+r,a).addClass(e+"arrow")}):(game.highlight.possible(n)&&n.around(o,function(a){a.hasClasses("block cript")||a.not(i.parent()).addClass(e+"arrow"),$(".card."+r,a).addClass(e+"arrow")}),i.around(o,function(a){a.hasClasses("block cript")||a.addClass(e+"arrow"),$(".card."+r,a).addClass(e+"arrow")}))),"in"==this.data("highlight")&&(t=this.data("aoe width"),a&&(s=game.map.invertDirection(i.getDirectionStr(a)),(n=i.firstSpotInLine(a,o))&&s&&i.inLine(n,o,t,function(a){var e=$(".card",a);e.length?e.addClass(s+"arrow"):a.hasClasses("block cript")||a.addClass(s+"arrow")}))),"out"==this.data("highlight")&&a&&a.inCross(1,0,function(a,e){var t=$(".card."+r,a);t.length?t.addClass(e+"arrow"):a.hasClasses("block cript")||a.addClass(e+"arrow")})},highlightCreep:function(){var a=game.selectedCard.side();game[a].tower.strokeAttack(),$(".spot."+a+"area.free").addClass("movearea").on("mouseup.highlight",game[a].summonCreep)},radialStroke:function(a,s){var e=a;"string"==typeof a&&(e=game.map.getRangeInt(a));function t(a,e,t){(e=game.map.getSpot(a,e))&&e.addClass(s+" stroke "+t)}var n,i,o,r,d,l=game.map.getX(this),m=game.map.getY(this);if(0===e)return t(l,m,"left right top bottom");if(n=game.map.rangeArray[e],a=Math.round(n),r=n*n,d=Math.ceil(n)*Math.cos(Math.PI/4),e%2==0?(t(l,m+a,"bottom"),t(l,m-a,"top"),t(l-a,m,"left"),t(l+a,m,"right")):e%2==1&&(t(l,m+a,"bottom left right"),t(l,m-a,"top  left right"),t(l-a,m,"left top bottom"),t(l+a,m,"right top bottom")),2===e||3===e)for(i=1;i<=d;i+=1)t(l+i,m+(o=1),"right bottom"),t(l+i,m-o,"right top"),t(l-i,m+o,"left bottom"),t(l-i,m-o,"left top");else if(4===e||6===e||8===e)for(i=1;i<=d;i+=1)t(l+i,m+(o=Math.round(Math.sqrt(r-i*i))),"right bottom"),t(l+o,m+i,"right bottom"),t(l+i,m-o,"right top"),t(l+o,m-i,"right top"),t(l-i,m+o,"left bottom"),t(l-o,m+i,"left bottom"),t(l-i,m-o,"left top"),t(l-o,m-i,"left top");else if(5<=e)for(i=1;i<=d;i+=1)t(l+i,m+(o=Math.round(Math.sqrt(r-i*i))),"bottom"),t(l-i,m+o,"bottom"),t(l+i,m-o,"top"),t(l-i,m-o,"top"),t(l-o,m+i,"left"),t(l-o,m-i,"left"),t(l+o,m-i,"right"),t(l+o,m+i,"right");7===e&&(t(l+3,m+2,"bottom"),t(l-3,m+2,"bottom"),t(l+3,m-2,"top"),t(l-3,m-2,"top"),t(l-2,m+3,"left"),t(l-2,m-3,"left"),t(l+2,m+3,"right"),t(l+2,m-3,"right"))},crossStroke:function(a,e,s){function t(a,e,t){(e=game.map.getSpot(a,e))&&e.addClass(s+" stroke "+t)}var n,i=game.map.getX(this),o=game.map.getY(this);if(0===a)return t(i,o,"left right top bottom");for(t(i,o+a,"bottom"),t(i,o-a,"top"),t(i-a,o,"left"),t(i+a,o,"right"),1==e&&(t(i+e,o+a,"bottom"),t(i-e,o+a,"bottom"),t(i+e,o-a,"top"),t(i-e,o-a,"top"),t(i-a,o+e,"left"),t(i-a,o-e,"left"),t(i+a,o+e,"right"),t(i+a,o-e,"right")),n=1+e;n<=a;n+=1)t(i-e,o+n,"left"),t(i+e,o+n,"right");for(n=1+e;n<=a;n+=1)t(i-e,o-n,"left"),t(i+e,o-n,"right");for(n=1+e;n<=a;n+=1)t(i+n,o-e,"top"),t(i+n,o+e,"bottom");for(n=1+e;n<=a;n+=1)t(i-n,o-e,"top"),t(i-n,o+e,"bottom")},linearStroke:function(a,e,s){function t(a,e,t){(e=game.map.getSpot(a,e))&&e.addClass(s+" stroke "+t)}var n,i=game.map.getX(this),o=game.map.getY(this),r=game.map.getX(game.skill.castsource),d=game.map.getY(game.skill.castsource);if(0<o-d)for(t(r,d+a,"bottom"),1==e&&(t(r+1,d+1,"top"),t(r-1,d+1,"top"),t(r+1,d+a,"bottom"),t(r-1,d+a,"bottom")),n=1;n<=a;n+=1)t(r-e,d+n,"left"),t(r+e,d+n,"right");else if(o-d<0)for(t(r,d-a,"top"),1==e&&(t(r+1,d-1,"bottom"),t(r-1,d-1,"bottom"),t(r+1,d-a,"top"),t(r-1,d-a,"top")),n=1;n<=a;n+=1)t(r-e,d-n,"left"),t(r+e,d-n,"right");else if(0<i-r)for(t(r+a,d,"right"),1==e&&(t(r+1,d-1,"left"),t(r+1,d+1,"left"),t(r+a,d-1,"right"),t(r+a,d+1,"right")),n=1;n<=a;n+=1)t(r+n,d-e,"top"),t(r+n,d+e,"bottom");else if(i-r<0)for(t(r-a,d,"left"),1==e&&(t(r-1,d-1,"right"),t(r-1,d+1,"right"),t(r-a,d-1,"left"),t(r-a,d+1,"left")),n=1;n<=a;n+=1)t(r-n,d-e,"top"),t(r-n,d+e,"bottom")},clearMap:function(){game.skill.aoe=null,game.skill.aoerange=null,game.skill.aoewidth=null,game.skill.castrange=null,game.skill.castwidth=null,game.skill.castsource=null,game.skill.summonHover=null,game.map.el.removeClass("aoe"),$(".map .card, .map .spot").clearEvents("highlight").removeClass("source stroke attacktarget casttarget movearea movetarget movesource moving targetarea stroke playerattack enemyattack skillhoverstroke skillstroke top bottom left right toparrow bottomarrow leftarrow rightarrow")},refresh:function(){game.selectedCard?game.selectedCard.reselect():game.highlight.map()}},game.items={build:function(){game.items.builded||(game.items.builded=!0,this.shop=$("<div>").addClass("shop").appendTo(game.camera)),game.playerItemsDeck=game.deck.build({name:"items",cb:function(a){a.addClass("items").appendTo(game.items.shop);$.each(JSON.parse(a.data("cards")),function(a,e){$("#"+e).on("mousedown touchstart",game.card.select).addClass("buy")})}})},clone:function(a){a=$(a);if(a.length)return a.clone().data(a.data()).on("mousedown touchstart",game.card.select)},enableShop:function(){game.items.shopEnabled=!0,game.states.table.shop.attr("disabled",!1),game.items.shopText()},shopText:function(){var a="player";"local"==game.mode&&(a=game.currentTurnSide);a=a?"($"+game[a].money+")":"";game.items.sellMode||(game.items.shopOpen?game.states.table.shop.text(game.data.ui.close+a):game.states.table.shop.text(game.data.ui.shop+a))},shopClick:function(){var a="player";"local"==game.mode&&(a=game.currentTurnSide),game.selectedCard&&game.selectedCard.hasClass("items")?game.selectedCard.hasClass("buy")?game.items.buyItem(a):"tutorial"!==game.mode&&game.items.sellItem():(game.items.shopOpen=!game.items.shopOpen,game.items.shopOpen?game.items.shop.addClass("show"):game.items.hideShop()),game.items.updateShop()},updateShop:function(a){var t="player";"local"==game.mode&&(t=game.currentTurnSide),(game.canPlay()||a)&&(t&&$.each(JSON.parse(game.playerItemsDeck.data("cards")),function(a,e){e=$("#"+e);e.data("price")>game[t].money?e.addClass("expensive"):e.removeClass("expensive")}),game.items.shopText(),game.selectedCard&&game.selectedCard.hasClass("buy")&&game.selectedCard.reselect())},hideShop:function(){game.items.shopText(),game.selectedCard&&game.selectedCard.hasAllClasses("items buy")&&game.card.unselect(),"tutorial"==game.mode&&game.tutorial.hideShop(),game.items.shopOpen=!1,game.items.shop.removeClass("show")},disableShop:function(){game.items.shopEnabled=!1,game.items.shopOpen=!1,game.items.sellMode=!1,game.states.table.shop.text(game.data.ui.shop).attr("disabled",!0),game.selectedCard&&game.selectedCard.hasAllClasses("items buy")&&game.card.unselect(),game.items.shop&&game.items.shop.removeClass("show")},addMoney:function(a,e){a&&e&&(game[a].money?game[a].money+=e:game[a].money=e,game[a].money>game.maxMoney&&(game[a].money=game.maxMoney),game.items.updateShop())},enableBuy:function(){game.items.sellMode=!1,game.states.table.shop.attr("disabled",game.selectedCard.hasClass("expensive")),game.states.table.shop.text(game.data.ui.buy+" ($"+game.selectedCard.data("price")+")")},enableSell:function(){"tutorial"!==game.mode&&(game.items.sellMode=!0,game.selectedCard.data("buyTurn")+1>=game.totalTurns?game.states.table.shop.text(game.data.ui.sell+" ($"+Math.floor(game.selectedCard.data("price")/(game.selectedCard.data("cards")||1))+")"):game.states.table.shop.text(game.data.ui.sell+" ($"+Math.floor(game.selectedCard.data("price")/(2*(game.selectedCard.data("cards")||1)))+")"))},buyItem:function(a){var e=game.selectedCard,t="B:"+e.data("item")+":"+e.data("itemtype");game.history.saveMove(t),"online"==game.mode&&game.currentMoves.push(t),e.data("buyTurn",game.totalTurns),game.items.newCard(a,e),game.items.addMoney(a,-e.data("price")),game.card.unselect(),"tutorial"==game.mode&&game.tutorial.buyItem()},newCard:function(a,e){for(var t=0;t<(e.data("cards")||1);t++){var s=game.items.clone(e).removeClass("selected buy expensive");s.appendTo(game[a].skills.sidehand),s.addClass(a),"local"!==game.mode&&"enemy"==a&&s.addClass("flipped")}},sellItem:function(){var a=game.selectedCard.side();game.selectedCard.data("buyTurn")+1>=game.totalTurns?game.items.addMoney(a,game.selectedCard.data("price")/(game.selectedCard.data("cards")||1)):game.items.addMoney(a,game.selectedCard.data("price")/(2*game.selectedCard.data("cards")||1)),game.items.updateShop("force"),game[a].discard(game.selectedCard),game.items.sellMode=!1},clear:function(){game.items.disableShop(),game.player.money=game.startMoney,game.enemy.money=game.startMoney},healing:{faerie:{cast:function(a,e){e.heal(a.data("heal"))}},tango:{cast:function(a,e){e.hasAllClasses("spot free")?game.tree.build(e.attr("id"),"player"==a.side()?"rad":"dire"):(e=$(".card",e)).hasClass("trees")?game.tree.destroy(e):(a=e.selfBuff(a),e.heal(a.data("heal")),a.on("buffcount",game.items.healing.tango.buffcount),a.on("expire",game.items.healing.tango.buffcount))},buffcount:function(a,e){var t=e.target,e=e.buff;3!==e.data("duration")&&t.heal(e.data("heal"))}},vitality:{cast:function(a,e){e.selfBuff(a)}},meka:{cast:function(a,e){$(".map .card."+e.side()).not(".dead, .towers, .ghost").each(function(){$(this).heal(a.data("heal"))}),game.audio.play("items/meka")}},heart:{cast:function(a,e){e.selfBuff(a).on("buffcount",game.items.healing.tango.buffcount)},buffcount:function(a,e){var t=e.target,e=e.buff;t.heal(e.data("heal"))}}},mana:{clarity:{cast:function(a,e){game.skill.buyCardsFromHero(e);e.selfBuff(a);a=e.side();e.on(a+"turnstart.clarity",game.items.mana.clarity.turnstart),e.on("attacked",game.items.mana.clarity.attacked)},attacked:function(a,e){var t=e.target,e=t.side();t.getBuff("clarity").remove(),t.off(e+"turnstart.clarity")},turnstart:function(a,e){var t=e.target,e=t.side();game.skill.buyCardsFromHero(t),t.off(e+"turnstart.clarity")}},soul:{cast:function(a,e){e.side();var t=a.data("damage"),s=e.data("current hp")-t;s<1&&(t+=1+s),e.damage(t,e,game.data.ui.pure),game.skill.buyCardsFromHero(e,a.data("skill cards")),game.audio.play("items/soul")}},void:{cast:function(a,e){e=e.side();game[e].cardsPerTurn+=1}},diffusal:{cast:function(a,e){var t=e.side(),e=e.data("hero");$("."+t+" .hand ."+e).each(function(){$(this).discard()})}},refresher:{cast:function(a,e){e.side();game.skill.buyCardsFromHero(e,a.data("skill cards")),game.audio.play("items/refresher")}}},armor:{ring:{cast:function(a,e){e.selfBuff(a)}},buckler:{cast:function(a,e){$(".map .card."+e.side()).not(".dead, .towers, .ghost").each(function(){$(this).selfBuff(a)}),game.audio.play("items/buckler")}},medallion:{cast:function(a,e){e.selfBuff(a),game.audio.play("items/medallion")}},talisman:{cast:function(a,e){e.selfBuff(a);e.on("attacked.talisman",game.items.armor.talisman.attacked)},attacked:function(a,e){var t=e.source,e=e.target.getBuff("talisman").data("miss")/100;game.random()<e&&t.data("miss-attack",!0)}},blademail:{cast:function(a,e){e.addClass("blademail"),e.selfBuff(a).on("expire",game.items.armor.blademail.expire),e.on("damage.blademail",game.items.armor.blademail.damage),game.audio.play("items/blademail")},damage:function(a,e){var t=e.source,s=e.target;t.hasClasses("heroes units")&&!t.hasClass("blademail")&&s.damage(e.originalDamage,t,e.type)},expire:function(a,e){e=e.target;e.removeClass("blademail"),e.off("damage.blademail")}}},attack:{quelling:{cast:function(a,e){e.addClass("quelling");a=e.selfBuff(a);e.data("unit damage bonus",a.data("unit damage bonus"))}},broadsword:{cast:function(a,e){e.selfBuff(a)}},madness:{cast:function(a,e){e.selfBuff(a),game.audio.play("items/madness")}},crystalys:{cast:function(a,e){e.selfBuff(a),e.on("pre-attack.crystalys",game.items.attack.crystalys.attack)},attack:function(a,e){var t=e.source,s=e.target,n=(e.damage,t.getBuff("crystalys")),e=n.data("chance")/100,n=n.data("multiplier");game.random()<e&&s.side()==t.opponent()&&!t.data("miss-attack")&&(game.fx.add("axe-ult-kill",t,s,"flip"),t.data("critical-attack",n))}},echo:{cast:function(a,e){e.selfBuff(a).data("echo-enabled",!0),e.on("attack.echo",game.items.attack.echo.attack),e.on("turnend.echo",game.items.attack.echo.turnend)},attack:function(a,e){var t=e.source,s=e.target,n=t.getBuff("echo");n.data("echo-enabled")&&s.side()==t.opponent()&&!e.force&&(game.timeout(600,t.attack.bind(t,s,"force","echo")),n.data("echo-enabled",!1))},turnend:function(a,e){e.target.getBuff("echo").data("echo-enabled",!0)}}},resistance:{cloak:{cast:function(a,e){e.selfBuff(a)}},pipe:{cast:function(a,e){$(".map .card."+e.side()).not(".dead, .towers, .ghost").each(function(){$(this).selfBuff(a)}),game.audio.play("activate")}},linken:{cast:function(a,e){e.addClass("linken"),e.selfBuff(a).on("expire",game.items.resistance.linken.expire),e.on("casted.linken",game.items.resistance.linken.casted)},casted:function(a,e){e=e.target;e.removeBuff("linken"),game.audio.play("items/linken"),e.off("casted.linken")},expire:function(a,e){e=e.target;e.removeClass("bkb"),e.off("casted.linken")}},lotus:{cast:function(a,e){e.selfBuff(a),e.on("casted",game.items.resistance.lotus.casted)},casted:function(a,e){var t=e.source,s=e.target,e=e.skill;game.audio.play("items/lotus"),game.timeout(600,s.cast.bind(s,e,t))}},bkb:{cast:function(a,e){e.stopChanneling(),e.purge(),e.addClass("bkb"),e.selfBuff(a).on("expire",game.items.resistance.bkb.expire),game.audio.play("items/bkb")},expire:function(a,e){e.target.removeClass("bkb")}}},arcane:{dust:{cast:function(a,e){a=a.data("aoe range");e.opponentsInRange(a,function(a){a.removeClass("invisible")})}},glimmer:{cast:function(a,e){a=e.selfBuff(a);e.addInvisibility(a)}},ethereal:{cast:function(a,e){e.addStack("ethereal"),e.selfBuff(a).on("expire",game.items.arcane.ethereal.expire)},expire:function(a,e){e.target.removeStack("ethereal")}},sheepstick:{cast:function(a,e){e.stopChanneling(),e.addClass("sheep").removeClass("can-attack"),e.addStack("disarmed").addStack("silenced"),e.selfBuff(a).on("expire",game.items.arcane.sheepstick.expire)},expire:function(a,e){e=e.target;e.removeClass("sheep"),e.removeStack("disarmed").removeStack("silenced")}},kaya:{cast:function(a,e){e.data("skillDamageBonus",a.data("multiplier")),e.selfBuff(a),e.addInvisibility()}}},movement:{windlace:{cast:function(a,e){e.selfBuff(a)}},boots:{cast:function(a,e){e.selfBuff(a)}},drums:{cast:function(a,e){$(".map .card."+e.side()).not(".dead, .towers, .ghost").each(function(){$(this).selfBuff(a)})}},skadi:{cast:function(a,e){e.selfBuff(a,"skadi-target"),e.on("attack.skadi",game.items.movement.skadi.attack)},attack:function(a,e){var t=e.source,s=e.target,e=t.getBuff("skadi-target"),e=$("#"+e.data("skill"));s.hasClasses("bkb")||s.side()!=t.opponent()||t.data("miss-attack")||t.addBuff(s,e,"skadi-attacked")}},phase:{cast:function(a,e){e.addClass("phased");e.selfBuff(a)}}},range:{tp:{cast:function(a,e){e.selfBuff(a);game.skill.channel(a,e),e.on("channelend",this.channelend)},channelend:function(a,e){var t,s=e.source,n=s.side(),e=$("."+n+"area.fountain.free");e.length||(t=[],game[n].tower.around(2,function(a){a.hasClass("free")&&t.push(a)}),e=t[parseInt(game.random()*t.length)]),e&&s.place(e),s.removeClass("tp"),s.removeBuff("tp")}},rod:{cast:function(a,e){e.addStack("rooted").removeClass("can-move"),e.selfBuff(a).on("expire",game.items.range.rod.expire)},expire:function(a,e){e.target.removeStack("rooted")}},blinkdagger:{cast:function(a,e){e.hasClass("free")&&(card=$("#"+a.data("source")),card.stopChanneling(),card.place(e))}},lens:{cast:function(a,e){a=e.selfBuff(a);e.data("skill range bonus",a.data("skill range bonus"))}},dragon:{cast:function(a,e){a=e.selfBuff(a);e.data("attack range bonus",a.data("attack range bonus"))}}},relic:{eul:{cast:function(a,e){e.stopChanneling(),a.side()==e.side()&&e.purge(),e.selfBuff(a).on("expire",game.items.relic.eul.expire),e.addClass("cycloned")},expire:function(a,e){var t=e.target,s=e.buff,e=$("#"+s.data("skill"));t.removeClass("cycloned"),e.side()==t.opponent()&&t.damage(s.data("damage"),t,game.data.ui.pure)}},morbid:{cast:function(a,e){e.selfBuff(a);e.on("attack.morbid",this.attack)},attack:function(a,e){var t=e.source,s=e.target,n=e.damage,e=t.getBuff("morbid").data("lifesteal")/100;s.side()!=t.opponent()||t.data("miss-attack")||t.heal(n*e)}},halberd:{cast:function(a,e){e.addStack("disarmed").removeClass("can-attack"),e.selfBuff(a).on("expire",game.items.relic.halberd.expire)},expire:function(a,e){e.target.removeStack("disarmed")}},shivas:{cast:function(e,t){t.opponentsInRange(e.data("aoe range"),function(a){t.damage(e.data("damage"),a,e.data("damage type")),a.hasClasses("bkb cycloned")||t.addBuff(a,e)})}},meteor:{cast:function(t,s){game.fx.add("meteor-cast",s),s.inRange(t.data("aoe range"),function(a){var e=$(".card."+t.opponent(),a);e&&(s.damage(t.data("damage"),e,t.data("damage type")),e.hasClasses("bkb cycloned")||(s.addStun(e,t),a=s.addBuff(e,t),e.on("turnend.meteor",game.items.relic.meteor.turnend.bind(this,s,e,t)),a.on("expire",game.items.relic.meteor.expire.bind(this,s,e))))})},turnend:function(a,e,t){var s=e.getBuff("meteor");a.damage(s.data("dot"),e,s.data("damage type"))},expire:function(a,e){var t=e.getBuff("meteor");a.damage(t.data("dot"),e,t.data("damage type")),a.off("turnend.meteor")}}},armaments:{vennon:{cast:function(a,e){e.selfBuff(a,"vennon-target");e.on("attack.vennon",game.items.armaments.vennon.attack)},attack:function(a,e){var t=e.source,s=e.target,e=t.getBuff("vennon-target"),e=$("#"+e.data("skill"));s.hasClasses("bkb")||s.side()!=t.opponent()||t.data("miss-attack")||(e=t.addBuff(s,e,"vennon-attacked"),s.on("turnend.vennon",game.items.armaments.vennon.turnend.bind(this,t,s)),e&&e.on("expire",game.items.armaments.vennon.expire.bind(this,t,s)))},turnend:function(a,e){var t=e.getBuff("vennon-attacked");a.damage(t.data("dot"),e,t.data("damage type"))},expire:function(a,e){var t=e.getBuff("vennon-attacked");a.damage(t.data("dot"),e,t.data("damage type")),e.off("attack.vennon")}},desolator:{cast:function(a,e){e.selfBuff(a,"desolator-target");e.on("attack.desolator",game.items.armaments.desolator.attack)},attack:function(a,e){var t=e.source,s=e.target,e=t.getBuff("desolator-target"),e=$("#"+e.data("skill"));s.hasClasses("bkb")||s.side()!=t.opponent()||t.data("miss-attack")||t.addBuff(s,e,"desolator-attacked")}},manta:{cast:function(a,e){var t,s=[];e.around(a.data("aoe range"),function(a){a.hasClass("free")&&s.push(a)});for(var n,i=0;i<a.data("illusions");i++)s.length&&((t=s[parseInt(game.random()*s.length)]).removeClass("free"),(n=game.skill.illusion(e).appendTo(t)).data("current damage",parseInt(e.data("current damage")/2)),n.on("damage",function(){this.remove()}.bind(n)),s.erase(t))}},basher:{cast:function(a,e){var t=a.side();game[t].tower.damage(a.data("damage"),e,a.data("damage type")),game[t].tower.addStun(e,a)}},radiance:{cast:function(a,e){var t=e.selfBuff(a);e.on("turnend.radiance",game.items.armaments.radiance.turnend.bind(this,a,e,t))},turnend:function(e,t,s){t.around(e.data("aoe range"),function(a){a=$(".card."+e.opponent(),a);a&&t.damage(s.data("damage"),a,s.data("damage type"))})}}}},game.map={extendjQuery:function(){$.fn.extend({getX:game.map.getX,getY:game.map.getY,getSpot:game.map.getSpot,getDirectionObj:game.map.getDirectionObj,getDirectionStr:game.map.getDirectionStr,getDirSpot:game.map.getDirSpot,atRange:game.map.atRange,around:game.map.around,inRange:game.map.inRange,opponentsInRange:game.map.opponentsInRange,alliesInRange:game.map.alliesInRange,inAttackRange:game.map.inAttackRange,inMovementRange:game.map.inMovementRange,inCross:game.map.inCross,opponentsInCross:game.map.opponentsInCross,alliesInCross:game.map.alliesInCross,inLine:game.map.inLine,alliesInLine:game.map.alliesInLine,opponentsInLine:game.map.opponentsInLine,firstSpotInLine:game.map.firstSpotInLine,lastSpotInLine:game.map.lastSpotInLine,firstFreeSpotInLine:game.map.firstFreeSpotInLine,lastFreeSpotInLine:game.map.lastFreeSpotInLine,firstCardInLine:game.map.firstCardInLine,getPosition:game.map.getPosition,cardsInRange:game.map.cardsInRange,behindTarget:game.map.behindTarget})},lettersStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",build:function(){game.map.letters||(game.map.letters=game.map.lettersStr.split("")),game.map.spots=[];var a,e,t,s=$("<div>").addClass("map").css({width:212*game.width,height:312*game.height});for(game.getData("flat-map")&&s.addClass("flat"),e=0;e<game.height;e+=1)for(game.map.spots[e]=[],t=$("<div>").addClass("row trow"+(e+1)).appendTo(s),a=0;a<game.width;a+=1)game.map.spots[e][a]=$("<div>").attr({id:game.map.toPosition(a,e)}).addClass("free spot row"+(e+1)+" col"+game.map.letters[a]).appendTo(t).on("contextmenu",game.events.cancel),game.debug&&game.map.spots[e][a].append($("<span>").addClass("debug").text(game.map.toPosition(a,e)));return game.map.updateGrid(),game.map.builded=!0,game.map.el=s},updateGrid:function(a){game.map.grid=new PF.Grid(game.width,game.height);for(var e=0;e<game.height;e+=1)for(var t=0;t<game.width;t+=1)game.map.spots[e][t].hasClass("free")||a&&!$(".card",game.map.spots[e][t]).hasClass("trees")||game.map.grid.setWalkableAt(t,e,!1);game.map.finder=new PF.AStarFinder({allowDiagonal:!0,dontCrossCorners:!0})},toPosition:function(a,e){if(0<=a&&0<=e&&a<game.width&&e<game.height)return game.map.letters[a]+(e+1)},getX:function(a){(a=a||$(this))&&"function"==typeof a.attr&&(a.hasClass("spot")?a=a.attr("id"):a.parent().hasClass("spot")&&(a=a.parent().attr("id")));a=game.map.letters.indexOf(a[0]);if(0<=a&&a<game.width)return a},getY:function(a){(a=a||$(this))&&"function"==typeof a.attr&&(a.hasClass("spot")?a=a.attr("id"):a.parent().hasClass("spot")&&(a=a.parent().attr("id")));a=parseInt(a[1],10)-1;if(0<=a&&a<game.height)return a},getSpot:function(a,e){return void 0===a&&this.closest?this.closest(".spot"):game.map.spots[e]&&game.map.spots[e][a]?game.map.spots[e][a]:void 0},getDirectionObj:function(a){var e=game.map.getX(this),t=game.map.getY(this),s=game.map.getX(a),n=game.map.getY(a),a={x:0,y:0};return 0<t-n&&(a.y=-1),t-n<0&&(a.y=1),0<e-s&&(a.x=-1),e-s<0&&(a.x=1),a},getDirectionStr:function(a){a=this.getDirectionObj(a);return 1==a.x?"right":-1==a.x?"left":1==a.y?"bottom":-1==a.y?"top":void 0},getDirSpot:function(a){var e=this.getX(),t=this.getY();return"right"==a&&e++,"left"==a&&e--,"bottom"==a&&t++,"top"==a&&t--,game.map.getSpot(e,t)},getPosition:function(){return(this.hasClass("spot")?this:this.closest(".spot")).attr("id")},mirrorPosition:function(a){var e=game.map.getX(a),a=game.map.getY(a),e=game.width-e-1,a=game.height-a-1;return game.map.toPosition(e,a)},invertDirection:function(a){return"left"==a?"right":"right"==a?"left":"top"==a?"bottom":"bottom"==a?"top":void 0},rangeArray:[.5,1,1.25,1.5,2,2.5,3,3.5,4],atRange:function(a,t,s){var e=a;"string"==typeof a&&(e=game.map.getRangeInt(a));var n=$(this).closest(".spot");if(0<=e&&e<=game.map.rangeArray.length){function i(a,e){e=game.map.getSpot(a,e);e&&m.indexOf(e)<0&&(s&&e.hasClasses(s)||t(e),m.push(e))}var o,r,d,l,m=[],g=game.map.getX(n),c=game.map.getY(n);if(0===e)i(g,c);else if(n=game.map.rangeArray[e],a=Math.round(n),d=n*n,l=Math.ceil(n)*Math.cos(Math.PI/4),i(g,c+a),i(g,c-a),i(g-a,c),i(g+a,c),2===e||3===e)for(o=1;o<=l;o+=1)i(g+o,c+(r=Math.round(Math.sqrt(d-o*o)))),i(g+o,c-r),i(g-o,c+r),i(g-o,c-r);else if(3<e)for(o=1;o<=l;o+=1)i(g+o,c+(r=Math.round(Math.sqrt(d-o*o)))),i(g+r,c+o),i(g+o,c-r),i(g+r,c-o),i(g-o,c+r),i(g-r,c+o),i(g-o,c-r),i(g-r,c-o)}},around:function(a,e){var t=this,s=a;"string"==typeof a&&(s=game.map.getRangeInt(a)),3===s&&t.atRange(game.map.getRangeStr(1),e),4===s&&t.atRange(game.map.getRangeStr(2),e),5===s&&(t.atRange(game.map.getRangeStr(1),e),t.atRange(game.map.getRangeStr(3),e)),6===s&&(t.atRange(game.map.getRangeStr(2),e),t.atRange(game.map.getRangeStr(4),e)),7===s&&(t.atRange(game.map.getRangeStr(1),e),t.atRange(game.map.getRangeStr(3),e),t.atRange(game.map.getRangeStr(5),e)),8===s&&(t.atRange(game.map.getRangeStr(2),e),t.atRange(game.map.getRangeStr(4),e),t.atRange(game.map.getRangeStr(6),e)),t.atRange(s,e)},inRange:function(a,e){this.atRange(game.map.getRangeStr(0),e),this.around(a,e)},inAttackRange:function(e){var t=!1;return this.around(this.data("range"),function(a){$(".card",a)[0]==e[0]&&(t=!0)}),t},inCross:function(a,e,s,t){var n=$(this).closest(".spot");if(t=t||0,0<=a){function i(a,e,t){e=game.map.getSpot(a,e);e&&s(e,t)}var o,r=game.map.getX(n),d=game.map.getY(n);if(0===a)i(r,d);else for(o=1+t;o<=a;o+=1)0<=e&&(i(r,d+o,"bottom"),i(r,d-o,"top"),i(r-o,d,"left"),i(r+o,d,"right")),1<=e&&(i(r-1,d+o,"bottom"),i(r+1,d+o,"bottom"),i(r-1,d-o,"top"),i(r+1,d-o,"top"),i(r-o,d-1,"left"),i(r-o,d+1,"left"),i(r+o,d-1,"right"),i(r+o,d+1,"right"))}},opponentsInCross:function(a,e,t,s){var n=this.side(),i=game.opponent(n);this.inCross(a,e,t,function(a,e){a=$(".card."+i,a);a.length&&t(a,e)},s)},alliesInCross:function(a,e,t,s){var n=this.side();source.inCross(a,e,t,function(a,e){a=$(".card."+n,a);a.length&&t(a,e)},s)},inLine:function(a,e,t,s,n){var i=this.getDirectionStr(a),o=a.getX(),a=a.getY(),r={},d={};n=n||0,"top"==i&&(r.x=o-t,d.x=o+t,r.y=a-e+1,d.y=a-n),"bottom"==i&&(r.x=o-t,d.x=o+t,r.y=a+n,d.y=a+e-1),"left"==i&&(r.x=o-e+1,d.x=o-n,r.y=a-t,d.y=a+t),"right"==i&&(r.x=o+n,d.x=o+e-1,r.y=a-t,d.y=a+t);for(var l=r.x;l<=d.x;l++)for(var m=r.y;m<=d.y;m++){var g=game.map.getSpot(l,m);g&&s(g,l,m)}return this},opponentsInLine:function(a,e,t,s,n){var i=this.side(),o=game.opponent(i);return this.inLine(a,e,t,function(a,e,t){a=a.find(".card."+o);a.length&&s(a,e,t)},n),this},alliesInLine:function(a,e,t,s,n){var i=this.side();return this.inLine(a,e,t,function(a,e,t){a=a.find(".card."+i);a.length&&s(a,e,t)},n),this},inMovementRange:function(a,t,s){var n,i,o,r=this,d=a||game.defaultSpeed;0<=d&&d<=game.map.rangeArray.length&&(n=game.map.getX(r),i=game.map.getY(r),o=function(a,e){e=game.map.getSpot(a,e);e&&(s&&e.hasClasses(s)||t(e))},r.around(d,function(a){var e=game.map.getX(a),t=game.map.getY(a);2<d?(game.map.updateGrid(r.hasClass("phased")),(a=game.map.finder.findPath(n,i,e,t,game.map.grid)).length&&a.length-1<=Math.ceil(d/2)&&o(e,t)):o(e,t)}))},getRangeInt:function(a){if("number"==typeof a)return a;var e=0;return a===game.data.ui.small&&(e=1),a===game.data.ui.melee&&(e=2),a===game.data.ui.short&&(e=3),a===game.data.ui.long&&(e=4),a===game.data.ui.ranged&&(e=5),a===game.data.ui.far&&(e=6),a===game.data.ui.away&&(e=7),a===game.data.ui.max&&(e=8),a===game.data.ui.global&&(e=999),e},getRangeStr:function(a){if("string"==typeof a)return a;var e="";return 1===a&&(e=game.data.ui.small),2===a&&(e=game.data.ui.melee),3===a&&(e=game.data.ui.short),4===a&&(e=game.data.ui.long),5===a&&(e=game.data.ui.ranged),6===a&&(e=game.data.ui.far),7===a&&(e=game.data.ui.away),9===a&&(e=game.data.ui.max),999===a&&(e=game.data.ui.global),e},cardsInRange:function(a,e){this.inRange(a,function(a){a=a.find(".card");a.length&&e(a)})},opponentsInRange:function(a,e){var t=this.opponent();return this.inRange(a,function(a){a=$(".card."+t,a);a.length&&e(a)}),this},alliesInRange:function(a,e){var t=this.side();return this.inRange(a,function(a){a=a.find(".card."+t);a.length&&e(a)}),this},firstSpotInLine:function(a,e){for(var t=this.getDirectionObj(a),s=1;s<=e;s+=1){var n=game.map.getX(this)+s*t.x,i=game.map.getY(this)+s*t.y,i=game.map.getSpot(n,i);if(i)return i}},firstFreeSpotInLine:function(a,e,t){for(var s=this.getDirectionObj(a),n=1;n<=e;n+=1){var i=game.map.getX(this)+n*s.x,o=game.map.getY(this)+n*s.y,r=game.map.getSpot(i,o);if(!t||i==t.getX()&&o==t.getY()||r&&r.hasClass("free")&&!r.hasClass("block"))return r}},lastSpotInLine:function(a,e){for(var t=this.getDirectionObj(a),s=e;0<s;--s){var n=game.map.getX(this)+s*t.x,i=game.map.getY(this)+s*t.y,i=game.map.getSpot(n,i);if(i)return i}},lastFreeSpotInLine:function(a,e){for(var t=this.getDirectionObj(a),s=e;0<s;--s){var n=game.map.getX(this)+s*t.x,i=game.map.getY(this)+s*t.y,i=game.map.getSpot(n,i);if(i&&i.hasClass("free")&&!i.hasClass("block"))return i}},firstCardInLine:function(a,e){for(var t=this.getDirectionObj(a),s=1;s<=e;s+=1){var n=game.map.getX(this)+s*t.x,i=game.map.getY(this)+s*t.y,i=game.map.getSpot(n,i);if(i){i=i.find(".card");if(i.length&&!i.hasClass("cycloned"))return i}}},behindTarget:function(a){var e=this.getDirectionObj(a);e.x+=a.getX(),e.y+=a.getY();e=game.map.getSpot(e.x,e.y);if(e){e=e.children(".card");if(e.length&&!e.hasClass("cycloned"))return e}},clear:function(){game.highlight.clearMap(),game.map.el.removeClass("night"),$(".map .projectile").remove(),$(".map .spot").removeClass("block playerarea enemyarea jungle cript").addClass("free")}},game.tower={build:function(e,a){var t=game.card.build({className:"towers static "+e,side:e,name:game.data.ui.tower,attribute:game.data.ui.building,range:game.data.ui.max,description:game.data.ui.towerDescription,buffsBox:!0,armor:10,resistance:100,damage:18,hp:16});return t.on("mousedown touchstart",game.card.select),t.place(a),t.around(t.data("range"),function(a){a.addClass(e+"area")}),t},place:function(){var a=game.states.config[game.size].tower;game.player.tower=game.tower.build("player",a),game.enemy.tower=game.tower.build("enemy",game.map.mirrorPosition(a))},attack:function(a){var e=game.opponent(a),t={notfound:!0,data:function(a){return 1/0}};$(".map ."+e+"area .card."+a).each(function(){var a=$(this);a.data("current hp")<t.data("current hp")&&(t=a)}),t.notfound||game[e].tower.attack(t,!0)}},game.tree={build:function(a,e){if($("#"+a).hasClass("free")){e=game.card.build({className:"trees static neutral "+e,name:game.data.ui.tree,attribute:game.data.ui.tree,description:game.data.ui.forest});return e.on("mousedown touchstart",game.card.select),e.place(a),e}},place:function(){var a=game.states.config[game.size].trees;$.each(a.split(" "),function(){game.tree.build(this,"rad"),game.tree.build(game.map.mirrorPosition(this),"dire")})},destroy:function(a){var e=a.parent(),t=e.getPosition();e.addClass("free"),a.data("spot",e.attr("id")).data("reborn-count",game.treeRespawn),a.appendTo(game.states.table.treeDeck),game.highlight.refresh(),game.player.tower.on("turnend.tree"+t,function(){var a=$("#"+this.data("spot"));this.data("reborn-count",this.data("reborn-count")-1),a.hasClass("free")&&this.data("reborn-count")<1&&(this.appendTo(a),a.removeClass("free"),game.player.tower.off("turnend.tree"+t))}.bind(a))}},game.turn={build:function(a){game.turn.builded||(game.turn.builded=!0,game.turn.msg=$("<p>").appendTo(game.topbar).addClass("turns").text(game.data.ui.turns+": 0/0 (0)"),game.turn.time=$("<p>").appendTo(game.topbar).addClass("time").text(game.data.ui.time+": 0:00 Day"),game.turn.el=$("<h1>").addClass("turntitle").appendTo(game.states.table.el)),game.time=a||0,game.player.turn=0,game.enemy.turn=0,game.player.kills=0,game.enemy.kills=0,game.player.deaths=0,game.enemy.deaths=0,game.turn.tickTime(!0)},begin:function(a,e){var t;"table"==game.currentState&&(game.recovering||(game.message.text(game.data.ui[a+"turn"]),game.turn.el.text(game.data.ui[a+"turn"]).addClass("show"),game.currentMoves=[]),t=800,"local"!=game.mode||game.debug||(t=2800),game.timeout(t,function(){game.recovering||game.turn.el.removeClass("show"),game.timeout(800,game.turn.play.bind(this,a,e))}))},play:function(a,e){game.currentTurnSide=a,$(".map .fountain.enemyarea .card.enemy").heal(game.fountainHeal),$(".map .fountain.playerarea .card.player").heal(game.fountainHeal),$(".map .jungle .card").each(game.turn.jungle),$(".table .card").each(function(){game.turn.triggerStart(this,a)}),"library"==game.mode?"player"==a&&(game.turn.enableAttackMove("player"),game.turn.enableAttackMove("enemy")):game.turn.enableAttackMove(a),"player"==a&&game.states.table.el.addClass("turn"),"enemy"==a&&"local"==game.mode&&game.states.table.el.addClass("unturn"),"local"==game.mode&&game.items.enableShop(),game.items.updateShop(),game.loader.removeClass("loading"),game.canPlay()&&(game.states.table.skip.attr("disabled",!1),game.states.table.surrender.attr("disabled",!1)),game.highlight.map(),e&&game.timeout(100,e.bind(this,a))},buy:function(a){game[a].turn===game.ultTurn&&$(".card",game[a].skills.ult).appendTo(game[a].skills.deck),game.skill.buyHand(a),game.tower.attack(game.opponent(a)),game.items.addMoney(a,game.turnReward),game.highlight.refresh()},count:function(a,e,t){var s;0<=game.turn.counter&&!game.recovering&&("player"===a&&(s=game.data.ui.playerturncount),"enemy"===a&&(s=game.data.ui.enemyturncount),game.turn.counter<11?game.message.addClass("alert"):game.message.removeClass("alert"),game.message.text(s+" "+game.turn.counter+" "+game.data.ui.seconds),0<game.turn.counter&&(t&&t(a),("local"==game.mode||"single"==game.mode)&&game.container.hasClass("option-state")||--game.turn.counter,game.turn.timeout=game.timeout(1e3,game.turn.count.bind(this,a,e,t))),0===game.turn.counter&&e&&(clearTimeout(game.turn.timeout),game.turn.timeout=game.timeout(1e3,function(){e(a)})))},stopCount:function(){clearTimeout(game.turn.timeout),game.turn.counter=-1},end:function(a,e){var t;"table"==game.currentState&&(game.currentTurnSide=!1,game.message.text(game.data.ui.turnend),game.states.table.skip.attr("disabled",!0),$(".map .card").each(function(a,e){e=$(e);e.removeClass("can-attack can-move"),$(".textfx",e).remove(),game.turn.channel(e),game.buff.turn(e),e.trigger("turnend",{target:e})}),"player"==a&&game.states.table.el.removeClass("turn"),"local"==game.mode&&game.states.table.el.removeClass("turn unturn"),"enemy"==a&&"library"!==game.mode&&game.states.table.el.removeClass("unturn"),game.recovering||(game.audio.play("activate"),t="U:"+a,game.history.saveMove(t)),"local"==game.mode&&(game.items.hideShop(),game.items.updateShop(),game.items.disableShop()),game[a].turn+=1,game.turn.tickTime(),e&&e(a))},jungle:function(){var a=$(this),e=a.side(),t=game.jungleFarm;a.hasClass("heroes")&&(t*=2),game.items.addMoney(e,t),game.fx.text(a,"gold","$"+t,2e3)},triggerStart:function(a,e){a=$(a);a.trigger("turnstart",{target:a}),a.trigger(e+"turnstart",{target:a})},channel:function(a){var e;!a.hasClass("channeling")||0<=(e=a.data("channeling"))&&(a.trigger("channel",a.data("channel event")),--e,a.data("channeling",e),0==e&&a.stopChanneling())},enableAttackMove:function(a){$(".map .card."+a+":not(.towers, .ghost)").each(function(){var a=$(this);a.canAttack(!0)&&a.addClass("can-attack"),a.canMove(!0)&&a.addClass("can-move")})},tickTime:function(a){a||(game.time+=.5),game.totalTurns=Math.floor(game.player.turn+game.enemy.turn),game.turn.msg.text(game.data.ui.turns+": "+game.player.turn+"/"+game.enemy.turn+" ("+game.totalTurns+")"),game.turn.time.html(game.data.ui.time+": "+game.turn.hours()+" "+game.turn.dayNight())},hours:function(){var a=game.time%(2*game.dayLength),e=parseInt(a,10),a=parseInt(60*(a-e),10);return e+":"+(a<10?"0"+a:a)},dayNight:function(){var a=game.time%(2*game.dayLength);return 6<=a&&a<18?(game.camera.removeClass("night"),'<span title="'+game.data.ui.day+'"></span>'):(game.camera.addClass("night"),'<span title="'+game.data.ui.night+'"></span>')}},game.units={build:function(t){game[t].unitsDeck=game.deck.build({name:"units",cb:function(a){a.addClass(t+" units cemitery").hide().appendTo(game.states.table[t]),$.each(JSON.parse(a.data("cards")),function(a,e){$("#"+e).addClass(t+" unit").data("side",t)})}})},buyCreeps:function(a,e,t){game[a].turn!==game.creepTurn&&!e||game.units.buy(a),game[a].turn!==game.catapultTurn&&!t||game.units.buyCatapult(a)},clone:function(a){a=$(a).first();return a.clone().data(a.data())},buy:function(a){var e=game.units.clone(game[a].unitsDeck.children(".creeps-ranged"));e.appendTo(game[a].skills.sidehand);var t=game.units.clone(game[a].unitsDeck.children(".creeps-melee"));t.appendTo(game[a].skills.sidehand);var s=game.units.clone(game[a].unitsDeck.children(".creeps-melee"));s.appendTo(game[a].skills.sidehand),e.on("mousedown touchstart",game.card.select),t.on("mousedown touchstart",game.card.select),s.on("mousedown touchstart",game.card.select);var n=game.units.clone(game[a].unitsDeck.children(".summon"));n&&(n.appendTo(game[a].skills.sidehand),n.on("mousedown touchstart",game.card.select).on("mouseenter",game.highlight.source).on("mouseleave",game.highlight.refresh)),"player"!=a&&"library"!=game.mode&&"local"!=game.mode&&(e.addClass("flipped"),t.addClass("flipped"),s.addClass("flipped"),n&&n.addClass("flipped"))},buyCatapult:function(a){var e=game.units.clone(game[a].unitsDeck.children(".creeps-ranged"));e.appendTo(game[a].skills.sidehand);var t=game.units.clone(game[a].unitsDeck.children(".creeps-melee"));t.appendTo(game[a].skills.sidehand);var s=game.units.clone(game[a].unitsDeck.children(".creeps-catapult"));s.appendTo(game[a].skills.sidehand);var n=game.units.clone(game[a].unitsDeck.children(".summon"));n&&n.appendTo(game[a].skills.sidehand),e.on("mousedown touchstart",game.card.select),t.on("mousedown touchstart",game.card.select),s.on("mousedown touchstart",game.card.select),n&&n.on("mousedown touchstart",game.card.select),"player"!=a&&"library"!=game.mode&&"local"!=game.mode&&(e.addClass("flipped"),t.addClass("flipped"),s.addClass("flipped"),n&&n.addClass("flipped"))},forestCreep:function(a,e){var t=game[a].unitsDeck.children(".forest"),s=Math.floor(game.random()*t.length),s=game.units.clone(t[s]);return s.addClass(a),s.appendTo(e),s.on("mousedown touchstart",game.card.select),s},summonCreep:function(a,e,t,s){var n=game.selectedCard;game.fx.add("ld-return-target",a),a.hasClass("free")&&(game.audio.play("activate"),n.canPlay()?game.highlight.clearMap():game.highlight.refresh(),n=function(){game.fx.text(this.creep,"z"),this.creep.place(this.target),this.creep.trigger("summon")}.bind({creep:game.selectedCard,target:a.attr("id")}),game.selectedCard.hasClass("dragTarget")?n():game.skill.animateCast(game.selectedCard,a,s,n))}};